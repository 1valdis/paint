{"version":3,"sources":["components/helpers.js","components/Modal/Modal.js","components/FileMenu/about/About.js","components/FileMenu/FileMenuComponent.js","components/FileMenu/FileMenuContainer.js","components/instruments/actions.js","components/App/actions.js","components/ResizerPoint/ResizerPoint.js","components/Resizer/Resizer.js","components/MovableSelection/MovableSelection.js","components/instruments/SelectionInstrument/ZoneSelection/ZoneSelection.js","components/instruments/SelectionInstrument/ImageDataSelection/ImageDataSelection.js","components/instruments/SelectionInstrument/SelectionInstrument.js","components/instruments/SelectionInstrument/actions.js","components/instruments/Pen/Pen.js","components/instruments/Fill/Fill.js","components/Colors/actions.js","components/instruments/Dropper/Dropper.js","components/instruments/Eraser/Eraser.js","components/CanvasEditor/CanvasEditor.js","components/Canvas/Canvas.js","components/NavBar/NavBarItem.js","components/NavBar/NavBar.js","components/Clipboard/Clipboard.js","components/Image/Image.js","components/instruments/Instruments.js","components/ColorPalette/ColorPalette.js","components/ColorSelection/ColorSelection.js","components/ColorInput/ColorInput.js","components/Color/Color.js","components/Colors/ColorsComponent.js","components/Colors/ColorsContainer.js","components/Colors/reducer.js","components/instruments/reducer.js","components/App/reducer.js","components/App/App.js","index.js"],"names":["isVisible","elem","offsetWidth","offsetHeight","getClientRects","length","componentToHex","c","hex","toString","rgbToHex","_ref","r","g","b","bresenhamLine","x0","y0","x1","y1","callback","dx","Math","abs","dy","sx","sy","err","e2","getCanvasCoordsFromEvent","canvas","e","_canvas$getBoundingCl","getBoundingClientRect","top","left","_ref2","clientX","clientY","mouseX","mouseY","floor","root","document","getElementById","Modal","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","el","createElement","classList","add","createPortal","children","appendChild","removeChild","PureComponent","About","react_default","a","className","onClick","onClose","href","title","FileMenuComponent","_getPrototypeOf2","_len","arguments","args","Array","_key","apply","concat","menu","createRef","ref","classNames","file-menu_open","isOpen","onClickInside","onFileCreate","type","accept","onChange","onFileOpen","onDownload","onAboutOpen","isAboutOpen","components_Modal_Modal","FileMenu_about_About","onAboutClose","clickOutsideListener","element","outsideClickListener","event","contains","target","addEventListener","addClickOutsideListener","current","onClickOutside","listener","removeEventListener","FileMenuContainer","toggleMenu","setState","state","open","closeMenu","openAbout","aboutOpen","closeAbout","_this2","FileMenu_FileMenuComponent","assign","downloadName","types","CHANGE_INSTRUMENT","selectInstrument","instrument","IMAGE_CHANGED","ctx","getContext","alpha","createFile","dispatch","getState","width","height","fillStyle","fillRect","data","getImageData","name","imageChangedActionCreator","imageData","putImageData","ResizerPoint","handlePointerDown","button","resizerElement","resizing","onResizeStart","onResizeCancel","handlePointerUp","onResizeEnd","handlePointerMove","buttons","onResizeMove","preventContextMenu","handlePointerCancel","handleDragStart","preventDefault","handleContextMenu","style","objectSpread","outerStyle","innerStyle","passive","window","Component","directions","selection","Resizer","resizeTop","resizeLeft","resizeWidth","resizeHeight","resizeRect","resizer_resizing","resizer_hide-border","hideBorderOnResizing","mode","map","d","components_ResizerPoint_ResizerPoint","bind","key","direction","_this$resizeRect$curr","bottom","right","parentRect","parentNode","pageYOffset","pageXOffset","round","onResizing","nextProps","undefined","MovableSelection","currentTarget","moving","startX","startY","handleDocumentPointerMove","onMoving","_this$props","coords","onMoveEnd","objectWithoutProperties","handleDocumentPointerUp","_this$props2","_this$props3","withoutOnChange","onPointerDown","components_Resizer_Resizer","getDerivedStateFromProps","ZoneSelection","handleResizing","handleResizeEnd","backgroundColor","secondaryColor","newCtx","onCoordsChanged","onImageChanged","handleMoving","_ref3","handleMoveEnd","_ref4","redrawCanvas","updateOld","oldCtx","imageSmoothingEnabled","drawImage","originCoords","canvasRef","react","components_MovableSelection_MovableSelection","oldCanvas","prevProps","ImageDataSelection","updateOldCanvas","updateSelectionCanvas","selectionCtx","selectionCanvas","selectionImageData","updateNewCanvas","onSelectionChanged","resizeCanvasToFitPasted","max","resized","SelectionInstrument","trusted","changeSelection","_this$containerRef$cu","containerRef","ceil","selecting","selectingY","selectingX","selectingCoords","_this$containerRef$cu2","trunc","canvasRelativeTop","canvasRelativeLeft","_ref5","min","selectionOriginCoords","El","SelectionInstrument_ImageDataSelection_ImageDataSelection","selectionCoords","changeImage","SelectionInstrument_ZoneSelection_ZoneSelection","zone","connect","image","instruments","colors","list","secondary","Pen","isDrawing","beginDrawing","toConsumableArray","_this3","continueDrawing","handlePointerEnter","_this4","handlePointerLeave","_this5","endDrawing","_getCanvasCoordsFromE","_getCanvasCoordsFromE2","slicedToArray","prevX","prevY","cancelDrawing","handleDocumentContextMenu","handleDocumentSelectStart","x","y","_this$props$color","color","drawPoint","onPointerUp","onPointerMove","onPointerEnter","onPointerLeave","primary","Fill","handleMouseDown","floodFill","colorToReplace","colorToFillWith","replaceR","replaceG","replaceB","fillR","fillG","fillB","i","q","push","n","shift","onMouseDown","ADD_COLOR","SELECT_COLOR","CHANGE_ACTIVE_COLOR","selectColor","index","Dropper","handleClick","_e$target$getBounding","addColor","rgbObject","found","rgbObjectString","JSON","stringify","value","Eraser","updateCanvas","_getCanvasCoordsFromE3","_getCanvasCoordsFromE4","noCursorCtx","thickness","updateCanvasNoCursor","_this$props$color2","strokeRect","noCursorCanvas","_this$props$color3","strokeStyle","_this$props$color4","pen","fill","dropper","eraser","CanvasEditor","Element","Canvas","onResize","toWidth","toHeight","newCanvas","disableSelection","components_CanvasEditor_CanvasEditor","NavBarItem","footer","NavBar","components_NavBar_NavBarItem","Clipboard","disabled","Image","handleClipClick","_this$props$selection","select_active","viewBox","strokeWidth","strokeDasharray","stroke","Instruments","instrument_active","ColorPalette","ColorSelection","color-selection_active","active","header","ColorInput","Color","color_active","color_undefined","ColorsComponent","components_ColorSelection_ColorSelection","activeColor","onActiveColorClick","components_ColorPalette_ColorPalette","components_Color_Color","onColorClick","colorId","item","components_ColorInput_ColorInput","onColorInputChange","ColorsContainer","Colors_ColorsComponent","changeActiveColor","rgb","match","v","parseInt","addColorFromInput","colorsReducer","action","newState","slice","instrumentsReducer","withoutType","reducer","combineReducers","canvasEl","App","Fragment","FileMenu_FileMenuContainer","toBlob","blob","URL","revokeObjectURL","createObjectURL","download","body","click","components_NavBar_NavBar","components_Clipboard_Clipboard","onPasteClick","onClipboardPasteClick","clipboardDisabled","components_Image_Image","components_instruments_Instruments","Colors_ColorsContainer","components_Canvas_Canvas","onCanvasRef","handleCanvasRef","onPaste","file","nativeEvent","files","reader","FileReader","onload","img","src","result","readAsDataURL","openFile","clipboardData","items","indexOf","getAsFile","source","pastedImage","pastedImageCanvas","pastedImageCtx","instrumentsTypes","paste","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","rootReducer","applyMiddleware","thunk","render","es","components_App_App"],"mappings":"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","file":"static/js/main.52eceffb.chunk.js","sourcesContent":["export function addClickOutsideListener (element, callback) {\n  const outsideClickListener = event => {\n    if (!element.contains(event.target)) {\n      if (isVisible(element)) {\n        callback()\n      }\n    }\n  }\n\n  document.addEventListener('click', outsideClickListener)\n  return outsideClickListener\n}\n\nexport function removeClickOutsideListener (listener) {\n  document.removeEventListener('click', listener)\n}\n\nconst isVisible = elem =>\n  !!elem &&\n  !!(elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length)\n\nfunction componentToHex (c) {\n  var hex = c.toString(16)\n  return hex.length === 1 ? '0' + hex : hex\n}\n\nexport function rgbToHex ({ r, g, b }) {\n  return '#' + componentToHex(r) + componentToHex(g) + componentToHex(b)\n}\n\nexport function bresenhamLine (x0, y0, x1, y1, callback) {\n  var dx = Math.abs(x1 - x0)\n  var dy = Math.abs(y1 - y0)\n  var sx = x0 < x1 ? 1 : -1\n  var sy = y0 < y1 ? 1 : -1\n  var err = dx - dy\n\n  while (true) {\n    callback(x0, y0)\n\n    if (x0 === x1 && y0 === y1) break\n    var e2 = 2 * err\n    if (e2 > -dy) {\n      err -= dy\n      x0 += sx\n    }\n    if (e2 < dx) {\n      err += dx\n      y0 += sy\n    }\n  }\n}\n\nexport function getCanvasCoordsFromEvent(canvas, e) {\n  let { top, left } = canvas.getBoundingClientRect()\n  const [mouseX, mouseY] = [e.clientX, e.clientY]\n  return [Math.floor(mouseX - left), Math.floor(mouseY - top)]\n}\n","import { PureComponent } from 'react'\nimport { createPortal } from 'react-dom'\n\nimport './Modal.css'\n\nconst root = document.getElementById('modal-root')\n\nclass Modal extends PureComponent {\n  constructor (props) {\n    super(props)\n    this.el = document.createElement('div')\n    this.el.classList.add('modal')\n  }\n  render () {\n    return createPortal(this.props.children, this.el)\n  }\n  componentDidMount () {\n    root.appendChild(this.el)\n  }\n  componentWillUnmount () {\n    root.removeChild(this.el)\n  }\n}\n\nexport default Modal\n","import React from 'react'\n\nimport './About.css'\n\nconst About = props => (\n  <div className='about'>\n    <button className='about-close-button' onClick={props.onClose} />\n    <p>Вы серьёзно ожидали здесь увидеть что-то нормальное? :D</p>\n    <p>\n      Ну ладно, вот немного языка legalese, поскольку авторов иконок надо указать в эбауте прожки)))\n    </p>\n    <div>Icons made by <a href='https://www.flaticon.com/authors/good-ware' title='Good Ware'>Good Ware</a>, <a href='https://www.flaticon.com/authors/smashicons' title='Smashicons'>Smashicons</a>, <a href='https://www.flaticon.com/authors/pixel-buddha' title='Pixel Buddha'>Pixel Buddha</a>, <a href='http://www.freepik.com' title='Freepik'>Freepik</a>, <a href='https://www.flaticon.com/authors/dimitry-miroliubov' title='Dimitry Miroliubov'>Dimitry Miroliubov</a> from <a href='https://www.flaticon.com/' title='Flaticon'>www.flaticon.com</a> is licensed by <a href='http://creativecommons.org/licenses/by/3.0/' title='Creative Commons BY 3.0'>CC 3.0 BY</a></div>\n  </div>\n)\n\nexport default About\n","import React, { PureComponent, createRef } from 'react'\nimport PropTypes from 'prop-types'\n\nimport './FileMenu.css'\n\nimport classNames from 'classnames'\n\nimport { addClickOutsideListener, removeClickOutsideListener } from '../helpers'\n\nimport Modal from '../Modal/Modal'\nimport About from './about/About'\n\nclass FileMenuComponent extends PureComponent {\n  constructor (...args) {\n    super(...args)\n    this.menu = createRef()\n  }\n  render () {\n    return (\n      <div\n        ref={this.menu}\n        className={classNames('file-menu', {\n          'file-menu_open': this.props.isOpen\n        })}\n      >\n        <button className='file-menu-button' onClick={this.props.onClick}>\n          Файл\n        </button>\n        <nav className='file-menu-items' onClick={this.props.onClickInside}>\n          <button className='file-menu-item' onClick={this.props.onFileCreate}>\n            Создать\n          </button>\n          <label className='file-menu-item'>\n            Открыть\n            <input\n              type='file'\n              className='file-menu-item'\n              accept='image/*'\n              onChange={this.props.onFileOpen}\n            />\n          </label>\n          <button\n            className='file-menu-item'\n            onClick={this.props.onDownload}\n          >\n            Сохранить\n          </button>\n          <button className='file-menu-item' onClick={this.props.onAboutOpen}>\n            О программе\n          </button>\n        </nav>\n        {this.props.isAboutOpen && <Modal><About onClose={this.props.onAboutClose} /></Modal>}\n      </div>\n    )\n  }\n  componentDidMount () {\n    this.clickOutsideListener = addClickOutsideListener(\n      this.menu.current,\n      this.props.onClickOutside\n    )\n  }\n  componentWillUnmount () {\n    removeClickOutsideListener(this.clickOutsideListener)\n  }\n}\n\nFileMenuComponent.propTypes = {\n  isOpen: PropTypes.bool.isRequired,\n  onClick: PropTypes.func.isRequired,\n  onClickInside: PropTypes.func.isRequired,\n  onClickOutside: PropTypes.func.isRequired,\n  onDownload: PropTypes.func,\n  onFileCreate: PropTypes.func.isRequired,\n  onFileOpen: PropTypes.func.isRequired,\n  isAboutOpen: PropTypes.bool,\n  onAboutOpen: PropTypes.func,\n  onAboutClose: PropTypes.func\n}\n\nexport default FileMenuComponent\n","import React, { PureComponent } from 'react'\nimport PropTypes from 'prop-types'\n\nimport FileMenuComponent from './FileMenuComponent'\n\nclass FileMenuContainer extends PureComponent {\n  constructor () {\n    super()\n    this.state = { open: false, aboutOpen: false }\n  }\n  render () {\n    return (\n      <FileMenuComponent\n        isOpen={this.state.open}\n        onClick={this.toggleMenu}\n        onClickOutside={this.closeMenu}\n        onClickInside={this.closeMenu}\n        isAboutOpen={this.state.aboutOpen}\n        onAboutOpen={this.openAbout}\n        onAboutClose={this.closeAbout}\n        {...this.props}\n        onDownload={()=>this.props.onDownload(this.props.downloadName)}\n      />\n    )\n  }\n  toggleMenu = () => this.setState(state => ({ open: !state.open }))\n  closeMenu = () => this.setState({ open: false })\n  openAbout = () => this.setState({aboutOpen: true})\n  closeAbout = () => this.setState({aboutOpen: false})\n}\n\nFileMenuContainer.propTypes = {\n  onDownload: PropTypes.func.isRequired,\n  downloadName: PropTypes.string,\n  onFileCreate: PropTypes.func,\n  onFileOpen: PropTypes.func\n}\n\nexport default FileMenuContainer\n","export const types = {\n  CHANGE_INSTRUMENT: 'instruments/change'\n}\n\nexport function selectInstrument (instrument) {\n  return {\n    type: types.CHANGE_INSTRUMENT,\n    instrument\n  }\n}\n","import { types as instrumentsTypes } from '../instruments/actions'\n\nexport const types = {\n  IMAGE_CHANGED: 'app/image-changed'\n}\n\nconst canvas = document.createElement('canvas')\nconst ctx = canvas.getContext('2d', { alpha: false })\nlet href = null\n\nexport function createFile () {\n  return function (dispatch, getState) {\n    ;[canvas.width, canvas.height] = [800, 450]\n    clearCanvas()\n    dispatch({\n      type: types.IMAGE_CHANGED,\n      data: ctx.getImageData(0, 0, canvas.width, canvas.height),\n      name: 'Ваша пикча.png'\n    })\n  }\n}\n\nexport function openFile (e) {\n  return function (dispatch, getState) {\n    const file = e.nativeEvent.target.files[0]\n    if (file == null) return\n    const reader = new FileReader()\n    reader.onload = e => {\n      const img = new Image()\n      img.onload = () => {\n        canvas.width = img.width\n        canvas.height = img.height\n        ctx.drawImage(img, 0, 0)\n        dispatch({\n          type: types.IMAGE_CHANGED,\n          data: ctx.getImageData(0, 0, img.width, img.height),\n          name: file.name\n        })\n      }\n      img.src = e.target.result\n    }\n    reader.readAsDataURL(file)\n  }\n}\n\nexport function paste (e) {\n  return function (dispatch, getState) {\n    if (e.clipboardData) {\n      const items = e.clipboardData.items\n      if (!items) return\n\n      for (let i = 0; i < items.length; i++) {\n        if (items[i].type.indexOf('image') !== -1) {\n          const blob = items[i].getAsFile()\n          const source = window.URL.createObjectURL(blob)\n          const pastedImage = new Image()\n          pastedImage.onload = () => {  \n            const pastedImageCanvas = document.createElement('canvas')\n            pastedImageCanvas.width = pastedImage.width\n            pastedImageCanvas.height = pastedImage.height\n            const pastedImageCtx = pastedImageCanvas.getContext('2d')\n            pastedImageCtx.drawImage(pastedImage, 0, 0)\n            \n            dispatch({\n              type: instrumentsTypes.CHANGE_INSTRUMENT,\n              instrument: 'selection',\n              selection: {\n                imageData: pastedImageCtx.getImageData(0, 0, pastedImageCanvas.width, pastedImageCanvas.height),\n                coords: {\n                  top: 0,\n                  left: 0,\n                  width: pastedImage.width,\n                  height: pastedImage.height\n                }\n              }\n            })\n          }\n          pastedImage.src = source\n          break\n        }\n      }\n      e.preventDefault()\n    }\n  }\n}\n\nfunction imageChangedActionCreator (imageData) {\n  return function (dispatch, getState) {\n    canvas.width = imageData.width\n    canvas.height = imageData.height\n    ctx.putImageData(imageData, 0, 0)\n    dispatch({\n      type: types.IMAGE_CHANGED,\n      data: imageData\n    })\n  }\n}\n\nexport { imageChangedActionCreator as changeImage }\n\nfunction clearCanvas () {\n  ctx.fillStyle = '#FFFFFF'\n  ctx.fillRect(0, 0, canvas.width, canvas.height)\n}\n\nexport function download (name) {\n  canvas.toBlob(blob => {\n    if (href !== null) {\n      window.URL.revokeObjectURL(href)\n    }\n    href = window.URL.createObjectURL(blob)\n    const a = document.createElement('a')\n    a.download = name\n    a.href = href\n    document.body.appendChild(a)\n    a.click()\n    document.body.removeChild(a)\n  })\n}\n","import React, { Component, createRef } from 'react'\nimport './ResizerPoint.css'\n\nclass ResizerPoint extends Component {\n  constructor (...args) {\n    super(...args)\n    this.resizing = false\n    this.preventContextMenu = false\n    this.resizerElement = createRef()\n  }\n  render () {\n    return (\n      <div\n        className={'resizer-outer ' + (this.props.className || '')}\n        style={{ ...this.props.outerStyle }}\n        ref={this.resizerElement}\n      >\n        <div className='resizer-inner' style={{ ...this.props.innerStyle }} />\n      </div>\n    )\n  }\n  componentDidMount () {\n    document.addEventListener('pointerdown', this.handlePointerDown, {passive: true})\n    document.addEventListener('pointermove', this.handlePointerMove, {passive: true})\n    document.addEventListener('pointerup', this.handlePointerUp, {passive: true})\n    document.addEventListener('pointercancel', this.handlePointerCancel, {passive: true})\n    window.addEventListener('blur', this.handlePointerCancel, {passive: true})\n    document.addEventListener('contextmenu', this.handleContextMenu)\n    document.addEventListener('dragstart', this.handleDragStart)\n  }\n  componentWillUnmount () {\n    document.removeEventListener('pointerdown', this.handlePointerDown, {passive: true})\n    document.removeEventListener('pointermove', this.handlePointerMove, {passive: true})\n    document.removeEventListener('pointerup', this.handlePointerUp, {passive: true})\n    document.removeEventListener('pointercancel', this.handlePointerCancel, {passive: true})\n    window.removeEventListener('blur', this.handlePointerCancel, {passive: true})\n    document.removeEventListener('contextmenu', this.handleContextMenu)\n    document.removeEventListener('dragstart', this.handleDragStart)\n  }\n  handlePointerDown = e => {\n    switch (e.button) {\n      case 0:\n        if (this.resizerElement.current.contains(e.target)) {\n          this.resizing = true\n          this.props.onResizeStart(e)\n        }\n        return\n      case 2:\n        this.resizing = false\n        this.props.onResizeCancel(e)\n        break\n      default:\n        break\n    }\n  }\n  handlePointerUp = e => {\n    if (this.resizing) {\n      this.props.onResizeEnd(e)\n      this.resizing = false\n    }\n  }\n  handlePointerMove = e => {\n    if (this.resizing) {\n      switch (e.buttons) {\n        case 1:\n          this.props.onResizeMove(e)\n          break\n        case 2:\n        case 3:\n          this.resizing = false\n          this.props.onResizeCancel(e)\n          this.preventContextMenu = true\n          break\n        default:\n          break\n      }\n    }\n  }\n  handlePointerCancel = e => {\n    if (this.resizing) {\n      this.resizing = false\n      this.props.onResizeCancel(e)\n    }\n  }\n  handleDragStart = e => {\n    e.preventDefault()\n  }\n  handleContextMenu = e => {\n    if (this.preventContextMenu) {\n      e.preventDefault()\n      this.preventContextMenu = false\n    }\n  }\n}\n\nexport default ResizerPoint\n","import React, { PureComponent, createRef } from 'react'\nimport PropTypes from 'prop-types'\n\nimport './Resizer.css'\n\nimport classNames from 'classnames'\n\nimport ResizerPoint from '../ResizerPoint/ResizerPoint'\n\nconst directions = {\n  canvas: ['e', 'se', 's'],\n  selection: ['n', 'ne', 'e', 'se', 's', 'sw', 'w', 'nw']\n}\n\nclass Resizer extends PureComponent {\n  constructor (...args) {\n    super(...args)\n    this.state = {\n      resizing: false,\n      resizeTop: this.props.top,\n      resizeLeft: this.props.left,\n      resizeWidth: this.props.width,\n      resizeHeight: this.props.height\n    }\n    this.resizeRect = createRef()\n  }\n  render () {\n    return (\n      <div\n        className={classNames('resizer', {\n          resizer_resizing: this.state.resizing,\n          'resizer_hide-border': this.props.hideBorderOnResizing\n        })}\n        ref={this.resizeRect}\n        style={{\n          width: `${this.state.resizing ? this.state.resizeWidth : this.props.width}px`,\n          height: `${this.state.resizing ? this.state.resizeHeight : this.props.height}px`,\n          top: `${this.state.resizing ? this.state.resizeTop : this.props.top}px`,\n          left: `${this.state.resizing ? this.state.resizeLeft : this.props.left}px`\n        }}\n      >\n        {directions[this.props.mode].map(d => (\n          <ResizerPoint\n            onResizeStart={this.onResizeStart.bind(this, d)}\n            onResizeMove={this.onResizeMove.bind(this, d)}\n            onResizeEnd={this.onResizeEnd.bind(this, d)}\n            onResizeCancel={this.onResizeCancel.bind(this, d)}\n            key={`${d}-resizer-point`}\n            className={d}\n          />\n        ))}\n      </div>\n    )\n  }\n  onResizeStart (direction, e) {}\n  onResizeMove (direction, e) {\n    let {\n      top,\n      left,\n      bottom,\n      right\n    } = this.resizeRect.current.getBoundingClientRect()\n    const parentRect = this.resizeRect.current.parentNode.getBoundingClientRect()\n    ;[top, left, bottom, right] = [\n      top + window.pageYOffset,\n      left + window.pageXOffset,\n      bottom + window.pageYOffset,\n      right + window.pageXOffset\n    ]\n    const [mouseX, mouseY] = [\n      e.clientX + window.pageXOffset,\n      e.clientY + window.pageYOffset\n    ]\n\n    const state = {\n      resizing: true,\n      resizeTop: this.props.top,\n      resizeLeft: this.props.left,\n      resizeWidth: this.props.width,\n      resizeHeight: this.props.height\n    }\n\n    switch (direction) {\n      case 'n':\n        state.resizeTop = mouseY - parentRect.top\n        state.resizeHeight = this.props.height - state.resizeTop\n        break\n      case 'ne':\n        state.resizeTop = mouseY - parentRect.top\n        state.resizeHeight = this.props.height - state.resizeTop\n        state.resizeWidth = mouseX - left\n        break\n      case 'e':\n        state.resizeWidth = mouseX - left\n        break\n      case 'se':\n        state.resizeHeight = mouseY - top\n        state.resizeWidth = mouseX - left\n        break\n      case 's':\n        state.resizeHeight = mouseY - top\n        break\n      case 'sw':\n        state.resizeHeight = mouseY - top\n        state.resizeLeft = mouseX - parentRect.left\n        state.resizeWidth = this.props.width - state.resizeLeft\n        break\n      case 'w':\n        state.resizeLeft = mouseX - parentRect.left\n        state.resizeWidth = this.props.width - state.resizeLeft\n        break\n      case 'nw':\n        state.resizeTop = mouseY - parentRect.top\n        state.resizeHeight = this.props.height - state.resizeTop\n        state.resizeLeft = mouseX - parentRect.left\n        state.resizeWidth = this.props.width - state.resizeLeft\n        break // no default\n    }\n\n    state.resizeTop = Math.round(\n      state.resizeTop + window.pageYOffset >\n        this.props.top + this.props.height - 1\n        ? this.props.height + this.props.top - 1\n        : state.resizeTop\n    )\n    state.resizeLeft = Math.round(\n      state.resizeLeft + window.pageXOffset >\n        this.props.left + this.props.width - 1\n        ? this.props.width + this.props.left - 1\n        : state.resizeLeft\n    )\n    state.resizeWidth = Math.round(\n      state.resizeWidth > 0 ? state.resizeWidth : 1\n    )\n    state.resizeHeight = Math.round(\n      state.resizeHeight > 0 ? state.resizeHeight : 1\n    )\n    if (this.props.onResizing) {\n      this.props.onResizing(\n        state.resizeTop,\n        state.resizeLeft,\n        state.resizeWidth,\n        state.resizeHeight\n      )\n    }\n    this.setState(state)\n  }\n  onResizeEnd (direction, e) {\n    if (this.props.onResizeEnd) {\n      this.props.onResizeEnd(\n        this.state.resizeTop,\n        this.state.resizeLeft,\n        this.state.resizeWidth,\n        this.state.resizeHeight\n      )\n    }\n    this.setState({ resizing: false })\n  }\n  onResizeCancel (direction, e) {\n    this.setState({\n      resizing: false,\n      resizeWidth: this.props.width,\n      resizeHeight: this.props.height\n    })\n  }\n  static getDerivedStateFromProps (nextProps, prevState = { resizing: false }) {\n    return prevState.resizing\n      ? null\n      : {\n        resizeTop: nextProps.top,\n        resizeLeft: nextProps.left,\n        resizeWidth: nextProps.width,\n        resizeHeight: nextProps.height\n      }\n  }\n}\n\nResizer.propTypes = {\n  mode: PropTypes.oneOf(['canvas', 'selection']),\n  width: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n  onResizeEnd: PropTypes.func,\n  onResizing: PropTypes.func\n}\n\nexport default Resizer\n","import React, { PureComponent } from 'react'\nimport PropTypes from 'prop-types'\n\nimport './MovableSelection.css'\n\nimport Resizer from '../Resizer/Resizer'\n\nclass MovableSelection extends PureComponent {\n  constructor (...args) {\n    super(...args)\n    this.state = {\n      moving: false,\n      startX: null,\n      startY: null,\n      top: this.props.top,\n      left: this.props.left\n    }\n  }\n  render () {\n    const {\n      onResizeEnd,\n      onResizing,\n      onMoveEnd,\n      onMoving,\n      ...withoutOnChange\n    } = this.props\n    if (this.props.onResizing) {\n      withoutOnChange.onResizing = this.onResizing\n    }\n    if (this.props.onResizeEnd) {\n      withoutOnChange.onResizeEnd = this.onResizeEnd\n    }\n    return (\n      <div\n        style={this.props}\n        onPointerDown={this.handlePointerDown}\n        className='movable-selection'\n      >\n        <Resizer mode='selection' {...withoutOnChange} top={0} left={0} />\n      </div>\n    )\n  }\n  onResizeEnd = (top, left, width, height) => {\n    this.props.onResizeEnd({\n      top: this.props.top + top,\n      left: this.props.left + left,\n      width,\n      height\n    })\n  }\n  onResizing = (top, left, width, height) => {\n    this.props.onResizing({\n      top: this.props.top + top,\n      left: this.props.left + left,\n      width,\n      height\n    })\n  }\n  handlePointerDown = e => {\n    if (e.target === e.currentTarget) {\n      this.setState({\n        moving: true,\n        startX: e.clientX + window.pageXOffset,\n        startY: e.clientY + window.pageYOffset\n      })\n    }\n  }\n  handleDocumentPointerMove = e => {\n    if (\n      this.state.moving &&\n      this.state.startX !== null &&\n      this.props.onMoving\n    ) {\n      switch (e.buttons) {\n        case 1:\n          const {\n            onResizeEnd,\n            onResizing,\n            onMoveEnd,\n            onMoving,\n            ...coords\n          } = this.props\n          coords.top =\n            this.state.top +\n            (e.clientY + window.pageYOffset - this.state.startY)\n          coords.left =\n            this.state.left +\n            (e.clientX + window.pageXOffset - this.state.startX)\n          this.props.onMoving(coords)\n          break\n        case 2:\n        case 3:\n          this.props.onMoving({\n            top: this.state.top,\n            left: this.state.left,\n            width: this.props.width,\n            height: this.props.height,\n          })\n          this.setState({\n            moving: false\n          })\n          this.preventContextMenu = true\n          break // no default\n      }\n    }\n  }\n  handleDocumentPointerUp = e => {\n    if (\n      this.state.moving &&\n      this.state.startX !== null &&\n      this.props.onMoving\n    ) {\n      const {\n        onResizeEnd,\n        onResizing,\n        onMoveEnd,\n        onMoving,\n        ...coords\n      } = this.props\n      coords.top =\n        this.state.top + (e.clientY + window.pageYOffset - this.state.startY)\n      coords.left =\n        this.state.left + (e.clientX + window.pageXOffset - this.state.startX)\n      this.props.onMoveEnd(coords)\n    }\n    this.setState({\n      moving: false,\n      startX: null,\n      startY: null\n    })\n  }\n  static getDerivedStateFromProps = (props, state) => {\n    if (!state.moving) {\n      return {\n        top: props.top,\n        left: props.left\n      }\n    }\n    return null\n  }\n  componentDidMount () {\n    document.addEventListener('pointermove', this.handleDocumentPointerMove, {passive: true})\n    document.addEventListener('pointerup', this.handleDocumentPointerUp, {passive: true})\n    document.addEventListener('contextmenu', this.handleContextMenu)\n  }\n  componentWillUnmount () {\n    document.removeEventListener('pointermove', this.handleDocumentPointerUp, {passive: true})\n    document.removeEventListener('pointerup', this.handleDocumentPointerUp, {passive: true})\n    document.removeEventListener('contextmenu', this.handleContextMenu)\n  }\n  \n  handleContextMenu = e => {\n    if (this.preventContextMenu) {\n      e.preventDefault()\n      this.preventContextMenu = false\n    }\n  }\n}\n\nMovableSelection.propTypes = {\n  top: PropTypes.number.isRequired,\n  left: PropTypes.number.isRequired,\n  width: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n  hideBorderOnResizing: PropTypes.bool,\n  onResizeEnd: PropTypes.func,\n  onResizing: PropTypes.func,\n  onMoveEnd: PropTypes.func,\n  onMoving: PropTypes.func\n}\n\nexport default MovableSelection\n","import React, { PureComponent, Fragment, createRef } from 'react'\nimport PropTypes from 'prop-types'\n\nimport MovableSelection from '../../../MovableSelection/MovableSelection'\n\nclass ZoneSelection extends PureComponent {\n  constructor (...args) {\n    super(...args)\n    this.canvasRef = createRef()\n\n    this.state = {\n      originCoords: this.props.coords\n    }\n  }\n  render () {\n    return (\n      <Fragment>\n        <canvas\n          ref={this.canvasRef}\n          onPointerDown={e =>\n            e.target === e.currentTarget && this.props.onClickOutside(e)}\n        />\n        <MovableSelection\n          {...this.props.coords}\n          onResizing={this.handleResizing}\n          onResizeEnd={this.handleResizeEnd}\n          onMoving={this.handleMoving}\n          onMoveEnd={this.handleMoveEnd}\n          hideBorderOnResizing={false}\n        />\n      </Fragment>\n    )\n  }\n\n  componentDidMount () {\n    const oldCanvas = document.createElement('canvas')\n    oldCanvas.width = this.props.imageData.width\n    oldCanvas.height = this.props.imageData.height\n    this.oldCtx = oldCanvas.getContext('2d')\n    this.oldCtx.putImageData(this.props.imageData, 0, 0)\n\n    this.canvasRef.current.width = this.props.imageData.width\n    this.canvasRef.current.height = this.props.imageData.height\n    this.newCtx = this.canvasRef.current.getContext('2d')\n    this.newCtx.imageSmoothingEnabled = false\n  }\n\n  handleResizing = ({ top, left, width, height }) => {}\n  handleResizeEnd = ({ top, left, width, height }) => {\n    if (!this.backgroundColor) {\n      this.backgroundColor = this.props.secondaryColor\n      this.newCtx.fillStyle = `rgb(${this.backgroundColor.r}, ${this.backgroundColor.g}, ${this.backgroundColor.b})`\n    }\n    this.props.onCoordsChanged({ top, left, width, height })\n    this.props.onImageChanged(\n      this.newCtx.getImageData(\n        0,\n        0,\n        this.newCtx.canvas.width,\n        this.newCtx.canvas.height\n      )\n    )\n  }\n  handleMoving = ({ top, left, width, height }) => {\n    if (!this.backgroundColor) {\n      this.backgroundColor = this.props.secondaryColor\n      this.newCtx.fillStyle = `rgb(${this.backgroundColor.r}, ${this.backgroundColor.g}, ${this.backgroundColor.b})`\n    }\n    this.props.onCoordsChanged({ top, left, width, height })\n  }\n  handleMoveEnd = ({ top, left, width, height }) => {\n    this.props.onImageChanged(\n      this.newCtx.getImageData(\n        0,\n        0,\n        this.newCtx.canvas.width,\n        this.newCtx.canvas.height\n      )\n    )\n  }\n\n  redrawCanvas = updateOld => {\n    if (updateOld) {\n      this.oldCtx.canvas.width = this.props.imageData.width\n      this.oldCtx.canvas.height = this.props.imageData.height\n      this.newCtx.canvas.width = this.props.imageData.width\n      this.newCtx.canvas.height = this.props.imageData.height\n      this.newCtx.imageSmoothingEnabled = false\n      this.oldCtx.putImageData(this.props.imageData, 0, 0)\n    }\n\n    this.newCtx.drawImage(this.oldCtx.canvas, 0, 0)\n\n    if (this.props.coords && this.state.originCoords) {\n      this.newCtx.fillRect(\n        this.state.originCoords.left,\n        this.state.originCoords.top,\n        this.state.originCoords.width,\n        this.state.originCoords.height\n      )\n      this.newCtx.drawImage(\n        this.oldCtx.canvas,\n        this.state.originCoords.left,\n        this.state.originCoords.top,\n        this.state.originCoords.width,\n        this.state.originCoords.height,\n        this.props.coords.left,\n        this.props.coords.top,\n        this.props.coords.width,\n        this.props.coords.height\n      )\n    }\n  }\n\n  componentDidUpdate (prevProps) {\n    this.redrawCanvas(false)\n  }\n}\n\nZoneSelection.propTypes = {\n  coords: PropTypes.shape({\n    top: PropTypes.number.isRequired,\n    left: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired\n  }).isRequired,\n  backgroundColor: PropTypes.shape({\n    r: PropTypes.number.isRequired,\n    g: PropTypes.number.isRequired,\n    b: PropTypes.number.isRequired\n  }),\n  imageData: PropTypes.instanceOf(ImageData).isRequired,\n  onCoordsChanged: PropTypes.func.isRequired,\n  onImageChanged: PropTypes.func.isRequired,\n  onClickOutside: PropTypes.func.isRequired\n}\n\nexport default ZoneSelection\n","import React, { PureComponent, Fragment, createRef } from 'react'\nimport PropTypes from 'prop-types'\n\nimport MovableSelection from '../../../MovableSelection/MovableSelection'\n\nclass ImageDataSelection extends PureComponent {\n  constructor (...args) {\n    super(...args)\n\n    this.canvasRef = createRef()\n\n    if (\n      this.props.imageData.width < this.props.selectionImageData.width ||\n      this.props.imageData.height < this.props.selectionImageData.height\n    ) {\n      this.resized = true\n      this.resizeCanvasToFitPasted()\n      this.props.onSelectionChanged({\n        coords: this.props.coords,\n        imageData: this.props.selectionImageData\n      })\n      this.updateOld = true\n    }\n  }\n\n  render () {\n    return (\n      <Fragment>\n        <canvas\n          ref={this.canvasRef}\n          onPointerDown={e =>\n            e.target === e.currentTarget && this.props.onClickOutside(e)}\n        />\n        <MovableSelection\n          {...this.props.coords}\n          onResizing={this.handleResizing}\n          onResizeEnd={this.handleResizeEnd}\n          onMoving={this.handleMoving}\n          onMoveEnd={this.handleMoveEnd}\n          hideBorderOnResizing={false}\n        />\n      </Fragment>\n    )\n  }\n\n  componentDidMount () {\n    this.updateOldCanvas()\n    this.updateSelectionCanvas()\n    this.updateNewCanvas()\n    this.props.onImageChanged(\n      this.newCtx.getImageData(\n        0,\n        0,\n        this.newCtx.canvas.width,\n        this.newCtx.canvas.height\n      )\n    )\n  }\n\n  componentDidUpdate (prevProps) {\n    if (this.updateOld) {\n      this.updateOldCanvas()\n    }\n    if (this.props.selectionImageData !== prevProps.selectionImageData) {\n      this.updateSelectionCanvas()\n    }\n    this.updateNewCanvas()\n    if (this.resized) {\n      this.resized = false\n      this.props.onImageChanged(\n        this.newCtx.getImageData(\n          0,\n          0,\n          this.newCtx.canvas.width,\n          this.newCtx.canvas.height\n        )\n      )\n      this.updateOld = false\n      return\n    }\n    this.updateOld = true\n    if (this.props.selectionImageData !== prevProps.selectionImageData) {\n      this.props.onImageChanged(\n        this.newCtx.getImageData(\n          0,\n          0,\n          this.newCtx.canvas.width,\n          this.newCtx.canvas.height\n        )\n      )\n    }\n  }\n\n  updateOldCanvas = () => {\n    if (!this.oldCtx) {\n      const oldCanvas = document.createElement('canvas')\n      this.oldCtx = oldCanvas.getContext('2d')\n    }\n    this.oldCtx.canvas.width = this.props.imageData.width\n    this.oldCtx.canvas.height = this.props.imageData.height\n    this.oldCtx.putImageData(this.props.imageData, 0, 0)\n  }\n\n  updateSelectionCanvas = () => {\n    if (!this.selectionCtx) {\n      const selectionCanvas = document.createElement('canvas')\n      this.selectionCtx = selectionCanvas.getContext('2d')\n    }\n    this.selectionCtx.canvas.width = this.props.selectionImageData.width\n    this.selectionCtx.canvas.height = this.props.selectionImageData.height\n    this.selectionCtx.putImageData(this.props.selectionImageData, 0, 0)\n  }\n\n  updateNewCanvas = () => {\n    if (!this.newCtx) {\n      this.canvasRef.current.width = this.oldCtx.canvas.width\n      this.canvasRef.current.height = this.oldCtx.canvas.height\n      this.newCtx = this.canvasRef.current.getContext('2d')\n      this.newCtx.imageSmoothingEnabled = false\n    }\n\n    if (\n      this.newCtx.canvas.width !== this.oldCtx.canvas.width ||\n      this.newCtx.canvas.height !== this.oldCtx.canvas.height\n    ) {\n      this.newCtx.canvas.width = this.oldCtx.canvas.width\n      this.newCtx.canvas.height = this.oldCtx.canvas.height\n      this.newCtx.imageSmoothingEnabled = false\n    }\n\n    this.newCtx.drawImage(this.oldCtx.canvas, 0, 0)\n\n    this.newCtx.drawImage(\n      this.selectionCtx.canvas,\n      0,\n      0,\n      this.selectionCtx.canvas.width,\n      this.selectionCtx.canvas.height,\n      this.props.coords.left,\n      this.props.coords.top,\n      this.props.coords.width,\n      this.props.coords.height\n    )\n  }\n\n  handleResizing = ({ top, left, width, height }) => {}\n  handleResizeEnd = ({ top, left, width, height }) => {\n    if (!this.backgroundColor) {\n      this.backgroundColor = this.props.secondaryColor\n      this.newCtx.fillStyle = `rgb(${this.backgroundColor.r}, ${this.backgroundColor.g}, ${this.backgroundColor.b})`\n    }\n    this.updateOld = false\n    this.props.onSelectionChanged({\n      coords: { top, left, width, height },\n      imageData: this.props.selectionImageData\n    })\n    this.updateOld = false\n    this.props.onImageChanged(\n      this.newCtx.getImageData(\n        0,\n        0,\n        this.newCtx.canvas.width,\n        this.newCtx.canvas.height\n      )\n    )\n  }\n  handleMoving = ({ top, left, width, height }) => {\n    if (!this.backgroundColor) {\n      this.backgroundColor = this.props.secondaryColor\n      this.newCtx.fillStyle = `rgb(${this.backgroundColor.r}, ${this.backgroundColor.g}, ${this.backgroundColor.b})`\n    }\n    this.updateOld = false\n    this.props.onSelectionChanged({\n      coords: { top, left, width, height },\n      imageData: this.props.selectionImageData\n    })\n  }\n  handleMoveEnd = ({ top, left, width, height }) => {\n    this.updateOld = false\n    this.props.onImageChanged(\n      this.newCtx.getImageData(\n        0,\n        0,\n        this.newCtx.canvas.width,\n        this.newCtx.canvas.height\n      )\n    )\n  }\n\n  resizeCanvasToFitPasted = () => {\n    const canvas = document.createElement('canvas')\n    canvas.width = Math.max(\n      this.props.imageData.width,\n      this.props.selectionImageData.width\n    )\n    canvas.height = Math.max(\n      this.props.imageData.height,\n      this.props.selectionImageData.height\n    )\n    const ctx = canvas.getContext('2d')\n\n    ctx.fillStyle = `rgb(${this.props.secondaryColor.r}, ${this.props.secondaryColor.g}, ${this.props.secondaryColor.b})`\n    ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)\n    ctx.putImageData(this.props.imageData, 0, 0)\n\n    this.props.onImageChanged(\n      ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height)\n    )\n  }\n}\n\nImageDataSelection.propTypes = {\n  coords: PropTypes.shape({\n    top: PropTypes.number.isRequired,\n    left: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired\n  }).isRequired,\n  selectionImageData: PropTypes.instanceOf(ImageData).isRequired,\n  backgroundColor: PropTypes.shape({\n    r: PropTypes.number.isRequired,\n    g: PropTypes.number.isRequired,\n    b: PropTypes.number.isRequired\n  }),\n  imageData: PropTypes.instanceOf(ImageData).isRequired,\n  onSelectionChanged: PropTypes.func.isRequired,\n  onImageChanged: PropTypes.func.isRequired,\n  onClickOutside: PropTypes.func.isRequired\n}\n\nexport default ImageDataSelection\n","import React, { PureComponent, createRef } from 'react'\n\nimport { connect } from 'react-redux'\n\nimport ZoneSelection from './ZoneSelection/ZoneSelection'\nimport ImageDataSelection from './ImageDataSelection/ImageDataSelection'\n\nimport './SelectionInstrument.css'\n\nimport { changeSelection } from './actions'\nimport { changeImage } from '../../App/actions'\n\n// the selection is not working quite right:\n// there's no way a person can select the full width\n// of the picture, because max coordinate is width-1.\n// interesting that full height is selectable though.\n// at least it works somehow, will polish it later maybe.\n\nclass SelectionInstrument extends PureComponent {\n  constructor (...args) {\n    super(...args)\n\n    this.state = {\n      selecting: false,\n      selectingX: null,\n      selectingY: null,\n      selectingCoords: null\n    }\n\n    this.containerRef = createRef()\n\n    // todo - imageData selection handling\n  }\n  render () {\n    let El\n    if (this.state.selecting && this.state.selectingCoords) {\n      El = (\n        <div\n          className='selecting'\n          style={{\n            top: `${this.state.selectingCoords.top}px`,\n            left: `${this.state.selectingCoords.left}px`,\n            width: `${this.state.selectingCoords.width}px`,\n            height: `${this.state.selectingCoords.height}px`\n          }}\n        />\n      )\n    } else if (this.props.selectionImageData) {\n      El = (\n        <ImageDataSelection\n          onClickOutside={e => this.handlePointerDown(e, true)}\n          imageData={this.props.imageData}\n          coords={this.props.selectionCoords}\n          selectionImageData={this.props.selectionImageData}\n          onSelectionChanged={this.props.changeSelection}\n          onImageChanged={imageData => this.props.changeImage(imageData)}\n          secondaryColor={this.props.secondaryColor}\n        />\n      )\n    } else if (this.props.selectionCoords) {\n      El = (\n        <ZoneSelection\n          onClickOutside={e => this.handlePointerDown(e, true)}\n          imageData={this.props.imageData}\n          coords={this.props.selectionCoords}\n          onCoordsChanged={zone =>\n            this.props.changeSelection({ coords: zone, imageData: null })}\n          onImageChanged={imageData => this.props.changeImage(imageData)}\n          secondaryColor={this.props.secondaryColor}\n        />\n      )\n    } else El = null\n    return (\n      <div\n        className='selection'\n        onPointerDown={this.handlePointerDown}\n        ref={this.containerRef}\n      >\n        {El}\n      </div>\n    )\n  }\n  handlePointerDown = (e, trusted) => {\n    if (e.target !== e.currentTarget && !trusted) return\n\n    this.backgroundColor = null\n    this.props.changeSelection({ coords: null, imageData: null })\n\n    let {\n      top,\n      left,\n      bottom,\n      right\n    } = this.containerRef.current.getBoundingClientRect()\n    ;[top, left, bottom, right] = [\n      top + window.pageYOffset,\n      left + window.pageXOffset,\n      bottom + window.pageYOffset,\n      right + window.pageXOffset\n    ]\n    const [mouseX, mouseY] = [\n      e.clientX + window.pageXOffset,\n      e.clientY + window.pageYOffset\n    ]\n    ;[top, left] = [Math.ceil(mouseY - top), Math.ceil(mouseX - left)]\n    this.setState({\n      selecting: true,\n      selectingY: top,\n      selectingX: left,\n      selectingCoords: null\n    })\n  }\n  handleDocumentPointerMove = e => {\n    if (!this.state.selecting) return\n\n    switch (e.buttons) {\n      case 1:\n        this.setState(state => {\n          // getting bounding rect and mouse coords relatively to document, not viewport\n          let {\n            top,\n            left,\n            bottom,\n            right\n          } = this.containerRef.current.getBoundingClientRect()\n          ;[top, left, bottom, right] = [\n            top + window.pageYOffset,\n            left + window.pageXOffset,\n            bottom + window.pageYOffset,\n            right + window.pageXOffset\n          ]\n          const [mouseX, mouseY] = [\n            e.clientX + window.pageXOffset,\n            e.clientY + window.pageYOffset\n          ]\n\n          // getting top and left coordinates of current mouse position relatively to canvas\n          let [canvasRelativeTop, canvasRelativeLeft] = [\n            Math.trunc(mouseY - top),\n            Math.trunc(mouseX - left)\n          ]\n          // clamping top and left coordinates between 0 and canvas width\n          //\n          ;[canvasRelativeTop, canvasRelativeLeft] = [\n            Math.max(\n              0,\n              Math.min(canvasRelativeTop, this.props.imageData.height)\n            ),\n            Math.max(\n              0,\n              Math.min(canvasRelativeLeft, this.props.imageData.width)\n            )\n          ]\n\n          // console.log(canvasRelativeTop, canvasRelativeLeft)\n\n          const selectingCoords = {\n            top: Math.min(state.selectingY, canvasRelativeTop),\n            left: Math.min(state.selectingX, canvasRelativeLeft),\n            width: Math.max(\n              Math.max(state.selectingX, canvasRelativeLeft) -\n                Math.min(state.selectingX, canvasRelativeLeft),\n              0\n            ),\n            height: Math.max(\n              Math.max(state.selectingY, canvasRelativeTop) -\n                Math.min(state.selectingY, canvasRelativeTop),\n              0\n            )\n          }\n\n          return {\n            selectingCoords\n          }\n        })\n        break\n      case 2:\n      case 3:\n        this.setState({\n          selecting: false,\n          selectingX: null,\n          selectingY: null,\n          selectingCoords: null\n        })\n        this.preventContextMenu = true\n        break // no default\n    }\n  }\n  handleDocumentPointerUp = e => {\n    this.setState(state => {\n      let selectionOriginCoords = null\n      // also checking if user just clicked without moving (so there's no selectionCoords)\n      if (state.selecting && this.state.selectingCoords) {\n        if (\n          this.state.selectingCoords.width > 0 &&\n          this.state.selectingCoords.height > 0\n        ) {\n          this.props.changeSelection({\n            coords: this.state.selectingCoords,\n            imageData: null\n          })\n          selectionOriginCoords = this.state.selectingCoords\n        }\n        return {\n          selecting: false,\n          selectingX: null,\n          selectingY: null,\n          selectingCoords: null,\n          selectionOriginCoords\n        }\n      } else {\n        return {\n          selecting: false,\n          selectingX: null,\n          selectingY: null\n        }\n      }\n    })\n  }\n\n  componentDidMount () {\n    document.addEventListener('pointermove', this.handleDocumentPointerMove, {\n      passive: true\n    })\n    document.addEventListener('pointerup', this.handleDocumentPointerUp, {\n      passive: true\n    })\n    document.addEventListener('contextmenu', this.handleContextMenu)\n  }\n  componentWillUnmount () {\n    document.removeEventListener(\n      'pointermove',\n      this.handleDocumentPointerMove,\n      { passive: true }\n    )\n    document.removeEventListener('pointerup', this.handleDocumentPointerUp, {\n      passive: true\n    })\n    document.removeEventListener('contextmenu', this.handleContextMenu)\n  }\n\n  handleContextMenu = e => {\n    if (this.preventContextMenu) {\n      e.preventDefault()\n      this.preventContextMenu = false\n    }\n  }\n}\n\nconst mapStateToProps = state => ({\n  imageData: state.image.data,\n  selectionCoords: state.instruments.selection\n    ? state.instruments.selection.coords\n    : null,\n  selectionImageData: state.instruments.selection\n    ? state.instruments.selection.imageData\n    : null,\n  secondaryColor: state.colors.list[state.colors.secondary]\n})\nconst mapDispatchToProps = dispatch => ({\n  changeSelection: (zone, imageData) =>\n    dispatch(changeSelection(zone, imageData)),\n  changeImage: imageData => dispatch(changeImage(imageData))\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SelectionInstrument)\n","import { types } from '../actions'\n\nexport function changeSelection ({coords, imageData}) {\n  return {\n    type: types.CHANGE_INSTRUMENT,\n    instrument: 'selection',\n    selection: {\n      coords,\n      imageData\n    }\n  }\n}\n\nexport function disableSelection () {\n  return {\n    type: types.CHANGE_INSTRUMENT,\n    selection: {\n      coords: null,\n      imageData: null\n    }\n  }\n}\n","import React, { PureComponent, createRef } from 'react'\n\nimport { connect } from 'react-redux'\n\nimport './Pen.css'\nimport { bresenhamLine, getCanvasCoordsFromEvent } from '../../helpers'\nimport { changeImage } from '../../App/actions'\n\nclass Pen extends PureComponent {\n  constructor (...args) {\n    super(...args)\n    this.isDrawing = false\n    this.prevX = 0\n    this.prevY = 0\n    this.canvasRef = createRef()\n    this.ctx = undefined\n  }\n  render () {\n    return (\n      <canvas\n        className='pen-canvas'\n        ref={this.canvasRef}\n        width={this.props.imageData ? this.props.imageData.width : 0}\n        height={this.props.imageData ? this.props.imageData.height : 0}\n        onPointerDown={this.handlePointerDown}\n        onPointerUp={this.handlePointerUp}\n        onPointerMove={this.handlePointerMove}\n        onPointerEnter={this.handlePointerEnter}\n        onPointerLeave={this.handlePointerLeave}\n      />\n    )\n  }\n  handlePointerDown = e => {\n    this.isDrawing = true\n    this.beginDrawing(...getCanvasCoordsFromEvent(this.canvasRef.current, e))\n  }\n  handlePointerMove = e => {\n    if (this.isDrawing && e.buttons !== 3) {\n      this.continueDrawing(\n        ...getCanvasCoordsFromEvent(this.canvasRef.current, e)\n      )\n    }\n  }\n  handlePointerEnter = e => {\n    if (e.buttons === 1 && this.isDrawing) {\n      this.continueDrawing(\n        ...getCanvasCoordsFromEvent(this.canvasRef.current, e)\n      )\n    } else {\n      this.isDrawing = false\n    }\n  }\n  handlePointerLeave = e => {\n    if (this.isDrawing) {\n      this.continueDrawing(\n        ...getCanvasCoordsFromEvent(this.canvasRef.current, e)\n      )\n    }\n  }\n  handleDocumentPointerUp = () => {\n    if (this.isDrawing) {\n      this.isDrawing = false\n      this.endDrawing()\n    }\n  }\n  handleDocumentPointerMove = e => {\n    if (e.target !== this.canvasRef.current) {\n      ;[this.prevX, this.prevY] = getCanvasCoordsFromEvent(\n        this.canvasRef.current,\n        e\n      )\n    }\n    if (this.isDrawing && e.button === 2) {\n      this.preventContextMenu = true\n      this.cancelDrawing()\n    }\n  }\n  handleDocumentContextMenu = e => {\n    if (this.isDrawing) {\n      e.preventDefault()\n      this.isDrawing = false\n    }\n  }\n  handleDocumentSelectStart = e => {\n    if (this.isDrawing) {\n      e.preventDefault()\n    }\n  }\n  componentDidMount () {\n    this.ctx = this.canvasRef.current.getContext('2d')\n    if (this.props.imageData != null) {\n      this.ctx.putImageData(this.props.imageData, 0, 0)\n    }\n    document.addEventListener('pointerup', this.handleDocumentPointerUp)\n    document.addEventListener('pointermove', this.handleDocumentPointerMove)\n    document.addEventListener('selectstart', this.handleDocumentSelectStart)\n    document.addEventListener('contextmenu', this.handleDocumentContextMenu)\n  }\n  componentWillUnmount () {\n    document.removeEventListener('pointerup', this.handleDocumentPointerUp)\n    document.removeEventListener('pointermove', this.handleDocumentPointerMove)\n    document.removeEventListener('selectstart', this.handleDocumentSelectStart)\n    document.removeEventListener('contextmenu', this.handleDocumentContextMenu)\n  }\n  componentDidUpdate () {\n    if (this.props.imageData != null) {\n      this.ctx.putImageData(this.props.imageData, 0, 0)\n    }\n  }\n  beginDrawing = (x, y) => {\n    const { r, g, b } = this.props.color\n    this.ctx.fillStyle = `rgb(${r},${g},${b})`\n    this.ctx.fillRect(x, y, 1, 1)\n    ;[this.prevX, this.prevY] = [x, y]\n  }\n  continueDrawing = (x, y) => {\n    bresenhamLine(this.prevX, this.prevY, x, y, this.drawPoint)\n    ;[this.prevX, this.prevY] = [x, y]\n  }\n  endDrawing = () => {\n    this.props.dispatch(\n      changeImage(\n        this.ctx.getImageData(\n          0,\n          0,\n          this.canvasRef.current.width,\n          this.canvasRef.current.height\n        )\n      )\n    )\n  }\n  cancelDrawing = () => {\n    this.ctx.putImageData(this.props.imageData, 0, 0)\n  }\n  drawPoint = (x, y) => {\n    this.ctx.fillRect(x, y, 1, 1)\n  }\n}\n\nconst mapStateToProps = state => ({\n  color: state.colors.list[state.colors.primary],\n  imageData: state.image.data\n})\n\nexport default connect(mapStateToProps)(Pen)\n","import React, { PureComponent, createRef } from 'react'\n\nimport { connect } from 'react-redux'\n\nimport './Fill.css'\nimport { getCanvasCoordsFromEvent } from '../../helpers'\nimport { changeImage } from '../../App/actions'\n\nclass Fill extends PureComponent {\n  constructor (...args) {\n    super(...args)\n    this.canvasRef = createRef()\n  }\n  render () {\n    return (\n      <canvas\n        className='fill-canvas'\n        ref={this.canvasRef}\n        width={this.props.imageData ? this.props.imageData.width : 0}\n        height={this.props.imageData ? this.props.imageData.height : 0}\n        onMouseDown={this.handleMouseDown}\n      />\n    )\n  }\n  handleMouseDown = e => {\n    const [x, y] = getCanvasCoordsFromEvent(this.canvasRef.current, e)\n    const data = this.ctx.getImageData(\n      0,\n      0,\n      this.canvasRef.current.width,\n      this.canvasRef.current.height\n    )\n    this.floodFill(\n      data,\n      x,\n      y,\n      {\n        r: data.data[(y * data.width + x) * 4],\n        g: data.data[(y * data.width + x) * 4 + 1],\n        b: data.data[(y * data.width + x) * 4 + 2]\n      },\n      this.props.color\n    )\n    this.props.dispatch(changeImage(data))\n  }\n  // optimized the shit out of it (as I can judge) \n  floodFill = (data, x, y, colorToReplace, colorToFillWith) => {\n    const replaceR = colorToReplace.r,\n      replaceG = colorToReplace.g,\n      replaceB = colorToReplace.b\n    const fillR = colorToFillWith.r,\n      fillG = colorToFillWith.g,\n      fillB = colorToFillWith.b\n\n    const i = (y * data.width + x) * 4\n\n    if (\n      !(replaceR === data.data[i] &&\n        replaceG === data.data[i + 1] &&\n        replaceB === data.data[i + 2]) ||\n      (replaceR === fillR && replaceG === fillG && replaceB === fillB)\n    ) {\n      return\n    }\n\n    const q = []\n\n    data.data[i] = fillR\n    data.data[i + 1] = fillG\n    data.data[i + 2] = fillB\n\n    q.push([x, y])\n\n    while (q.length !== 0) {\n      const n = q.shift()\n      const i = (n[1] * data.width + n[0]) * 4\n      if (\n        n[0] > 0 &&\n        (replaceR === data.data[i - 4] &&\n          replaceG === data.data[i - 3] &&\n          replaceB === data.data[i - 2])\n      ) {\n        data.data[i - 4] = fillR\n        data.data[i - 3] = fillG\n        data.data[i - 2] = fillB\n        q.push([n[0] - 1, n[1]])\n      }\n      if (\n        n[0] < data.width - 1 &&\n        (replaceR === data.data[i + 4] &&\n          replaceG === data.data[i + 5] &&\n          replaceB === data.data[i + 6])\n      ) {\n        data.data[i + 4] = fillR\n        data.data[i + 5] = fillG\n        data.data[i + 6] = fillB\n        q.push([n[0] + 1, n[1]])\n      }\n      if (\n        n[1] > 0 &&\n        (replaceR === data.data[i - data.width * 4] &&\n          replaceG === data.data[i - data.width * 4 + 1] &&\n          replaceB === data.data[i - data.width * 4 + 2])\n      ) {\n        data.data[i - data.width * 4] = fillR\n        data.data[i - data.width * 4 + 1] = fillG\n        data.data[i - data.width * 4 + 2] = fillB\n        q.push([n[0], n[1] - 1])\n      }\n      if (\n        n[1] < data.height - 1 &&\n        (replaceR === data.data[i + data.width * 4] &&\n          replaceG === data.data[i + data.width * 4 + 1] &&\n          replaceB === data.data[i + data.width * 4 + 2])\n      ) {\n        data.data[i + data.width * 4] = fillR\n        data.data[i + data.width * 4 + 1] = fillG\n        data.data[i + data.width * 4 + 2] = fillB\n        q.push([n[0], n[1] + 1])\n      }\n    }\n  }\n  componentDidMount () {\n    this.ctx = this.canvasRef.current.getContext('2d')\n    if (this.props.imageData != null) {\n      this.ctx.putImageData(this.props.imageData, 0, 0)\n    }\n  }\n  componentDidUpdate () {\n    this.ctx.putImageData(this.props.imageData, 0, 0)\n  }\n}\n\nconst mapStateToProps = state => ({\n  color: state.colors.list[state.colors.primary],\n  imageData: state.image.data\n})\n\nexport default connect(mapStateToProps)(Fill)\n","export const types = {\n  ADD_COLOR: 'colors/add',\n  SELECT_COLOR: 'colors/select',\n  CHANGE_ACTIVE_COLOR: 'colors/change-active'\n}\n\nexport function changeActiveColor (activeColor) {\n  return {\n    type: types.CHANGE_ACTIVE_COLOR,\n    activeColor\n  }\n}\n\nexport function addColorFromInput (e) {\n  return (dispatch, getState) => {\n    const hexRgb = e.target.value.match(/[A-Za-z0-9]{2}/g)\n    const rgb = hexRgb.map(v => parseInt(v, 16))\n    const rgbObject = { r: rgb[0], g: rgb[1], b: rgb[2] }\n    const rgbObjectString = JSON.stringify(rgbObject)\n    let found = false\n    for (let i = 0; i < getState().colors.list.length; i++) {\n      if (JSON.stringify(getState().colors.list[i]) === rgbObjectString) {\n        found = true\n        break\n      }\n    }\n    if (!found) {\n      dispatch({\n        type: types.ADD_COLOR,\n        value: rgbObject\n      })\n    }\n  }\n}\n\nexport function addColor (rgbObject) {\n  return (dispatch, getState) => {\n    let found = false\n    const rgbObjectString = JSON.stringify(rgbObject)\n    for (let i = 0; i < getState().colors.list.length; i++) {\n      if (JSON.stringify(getState().colors.list[i]) === rgbObjectString) {\n        found = i\n        break\n      }\n    }\n    if (found === false) {\n      dispatch({\n        type: types.ADD_COLOR,\n        value: rgbObject\n      })\n    } else {\n      dispatch(selectColor(found))\n    }\n  }\n}\n\nexport function selectColor (index) {\n  return {\n    type: types.SELECT_COLOR,\n    index\n  }\n}\n","import React, { PureComponent } from 'react'\n\nimport { connect } from 'react-redux'\nimport { addColor } from '../../Colors/actions'\nimport { selectInstrument } from '../actions'\nimport './Dropper.css'\n\nclass Dropper extends PureComponent {\n  render () {\n    return (\n      <div\n        className='dropper'\n        onClick={this.handleClick}\n        style={{\n          width: this.props.imageData.width,\n          height: this.props.imageData.height\n        }}\n      />\n    )\n  }\n  handleClick = e => {\n    if (e.target !== e.currentTarget) return\n\n    let { top, left, bottom, right } = e.target.getBoundingClientRect()\n    ;[top, left, bottom, right] = [\n      top + window.pageYOffset,\n      left + window.pageXOffset,\n      bottom + window.pageYOffset,\n      right + window.pageXOffset\n    ]\n    const [mouseX, mouseY] = [\n      e.clientX + window.pageXOffset,\n      e.clientY + window.pageYOffset\n    ]\n    ;[top, left] = [Math.ceil(mouseY - top), Math.ceil(mouseX - left)]\n    \n    const i = (top*this.props.imageData.width + left)*4\n    \n    this.props.addColor({\n      r: this.props.imageData.data[i],\n      g: this.props.imageData.data[i+1],\n      b: this.props.imageData.data[i+2]\n    })\n    this.props.selectInstrument('pen')\n  }\n}\n\nconst mapStateToProps = state => ({\n  imageData: state.image.data\n})\nconst mapDispatchToProps = dispatch => ({\n  addColor: color => dispatch(addColor(color)),\n  selectInstrument: instrument => dispatch(selectInstrument(instrument))\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Dropper)\n","import React, { PureComponent, createRef } from 'react'\n\nimport { connect } from 'react-redux'\n\nimport './Eraser.css'\nimport { bresenhamLine, getCanvasCoordsFromEvent } from '../../helpers'\nimport { changeImage } from '../../App/actions'\n\nclass Eraser extends PureComponent {\n  constructor (...args) {\n    super(...args)\n    this.canvasRef = createRef()\n    this.ctx = null\n    const noCursorCanvas = document.createElement('canvas')\n    this.noCursorCtx = noCursorCanvas.getContext('2d')\n    this.isDrawing = false\n    this.prevX = 0\n    this.prevY = 0\n  }\n  render () {\n    return (\n      <canvas\n        className='eraser-canvas'\n        ref={this.canvasRef}\n        width={this.props.imageData ? this.props.imageData.width : 0}\n        height={this.props.imageData ? this.props.imageData.height : 0}\n        onPointerDown={this.handlePointerDown}\n        onPointerUp={this.handlePointerUp}\n        onPointerMove={this.handlePointerMove}\n        onPointerEnter={this.handlePointerEnter}\n        onPointerLeave={this.handlePointerLeave}\n      />\n    )\n  }\n  handlePointerDown = e => {\n    this.isDrawing = true\n    this.drawPoint()\n    this.beginDrawing(...getCanvasCoordsFromEvent(this.canvasRef.current, e))\n  }\n  handlePointerMove = e => {\n    const [x, y] = getCanvasCoordsFromEvent(this.canvasRef.current, e)\n    if (this.isDrawing && e.buttons !== 3) {\n      this.continueDrawing(\n        x, y\n      )\n    }\n    this.updateCanvas(x, y)\n  }\n  handlePointerEnter = e => {\n    if (e.buttons === 1 && this.isDrawing) {\n      this.continueDrawing(\n        ...getCanvasCoordsFromEvent(this.canvasRef.current, e)\n      )\n    } else {\n      this.isDrawing = false\n    }\n  }\n  handlePointerLeave = e => {\n    if (this.isDrawing) {\n      this.continueDrawing(\n        ...getCanvasCoordsFromEvent(this.canvasRef.current, e)\n      )\n    }\n    this.updateCanvas()\n  }\n\n  handleDocumentPointerUp = () => {\n    if (this.isDrawing) {\n      this.isDrawing = false\n      this.endDrawing()\n    }\n  }\n  handleDocumentPointerMove = e => {\n    if (e.target !== this.canvasRef.current) {\n      ;[this.prevX, this.prevY] = getCanvasCoordsFromEvent(\n        this.canvasRef.current,\n        e\n      )\n    }\n    if (this.isDrawing && e.button === 2) {\n      this.preventContextMenu = true\n      this.cancelDrawing()\n    }\n  }\n  handleDocumentContextMenu = e => {\n    if (this.isDrawing) {\n      e.preventDefault()\n      this.isDrawing = false\n    }\n  }\n  handleDocumentSelectStart = e => {\n    if (this.isDrawing) {\n      e.preventDefault()\n    }\n  }\n\n  componentDidMount () {\n    this.ctx = this.canvasRef.current.getContext('2d')\n    const { r, g, b } = this.props.color\n    this.ctx.fillStyle = `rgb(${r},${g},${b})`\n    this.ctx.strokeStyle = \"black\"\n    this.noCursorCtx.fillStyle = `rgb(${r},${g},${b})`\n    this.updateCanvasNoCursor()\n    document.addEventListener('pointerup', this.handleDocumentPointerUp)\n    document.addEventListener('pointermove', this.handleDocumentPointerMove)\n    document.addEventListener('selectstart', this.handleDocumentSelectStart)\n    document.addEventListener('contextmenu', this.handleDocumentContextMenu)\n  }\n  componentDidUpdate () {\n    const { r, g, b } = this.props.color\n    this.ctx.fillStyle = `rgb(${r},${g},${b})`\n    this.noCursorCtx.fillStyle = `rgb(${r},${g},${b})`\n    this.updateCanvasNoCursor()\n  }\n  componentWillUnmount () {\n    document.removeEventListener('pointerup', this.handleDocumentPointerUp)\n    document.removeEventListener('pointermove', this.handleDocumentPointerMove)\n    document.removeEventListener('selectstart', this.handleDocumentSelectStart)\n    document.removeEventListener('contextmenu', this.handleDocumentContextMenu)\n  }\n\n  beginDrawing = (x, y) => {\n    const { r, g, b } = this.props.color\n    this.ctx.fillStyle = `rgb(${r},${g},${b})`\n    this.drawPoint(x, y)\n    ;[this.prevX, this.prevY] = [x, y]\n  }\n  continueDrawing = (x, y) => {\n    bresenhamLine(this.prevX, this.prevY, x, y, this.drawPoint)\n    ;[this.prevX, this.prevY] = [x, y]\n  }\n  endDrawing = () => {\n    this.props.dispatch(\n      changeImage(\n        this.noCursorCtx.getImageData(\n          0,\n          0,\n          this.noCursorCtx.canvas.width,\n          this.noCursorCtx.canvas.height\n        )\n      )\n    )\n  }\n  cancelDrawing = () => {\n    this.noCursorCtx.putImageData(this.props.imageData, 0, 0)\n  }\n  drawPoint = (x, y) => {\n    this.noCursorCtx.fillRect(\n      x - this.props.thickness / 2,\n      y - this.props.thickness / 2,\n      this.props.thickness,\n      this.props.thickness\n    )\n  }\n\n  updateCanvasNoCursor = () => {\n    if (this.props.imageData != null) {\n      [this.noCursorCtx.canvas.width, this.noCursorCtx.canvas.height] = [this.props.imageData.width, this.props.imageData.height]\n      const { r, g, b } = this.props.color\n      this.noCursorCtx.fillStyle = `rgb(${r},${g},${b})`\n      ;this.noCursorCtx.putImageData(this.props.imageData, 0, 0)\n    }\n  }\n  updateCanvas = (x, y) => {\n    this.ctx.drawImage(this.noCursorCtx.canvas, 0, 0)\n    if (x && y) {\n      this.ctx.fillRect(\n        x - this.props.thickness / 2,\n        y - this.props.thickness / 2,\n        this.props.thickness,\n        this.props.thickness\n      )\n      this.ctx.strokeRect(\n        x - this.props.thickness / 2 + 0.5,\n        y - this.props.thickness / 2 + 0.5,\n        this.props.thickness - 1,\n        this.props.thickness - 1\n      )\n    }\n  }\n}\n\nconst mapStateToProps = state => ({\n  color: state.colors.list[state.colors.secondary],\n  imageData: state.image.data,\n  thickness: 8 // insert true one after thickness is made\n})\n\nexport default connect(mapStateToProps)(Eraser)\n","import React, { PureComponent } from 'react'\nimport PropTypes from 'prop-types'\n\nimport { connect } from 'react-redux'\n\nimport SelectionInstrument from '../instruments/SelectionInstrument/SelectionInstrument'\nimport Pen from '../instruments/Pen/Pen'\nimport Fill from '../instruments/Fill/Fill'\nimport Dropper from '../instruments/Dropper/Dropper'\nimport Eraser from '../instruments/Eraser/Eraser'\n\nconst instruments = {\n  pen: Pen,\n  fill: Fill,\n  selection: SelectionInstrument,\n  dropper: Dropper,\n  eraser: Eraser\n}\n\nclass CanvasEditor extends PureComponent {\n  render () {\n    const Element = instruments[this.props.instrument]\n    return Element != null ? <Element /> : null\n  }\n}\n\nCanvasEditor.propTypes = {\n  instrument: PropTypes.string\n}\n\nconst mapStateToProps = state => ({\n  instrument: state.instruments.instrument\n})\n\nexport default connect(mapStateToProps)(CanvasEditor)\n","import React, { PureComponent, createRef } from 'react'\nimport PropTypes from 'prop-types'\n\nimport { connect } from 'react-redux'\n\nimport { changeImage } from '../App/actions'\nimport { disableSelection } from '../instruments/SelectionInstrument/actions'\n\nimport Resizer from '../Resizer/Resizer'\nimport CanvasEditor from '../CanvasEditor/CanvasEditor'\n\nimport './Canvas.css'\n\nclass Canvas extends PureComponent {\n  constructor (...args) {\n    super(...args)\n    this.canvas = createRef()\n  }\n  render () {\n    return (\n      <div className='canvas-wrapper'>\n        <canvas\n          ref={this.canvas}\n          className='canvas'\n          width={this.props.data ? this.props.data.width : 0}\n          height={this.props.data ? this.props.data.height : 0}\n        />\n        <div\n          className='canvas-upper-layer'\n          style={{\n            width: this.props.data ? this.props.data.width : 0,\n            height: this.props.data ? this.props.data.height : 0\n          }}\n        >\n          <Resizer\n            mode='canvas'\n            onResizeEnd={this.onResize}\n            onResizing={this.props.disableSelection}\n            width={this.props.data ? this.props.data.width : 0}\n            height={this.props.data ? this.props.data.height : 0}\n            top={0}\n            left={0}\n          />\n          <CanvasEditor />\n        </div>\n      </div>\n    )\n  }\n  updateCanvas = () => {\n    const canvas = this.canvas.current\n    if (canvas != null && this.props.data != null) {\n      ;[canvas.width, canvas.height] = [\n        this.props.data.width,\n        this.props.data.height \n      ]\n      const ctx = canvas.getContext('2d')\n      ctx.putImageData(this.props.data, 0, 0)\n    }\n  }\n  onResize = (top, left, toWidth, toHeight) => {\n    if (this.props.data.width !== toWidth || this.props.data.height !== toHeight) {\n      const newCanvas = document.createElement('canvas')\n      newCanvas.width = toWidth\n      newCanvas.height = toHeight\n      const newCtx = newCanvas.getContext('2d')\n      newCtx.fillStyle = `rgb(${this.props.secondaryColor.r},${this.props.secondaryColor.g},${this.props.secondaryColor.b})`\n      newCtx.fillRect(0, 0, toWidth, toHeight)\n      newCtx.putImageData(this.props.data, 0, 0)\n      this.props.changeImage(newCtx.getImageData(0, 0, toWidth, toHeight))\n    }\n  }\n  componentDidMount () {\n    this.updateCanvas()\n  }\n  componentDidUpdate () {\n    this.updateCanvas()\n  }\n}\n\nCanvas.propTypes = {\n  data: PropTypes.object\n}\n\nconst mapStateToProps = state => ({\n  data: state.image.data,\n  secondaryColor: state.colors.list[state.colors.secondary]\n})\n\nconst mapDispatchToProps = dispatch => ({\n  changeImage: data => dispatch(changeImage(data)),\n  disableSelection: () => dispatch(disableSelection())\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Canvas)\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport './NavBarItem.css'\n\nconst NavBarItem = props => (\n  <section className='navbar-item'>\n    {props.children}\n    <footer>\n      {props.footer}\n    </footer>\n  </section>\n)\n\nNavBarItem.propTypes = {\n  footer: PropTypes.string\n}\n\nexport default NavBarItem\n","import React, { Component } from 'react'\n\nimport './NavBar.css'\n\nimport NavBarItem from './NavBarItem'\n\nclass NavBar extends Component {\n  render () {\n    return (\n      <nav className='navbar'>\n        {this.props.children.map((c, i) => (\n          <NavBarItem footer={c.props.footer} key={`navbaritem${i}`}>\n            {c}\n          </NavBarItem>\n        ))}\n      </nav>\n    )\n  }\n}\n\nexport default NavBar\n","import React, { Component } from 'react'\n\nimport './Clipboard.css'\n\nclass Clipboard extends Component {\n  render () {\n    return (\n      <nav className='clipboard'>\n        <button disabled={false}>Вырезать</button>\n        <button disabled={false}>Копировать</button>\n        <button disabled={false}>Вставить</button>\n      </nav>\n    )\n  }\n}\n\nexport default Clipboard\n","import React, { Component } from 'react'\nimport './Image.css'\n\nimport { connect } from 'react-redux'\n\nimport classNames from 'classnames'\n\nimport { selectInstrument } from '../instruments/actions'\nimport { changeImage } from '../App/actions'\n\nclass Image extends Component {\n  render () {\n    return (\n      <nav className='image'>\n        <button\n          className={classNames('select', {\n            select_active: this.props.instrument === 'selection'\n          })}\n          onClick={this.handleClick}\n        >\n          <svg viewBox='0 0 15 10'>\n            <rect\n              width='15'\n              height='10'\n              style={{\n                fill: 'transparent',\n                strokeWidth: '1',\n                strokeDasharray: '1',\n                stroke: 'black'\n              }}\n            />\n          </svg>\n          <footer>Выделить</footer>\n        </button>\n        <div className='side-buttons'>\n          <button\n            onClick={this.handleClipClick}\n            disabled={!(this.props.selection && this.props.selection.coords)}\n          >\n            Обрезать\n          </button>\n          <button>Изменить размер</button>\n          <button>Повернуть</button>\n        </div>\n      </nav>\n    )\n  }\n  handleClick = () => {\n    this.props.selectInstrument('selection')\n  }\n  handleClipClick = () => {\n    if (!(this.props.selection && this.props.selection.coords)) {\n      return\n    }\n    const newCanvas = document.createElement('canvas')\n    const newCtx = newCanvas.getContext('2d')\n    ;({\n      width: newCanvas.width,\n      height: newCanvas.height\n    } = this.props.selection.coords)\n\n    newCtx.putImageData(this.props.image, 0, 0)\n    this.props.changeImage(\n      newCtx.getImageData(\n        this.props.selection.coords.left,\n        this.props.selection.coords.top,\n        this.props.selection.coords.width,\n        this.props.selection.coords.height\n      )\n    )\n    this.props.selectInstrument('selection')\n  }\n}\n\nconst mapStateToProps = state => ({\n  image: state.image.data,\n  instrument: state.instruments.instrument,\n  selection: state.instruments.selection\n})\nconst mapDispatchToProps = dispatch => ({\n  selectInstrument: instrument => dispatch(selectInstrument(instrument)),\n  changeImage: imageData => dispatch(changeImage(imageData))\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Image)\n","import React, { PureComponent } from 'react'\n\nimport { connect } from 'react-redux'\n\nimport { selectInstrument } from './actions'\n\nimport classNames from 'classnames'\nimport './Instruments.css'\n\nconst instruments = ['pen', 'fill', 'text', 'eraser', 'dropper', 'zoom']\n\nclass Instruments extends PureComponent {\n  render () {\n    return (\n      <div className='instruments'>\n        {instruments.map(i => (\n          <button\n            className={classNames(`instrument_${i}`, {\n              instrument_active: i === this.props.instrument\n            })}\n            key={`instrument_${i}`}\n            onClick={this.props.selectInstrument.bind(undefined, i)}\n          />\n        ))}\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = state => ({\n  instrument: state.instruments.instrument\n})\nconst mapDispatchToProps = dispatch => ({\n  selectInstrument: instrument => dispatch(selectInstrument(instrument))\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Instruments)\n","import React from 'react'\n\nimport './ColorPalette.css'\n\nconst ColorPalette = props => (\n  <div className='color-palette'>\n    {props.children}\n  </div>\n)\n\nexport default ColorPalette\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport './ColorSelection.css'\n\nimport classNames from 'classnames'\n\nconst ColorSelection = props => (\n  <div className={classNames('color-selection', {'color-selection_active': props.active})} onClick={props.onClick}>\n    <div\n      className='color-selection-color'\n      style={{\n        backgroundColor: `rgb(${props.color.r},${props.color.g},${props.color.b})`\n      }}\n    />\n    <h6 className='color-selection-header'>\n      {props.header}\n    </h6>\n  </div>\n)\n\nColorSelection.propTypes = {\n  active: PropTypes.bool.isRequired,\n  color: PropTypes.shape({\n    r: PropTypes.number.isRequired,\n    g: PropTypes.number.isRequired,\n    b: PropTypes.number.isRequired\n  }),\n  onClick: PropTypes.func,\n  header: PropTypes.string\n}\n\nexport default ColorSelection\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport './ColorInput.css'\n\nconst ColorInput = props => (\n  <div className='color-input'>\n    <label className='color-input-wrapper'>\n      <input type='color' onChange={props.onChange} value={props.value} />\n    </label>\n    <h6 className='color-input-header'>\n      Изменение цветов\n    </h6>\n  </div>\n)\n\nColorInput.propTypes = {\n  onChange: PropTypes.func.isRequired,\n  value: PropTypes.string.isRequired\n}\n\nexport default ColorInput\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport './Color.css'\n\nimport classNames from 'classnames'\n\nconst Color = props => {\n  return (\n    <div\n      onClick={props.onClick}\n      style={props.value && { backgroundColor: `rgb(${props.value.r}, ${props.value.g}, ${props.value.b})` }}\n      className={classNames('color', { color_active: props.active, color_undefined: !props.value })}\n    />\n  )\n}\n\nColor.propTypes = {\n  onClick: PropTypes.func,\n  value: PropTypes.shape({\n    r: PropTypes.number,\n    g: PropTypes.number,\n    b: PropTypes.number\n  }),\n  active: PropTypes.bool\n}\n\nexport default Color\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport './Colors.css'\n\nimport ColorPalette from '../ColorPalette/ColorPalette'\nimport ColorSelection from '../ColorSelection/ColorSelection'\nimport ColorInput from '../ColorInput/ColorInput'\nimport Color from '../Color/Color'\n\nimport { rgbToHex } from '../helpers'\n\nconst ColorsComponent = props => (\n  <div className='colors'>\n    <ColorSelection\n      header='Цвет 1'\n      color={props.colors[props.primary]}\n      active={props.activeColor === 'primary'}\n      onClick={() => props.onActiveColorClick('primary')}\n    />\n    <ColorSelection\n      header='Цвет 2'\n      color={props.colors[props.secondary]}\n      active={props.activeColor === 'secondary'}\n      onClick={() => props.onActiveColorClick('secondary')}\n    />\n    <ColorPalette>\n      {[\n        ...props.colors.map((c, i) => (\n          <Color\n            value={c}\n            active={i === props[props.activeColor]}\n            onClick={() => props.onColorClick(i)}\n            key={'color' + i}\n            colorId={i}\n          />\n        )),\n        ...new Array(30 - props.colors.length)\n          .fill(undefined)\n          .map((item, i) => (\n            <Color\n              value={null}\n              key={'undefinedcolor' + i}\n            />\n          ))\n      ]}\n    </ColorPalette>\n    <ColorInput\n      onChange={props.onColorInputChange}\n      value={rgbToHex(props.colors[props[props.activeColor]])}\n    />\n  </div>\n)\n\nColorsComponent.propTypes = {\n  colors: PropTypes.arrayOf(PropTypes.shape({\n    r: PropTypes.number.isRequired,\n    g: PropTypes.number.isRequired,\n    b: PropTypes.number.isRequired\n  })).isRequired,\n  activeColor: PropTypes.oneOf(['primary', 'secondary']).isRequired,\n  onColorClick: PropTypes.func.isRequired,\n  onActiveColorClick: PropTypes.func.isRequired,\n  onColorInputChange: PropTypes.func.isRequired\n}\n\nexport default ColorsComponent\n","import React, { PureComponent } from 'react'\n\nimport { connect } from 'react-redux'\n\nimport ColorsComponent from './ColorsComponent'\nimport { changeActiveColor, selectColor, addColorFromInput } from './actions'\n\nclass ColorsContainer extends PureComponent {\n  render () {\n    return <ColorsComponent {...this.props} />\n  }\n}\n\nconst mapStateToProps = state => ({\n  colors: state.colors.list,\n  activeColor: state.colors.activeColor,\n  primary: state.colors.primary,\n  secondary: state.colors.secondary\n})\nconst mapDispatchToProps = dispatch => ({\n  onColorClick: index => dispatch(selectColor(index)),\n  onActiveColorClick: activeColor => dispatch(changeActiveColor(activeColor)),\n  onColorInputChange: e => dispatch(addColorFromInput(e))\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ColorsContainer)\n","import { types } from './actions'\n\nconst colorsReducer = (\n  state = {\n    list: [\n      { r: 0, g: 0, b: 0 },\n      { r: 127, g: 127, b: 127 },\n      { r: 136, g: 0, b: 21 },\n      { r: 237, g: 28, b: 36 },\n      { r: 255, g: 127, b: 39 },\n      { r: 255, g: 242, b: 0 },\n      { r: 34, g: 177, b: 76 },\n      { r: 0, g: 162, b: 232 },\n      { r: 63, g: 72, b: 204 },\n      { r: 163, g: 73, b: 164 },\n      { r: 255, g: 255, b: 255 },\n      { r: 195, g: 195, b: 195 },\n      { r: 185, g: 122, b: 87 },\n      { r: 255, g: 174, b: 201 },\n      { r: 255, g: 201, b: 14 },\n      { r: 239, g: 228, b: 176 },\n      { r: 181, g: 230, b: 29 },\n      { r: 153, g: 217, b: 234 },\n      { r: 112, g: 176, b: 190 },\n      { r: 200, g: 191, b: 231 }\n    ],\n    activeColor: 'primary',\n    primary: 0,\n    secondary: 10\n  },\n  action\n) => {\n  const newState = { ...state }\n  switch (action.type) {\n    case types.SELECT_COLOR:\n      newState[newState.activeColor] = action.index\n      return newState\n    case types.ADD_COLOR:\n      if (newState.list.length !== 30) {\n        newState.list = [...newState.list, action.value]\n        newState[newState.activeColor] = state.list.length\n      } else {\n        newState.list = [\n          ...newState.list.slice(0, 20),\n          ...newState.list.slice(21),\n          action.value\n        ]\n        newState[newState.activeColor] = state.list.length - 1\n      }\n      return newState\n    case types.CHANGE_ACTIVE_COLOR:\n      newState.activeColor = action.activeColor\n      return newState\n    default:\n      return state\n  }\n}\n\nexport default colorsReducer\n","import { types } from './actions'\n\nconst instrumentsReducer = (state = { instrument: 'pen' }, action) => {\n  switch (action.type) {\n    case types.CHANGE_INSTRUMENT:\n      const {type, ...withoutType} = action\n      return {...state, ...withoutType}\n    default:\n      return state\n  }\n}\n\nexport default instrumentsReducer\n","import { combineReducers } from 'redux'\n\nimport { types } from './actions'\nimport colorsReducer from '../Colors/reducer'\nimport instrumentsReducer from '../instruments/reducer'\n\nconst canvasReducer = (\n  state,\n  action\n) => {\n  if (state === undefined) {\n    const canvasEl = document.createElement('canvas')\n    ;[canvasEl.width, canvasEl.height] = [800, 450]\n    const ctx = canvasEl.getContext('2d')\n    ctx.fillStyle = '#FFFFFF'\n    ctx.fillRect(0, 0, canvasEl.width, canvasEl.height)\n    return {\n      data: ctx.getImageData(0, 0, canvasEl.width, canvasEl.height),\n      name: 'Ваша пикча.png'\n    }\n  }\n  switch (action.type) {\n    case types.IMAGE_CHANGED:\n      return {\n        data: action.data,\n        name: action.name || state.name,\n      }\n    default:\n      return state\n  }\n}\n\nconst reducer = combineReducers({\n  image: canvasReducer,\n  colors: colorsReducer,\n  instruments: instrumentsReducer\n})\n\nexport default reducer\n","import React, { PureComponent } from 'react'\n\nimport './App.css'\n\nimport { connect } from 'react-redux'\n\nimport FileMenu from '../FileMenu/FileMenuContainer'\nimport Canvas from '../Canvas/Canvas'\nimport NavBar from '../NavBar/NavBar'\nimport Clipboard from '../Clipboard/Clipboard'\nimport Image from '../Image/Image'\nimport Instruments from '../instruments/Instruments'\nimport Colors from '../Colors/ColorsContainer'\n\nimport { openFile, createFile, paste, download } from './actions'\n\nclass App extends PureComponent {\n  render () {\n    return (\n      <React.Fragment>\n        <FileMenu\n          onDownload={() => download(this.props.downloadName)}\n          onFileCreate={this.props.onFileCreate}\n          onFileOpen={this.props.onFileOpen}\n        />\n        <NavBar>\n          <Clipboard\n            onPasteClick={this.props.onClipboardPasteClick}\n            disabled={this.props.clipboardDisabled}\n            footer='Буфер обмена'\n          />\n          <Image footer='Изображение' />\n          <Instruments footer='Инструменты' />\n          <Colors footer='Цвета' />\n        </NavBar>\n        <Canvas\n          onCanvasRef={this.handleCanvasRef}\n        />\n      </React.Fragment>\n    )\n  }\n  componentDidMount () {\n    document.addEventListener('paste', this.props.onPaste)\n  }\n  componentWillUnmount () {\n    document.removeEventListener('paste', this.props.onPaste)\n  }\n}\n\nconst mapStateToProps = state => ({\n  downloadName: state.image.name\n})\nconst mapDispatchToProps = dispatch => ({\n  onFileCreate: () => dispatch(createFile()),\n  onFileOpen: e => dispatch(openFile(e)),\n  onPaste: e => dispatch(paste(e))\n})\n\nexport { default as rootReducer } from './reducer'\nexport default connect(mapStateToProps, mapDispatchToProps)(App)\n","import React, { StrictMode } from 'react'\nimport { render } from 'react-dom'\nimport { Provider } from 'react-redux'\nimport { createStore, applyMiddleware, compose } from 'redux'\nimport thunk from 'redux-thunk'\n\nimport Paint, { rootReducer } from './components/App/App'\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nconst store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)))\n\nrender(\n  <StrictMode>\n    <Provider store={store}>\n      <Paint />\n    </Provider>\n  </StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}