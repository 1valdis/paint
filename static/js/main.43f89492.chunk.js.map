{"version":3,"sources":["components/helpers.js","components/Modal/Modal.js","components/FileMenu/about/About.js","components/FileMenu/FileMenuComponent.js","components/FileMenu/FileMenuContainer.js","components/instruments/actions.js","components/App/actions.js","components/ResizerPoint/ResizerPoint.js","components/Resizer/Resizer.js","components/MovableSelection/MovableSelection.js","components/instruments/SelectionInstrument/ZoneSelection/ZoneSelection.js","components/instruments/SelectionInstrument/ImageDataSelection/ImageDataSelection.js","components/instruments/SelectionInstrument/SelectionInstrument.js","components/instruments/SelectionInstrument/actions.js","components/instruments/Pen/Pen.js","components/instruments/Fill/Fill.js","components/Colors/actions.js","components/instruments/Dropper/Dropper.js","components/instruments/Eraser/Eraser.js","components/CanvasEditor/CanvasEditor.js","components/Canvas/Canvas.js","components/NavBar/NavBarItem.js","components/NavBar/NavBar.js","components/Clipboard/Clipboard.js","components/Image/Image.js","components/instruments/Instruments.js","components/ColorPalette/ColorPalette.js","components/ColorSelection/ColorSelection.js","components/ColorInput/ColorInput.js","components/Color/Color.js","components/Colors/ColorsComponent.js","components/Colors/ColorsContainer.js","components/Colors/reducer.js","components/instruments/reducer.js","components/App/reducer.js","components/App/App.js","index.js"],"names":["isVisible","elem","offsetWidth","offsetHeight","getClientRects","length","componentToHex","c","hex","toString","rgbToHex","_ref","r","g","b","bresenhamLine","x0","y0","x1","y1","callback","dx","Math","abs","dy","sx","sy","err","e2","getCanvasCoordsFromEvent","canvas","e","_canvas$getBoundingCl","getBoundingClientRect","top","left","_ref2","clientX","clientY","mouseX","mouseY","floor","root","document","getElementById","Modal","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","el","createElement","classList","add","createPortal","children","appendChild","removeChild","PureComponent","About","react_default","a","className","onClick","onClose","href","title","FileMenuComponent","_getPrototypeOf2","_len","arguments","args","Array","_key","apply","concat","menu","createRef","ref","classNames","file-menu_open","isOpen","onClickInside","onFileCreate","type","accept","onChange","onFileOpen","onDownload","onAboutOpen","isAboutOpen","components_Modal_Modal","FileMenu_about_About","onAboutClose","clickOutsideListener","element","outsideClickListener","event","contains","target","addEventListener","addClickOutsideListener","current","onClickOutside","listener","removeEventListener","FileMenuContainer","toggleMenu","setState","state","open","closeMenu","openAbout","aboutOpen","closeAbout","_this2","FileMenu_FileMenuComponent","assign","downloadName","types","CHANGE_INSTRUMENT","selectInstrument","instrument","IMAGE_CHANGED","ctx","getContext","alpha","createFile","dispatch","getState","width","height","fillStyle","fillRect","data","getImageData","name","imageChangedActionCreator","imageData","putImageData","ResizerPoint","handlePointerDown","button","resizerElement","resizing","onResizeStart","onResizeCancel","handlePointerUp","onResizeEnd","handlePointerMove","buttons","onResizeMove","preventContextMenu","handlePointerCancel","handleDragStart","preventDefault","handleContextMenu","style","objectSpread","outerStyle","innerStyle","passive","window","Component","directions","selection","Resizer","resizeTop","resizeLeft","resizeWidth","resizeHeight","resizeRect","resizer_resizing","resizer_hide-border","hideBorderOnResizing","mode","map","d","components_ResizerPoint_ResizerPoint","bind","key","direction","_this$resizeRect$curr","bottom","right","parentRect","parentNode","pageYOffset","pageXOffset","round","onResizing","nextProps","undefined","MovableSelection","currentTarget","moving","startX","startY","handleDocumentPointerMove","onMoving","_this$props","coords","onMoveEnd","objectWithoutProperties","handleDocumentPointerUp","_this$props2","_this$props3","withoutOnChange","onPointerDown","components_Resizer_Resizer","getDerivedStateFromProps","ZoneSelection","handleResizing","handleResizeEnd","backgroundColor","secondaryColor","newCtx","onCoordsChanged","onImageChanged","handleMoving","_ref3","handleMoveEnd","_ref4","redrawCanvas","updateOld","oldCtx","imageSmoothingEnabled","drawImage","originCoords","canvasRef","react","components_MovableSelection_MovableSelection","oldCanvas","prevProps","ImageDataSelection","updateOldCanvas","updateSelectionCanvas","selectionCtx","selectionCanvas","selectionImageData","updateNewCanvas","onSelectionChanged","resizeCanvasToFitPasted","max","resized","SelectionInstrument","trusted","changeSelection","_this$containerRef$cu","containerRef","ceil","selecting","selectingY","selectingX","selectingCoords","_this$containerRef$cu2","trunc","canvasRelativeTop","canvasRelativeLeft","_ref5","min","selectionOriginCoords","El","SelectionInstrument_ImageDataSelection_ImageDataSelection","selectionCoords","changeImage","SelectionInstrument_ZoneSelection_ZoneSelection","zone","connect","image","instruments","colors","list","secondary","Pen","isDrawing","beginDrawing","toConsumableArray","_this3","continueDrawing","handlePointerEnter","_this4","handlePointerLeave","_this5","endDrawing","_getCanvasCoordsFromE","_getCanvasCoordsFromE2","slicedToArray","prevX","prevY","cancelDrawing","handleDocumentContextMenu","handleDocumentSelectStart","x","y","_this$props$color","color","drawPoint","onPointerUp","onPointerMove","onPointerEnter","onPointerLeave","primary","Fill","handleMouseDown","floodFill","colorToReplace","colorToFillWith","replaceR","replaceG","replaceB","fillR","fillG","fillB","i","q","push","n","shift","onMouseDown","ADD_COLOR","SELECT_COLOR","CHANGE_ACTIVE_COLOR","selectColor","index","Dropper","handleClick","_e$target$getBounding","addColor","rgbObject","found","rgbObjectString","JSON","stringify","value","Eraser","updateCanvas","_getCanvasCoordsFromE3","_getCanvasCoordsFromE4","noCursorCtx","thickness","updateCanvasNoCursor","_this$props$color2","strokeRect","noCursorCanvas","_this$props$color3","strokeStyle","_this$props$color4","pen","fill","dropper","eraser","CanvasEditor","Element","Canvas","onResize","toWidth","toHeight","newCanvas","disableSelection","components_CanvasEditor_CanvasEditor","NavBarItem","footer","NavBar","components_NavBar_NavBarItem","Clipboard","disabled","Image","handleClipClick","_this$props$selection","select_active","viewBox","strokeWidth","strokeDasharray","stroke","Instruments","instrument_active","ColorPalette","ColorSelection","color-selection_active","active","header","ColorInput","Color","color_active","color_undefined","ColorsComponent","components_ColorSelection_ColorSelection","activeColor","onActiveColorClick","components_ColorPalette_ColorPalette","components_Color_Color","onColorClick","colorId","item","components_ColorInput_ColorInput","onColorInputChange","ColorsContainer","Colors_ColorsComponent","changeActiveColor","rgb","match","v","parseInt","addColorFromInput","colorsReducer","action","newState","slice","instrumentsReducer","withoutType","reducer","combineReducers","canvasEl","App","Fragment","FileMenu_FileMenuContainer","toBlob","blob","URL","revokeObjectURL","createObjectURL","download","body","click","components_NavBar_NavBar","components_Clipboard_Clipboard","onPasteClick","onClipboardPasteClick","clipboardDisabled","components_Image_Image","components_instruments_Instruments","Colors_ColorsContainer","components_Canvas_Canvas","onCanvasRef","handleCanvasRef","onPaste","file","nativeEvent","files","reader","FileReader","onload","img","src","result","readAsDataURL","openFile","clipboardData","items","indexOf","getAsFile","source","pastedImage","pastedImageCanvas","pastedImageCtx","instrumentsTypes","paste","store","createStore","rootReducer","applyMiddleware","thunk","render","es","components_App_App"],"mappings":"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","file":"static/js/main.43f89492.chunk.js","sourcesContent":["export function addClickOutsideListener (element, callback) {\r\n  const outsideClickListener = event => {\r\n    if (!element.contains(event.target)) {\r\n      if (isVisible(element)) {\r\n        callback()\r\n      }\r\n    }\r\n  }\r\n\r\n  document.addEventListener('click', outsideClickListener)\r\n  return outsideClickListener\r\n}\r\n\r\nexport function removeClickOutsideListener (listener) {\r\n  document.removeEventListener('click', listener)\r\n}\r\n\r\nconst isVisible = elem =>\r\n  !!elem &&\r\n  !!(elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length)\r\n\r\nfunction componentToHex (c) {\r\n  var hex = c.toString(16)\r\n  return hex.length === 1 ? '0' + hex : hex\r\n}\r\n\r\nexport function rgbToHex ({ r, g, b }) {\r\n  return '#' + componentToHex(r) + componentToHex(g) + componentToHex(b)\r\n}\r\n\r\nexport function bresenhamLine (x0, y0, x1, y1, callback) {\r\n  var dx = Math.abs(x1 - x0)\r\n  var dy = Math.abs(y1 - y0)\r\n  var sx = x0 < x1 ? 1 : -1\r\n  var sy = y0 < y1 ? 1 : -1\r\n  var err = dx - dy\r\n\r\n  while (true) {\r\n    callback(x0, y0)\r\n\r\n    if (x0 === x1 && y0 === y1) break\r\n    var e2 = 2 * err\r\n    if (e2 > -dy) {\r\n      err -= dy\r\n      x0 += sx\r\n    }\r\n    if (e2 < dx) {\r\n      err += dx\r\n      y0 += sy\r\n    }\r\n  }\r\n}\r\n\r\nexport function getCanvasCoordsFromEvent(canvas, e) {\r\n  let { top, left } = canvas.getBoundingClientRect()\r\n  const [mouseX, mouseY] = [e.clientX, e.clientY]\r\n  return [Math.floor(mouseX - left), Math.floor(mouseY - top)]\r\n}\r\n","import { PureComponent } from 'react'\r\nimport { createPortal } from 'react-dom'\r\n\r\nimport './Modal.css'\r\n\r\nconst root = document.getElementById('modal-root')\r\n\r\nclass Modal extends PureComponent {\r\n  constructor (props) {\r\n    super(props)\r\n    this.el = document.createElement('div')\r\n    this.el.classList.add('modal')\r\n  }\r\n  render () {\r\n    return createPortal(this.props.children, this.el)\r\n  }\r\n  componentDidMount () {\r\n    root.appendChild(this.el)\r\n  }\r\n  componentWillUnmount () {\r\n    root.removeChild(this.el)\r\n  }\r\n}\r\n\r\nexport default Modal\r\n","import React from 'react'\r\n\r\nimport './About.css'\r\n\r\nconst About = props => (\r\n  <div className='about'>\r\n    <button className='about-close-button' onClick={props.onClose} />\r\n    <p>Вы серьёзно ожидали здесь увидеть что-то нормальное? :D</p>\r\n    <p>\r\n      Ну ладно, вот немного языка legalese, поскольку авторов иконок надо указать в эбауте прожки)))\r\n    </p>\r\n    <div>Icons made by <a href='https://www.flaticon.com/authors/good-ware' title='Good Ware'>Good Ware</a>, <a href='https://www.flaticon.com/authors/smashicons' title='Smashicons'>Smashicons</a>, <a href='https://www.flaticon.com/authors/pixel-buddha' title='Pixel Buddha'>Pixel Buddha</a>, <a href='http://www.freepik.com' title='Freepik'>Freepik</a>, <a href='https://www.flaticon.com/authors/dimitry-miroliubov' title='Dimitry Miroliubov'>Dimitry Miroliubov</a> from <a href='https://www.flaticon.com/' title='Flaticon'>www.flaticon.com</a> is licensed by <a href='http://creativecommons.org/licenses/by/3.0/' title='Creative Commons BY 3.0'>CC 3.0 BY</a></div>\r\n  </div>\r\n)\r\n\r\nexport default About\r\n","import React, { PureComponent, createRef } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport './FileMenu.css'\r\n\r\nimport classNames from 'classnames'\r\n\r\nimport { addClickOutsideListener, removeClickOutsideListener } from '../helpers'\r\n\r\nimport Modal from '../Modal/Modal'\r\nimport About from './about/About'\r\n\r\nclass FileMenuComponent extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.menu = createRef()\r\n  }\r\n  render () {\r\n    return (\r\n      <div\r\n        ref={this.menu}\r\n        className={classNames('file-menu', {\r\n          'file-menu_open': this.props.isOpen\r\n        })}\r\n      >\r\n        <button className='file-menu-button' onClick={this.props.onClick}>\r\n          Файл\r\n        </button>\r\n        <nav className='file-menu-items' onClick={this.props.onClickInside}>\r\n          <button className='file-menu-item' onClick={this.props.onFileCreate}>\r\n            Создать\r\n          </button>\r\n          <label className='file-menu-item'>\r\n            Открыть\r\n            <input\r\n              type='file'\r\n              className='file-menu-item'\r\n              accept='image/*'\r\n              onChange={this.props.onFileOpen}\r\n            />\r\n          </label>\r\n          <button\r\n            className='file-menu-item'\r\n            onClick={this.props.onDownload}\r\n          >\r\n            Сохранить\r\n          </button>\r\n          <button className='file-menu-item' onClick={this.props.onAboutOpen}>\r\n            О программе\r\n          </button>\r\n        </nav>\r\n        {this.props.isAboutOpen && <Modal><About onClose={this.props.onAboutClose} /></Modal>}\r\n      </div>\r\n    )\r\n  }\r\n  componentDidMount () {\r\n    this.clickOutsideListener = addClickOutsideListener(\r\n      this.menu.current,\r\n      this.props.onClickOutside\r\n    )\r\n  }\r\n  componentWillUnmount () {\r\n    removeClickOutsideListener(this.clickOutsideListener)\r\n  }\r\n}\r\n\r\nFileMenuComponent.propTypes = {\r\n  isOpen: PropTypes.bool.isRequired,\r\n  onClick: PropTypes.func.isRequired,\r\n  onClickInside: PropTypes.func.isRequired,\r\n  onClickOutside: PropTypes.func.isRequired,\r\n  onDownload: PropTypes.func,\r\n  onFileCreate: PropTypes.func.isRequired,\r\n  onFileOpen: PropTypes.func.isRequired,\r\n  isAboutOpen: PropTypes.bool,\r\n  onAboutOpen: PropTypes.func,\r\n  onAboutClose: PropTypes.func\r\n}\r\n\r\nexport default FileMenuComponent\r\n","import React, { PureComponent } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport FileMenuComponent from './FileMenuComponent'\r\n\r\nclass FileMenuContainer extends PureComponent {\r\n  constructor () {\r\n    super()\r\n    this.state = { open: false, aboutOpen: false }\r\n  }\r\n  render () {\r\n    return (\r\n      <FileMenuComponent\r\n        isOpen={this.state.open}\r\n        onClick={this.toggleMenu}\r\n        onClickOutside={this.closeMenu}\r\n        onClickInside={this.closeMenu}\r\n        isAboutOpen={this.state.aboutOpen}\r\n        onAboutOpen={this.openAbout}\r\n        onAboutClose={this.closeAbout}\r\n        {...this.props}\r\n        onDownload={()=>this.props.onDownload(this.props.downloadName)}\r\n      />\r\n    )\r\n  }\r\n  toggleMenu = () => this.setState(state => ({ open: !state.open }))\r\n  closeMenu = () => this.setState({ open: false })\r\n  openAbout = () => this.setState({aboutOpen: true})\r\n  closeAbout = () => this.setState({aboutOpen: false})\r\n}\r\n\r\nFileMenuContainer.propTypes = {\r\n  onDownload: PropTypes.func.isRequired,\r\n  downloadName: PropTypes.string,\r\n  onFileCreate: PropTypes.func,\r\n  onFileOpen: PropTypes.func\r\n}\r\n\r\nexport default FileMenuContainer\r\n","export const types = {\r\n  CHANGE_INSTRUMENT: 'instruments/change'\r\n}\r\n\r\nexport function selectInstrument (instrument) {\r\n  return {\r\n    type: types.CHANGE_INSTRUMENT,\r\n    instrument\r\n  }\r\n}\r\n","import { types as instrumentsTypes } from '../instruments/actions'\r\n\r\nexport const types = {\r\n  IMAGE_CHANGED: 'app/image-changed'\r\n}\r\n\r\nconst canvas = document.createElement('canvas')\r\nconst ctx = canvas.getContext('2d', { alpha: false })\r\nlet href = null\r\n\r\nexport function createFile () {\r\n  return function (dispatch, getState) {\r\n    ;[canvas.width, canvas.height] = [800, 450]\r\n    clearCanvas()\r\n    dispatch({\r\n      type: types.IMAGE_CHANGED,\r\n      data: ctx.getImageData(0, 0, canvas.width, canvas.height),\r\n      name: 'Ваша пикча.png'\r\n    })\r\n  }\r\n}\r\n\r\nexport function openFile (e) {\r\n  return function (dispatch, getState) {\r\n    const file = e.nativeEvent.target.files[0]\r\n    if (file == null) return\r\n    const reader = new FileReader()\r\n    reader.onload = e => {\r\n      const img = new Image()\r\n      img.onload = () => {\r\n        canvas.width = img.width\r\n        canvas.height = img.height\r\n        ctx.drawImage(img, 0, 0)\r\n        dispatch({\r\n          type: types.IMAGE_CHANGED,\r\n          data: ctx.getImageData(0, 0, img.width, img.height),\r\n          name: file.name\r\n        })\r\n      }\r\n      img.src = e.target.result\r\n    }\r\n    reader.readAsDataURL(file)\r\n  }\r\n}\r\n\r\nexport function paste (e) {\r\n  return function (dispatch, getState) {\r\n    if (e.clipboardData) {\r\n      const items = e.clipboardData.items\r\n      if (!items) return\r\n\r\n      for (let i = 0; i < items.length; i++) {\r\n        if (items[i].type.indexOf('image') !== -1) {\r\n          const blob = items[i].getAsFile()\r\n          const source = window.URL.createObjectURL(blob)\r\n          const pastedImage = new Image()\r\n          pastedImage.onload = () => {  \r\n            const pastedImageCanvas = document.createElement('canvas')\r\n            pastedImageCanvas.width = pastedImage.width\r\n            pastedImageCanvas.height = pastedImage.height\r\n            const pastedImageCtx = pastedImageCanvas.getContext('2d')\r\n            pastedImageCtx.drawImage(pastedImage, 0, 0)\r\n            \r\n            dispatch({\r\n              type: instrumentsTypes.CHANGE_INSTRUMENT,\r\n              instrument: 'selection',\r\n              selection: {\r\n                imageData: pastedImageCtx.getImageData(0, 0, pastedImageCanvas.width, pastedImageCanvas.height),\r\n                coords: {\r\n                  top: 0,\r\n                  left: 0,\r\n                  width: pastedImage.width,\r\n                  height: pastedImage.height\r\n                }\r\n              }\r\n            })\r\n          }\r\n          pastedImage.src = source\r\n          break\r\n        }\r\n      }\r\n      e.preventDefault()\r\n    }\r\n  }\r\n}\r\n\r\nfunction imageChangedActionCreator (imageData) {\r\n  return function (dispatch, getState) {\r\n    canvas.width = imageData.width\r\n    canvas.height = imageData.height\r\n    ctx.putImageData(imageData, 0, 0)\r\n    dispatch({\r\n      type: types.IMAGE_CHANGED,\r\n      data: imageData\r\n    })\r\n  }\r\n}\r\n\r\nexport { imageChangedActionCreator as changeImage }\r\n\r\nfunction clearCanvas () {\r\n  ctx.fillStyle = '#FFFFFF'\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height)\r\n}\r\n\r\nexport function download (name) {\r\n  canvas.toBlob(blob => {\r\n    if (href !== null) {\r\n      window.URL.revokeObjectURL(href)\r\n    }\r\n    href = window.URL.createObjectURL(blob)\r\n    const a = document.createElement('a')\r\n    a.download = name\r\n    a.href = href\r\n    document.body.appendChild(a)\r\n    a.click()\r\n    document.body.removeChild(a)\r\n  })\r\n}\r\n","import React, { Component, createRef } from 'react'\r\nimport './ResizerPoint.css'\r\n\r\nclass ResizerPoint extends Component {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.resizing = false\r\n    this.preventContextMenu = false\r\n    this.resizerElement = createRef()\r\n  }\r\n  render () {\r\n    return (\r\n      <div\r\n        className={'resizer-outer ' + (this.props.className || '')}\r\n        style={{ ...this.props.outerStyle }}\r\n        ref={this.resizerElement}\r\n      >\r\n        <div className='resizer-inner' style={{ ...this.props.innerStyle }} />\r\n      </div>\r\n    )\r\n  }\r\n  componentDidMount () {\r\n    document.addEventListener('pointerdown', this.handlePointerDown, {passive: true})\r\n    document.addEventListener('pointermove', this.handlePointerMove, {passive: true})\r\n    document.addEventListener('pointerup', this.handlePointerUp, {passive: true})\r\n    document.addEventListener('pointercancel', this.handlePointerCancel, {passive: true})\r\n    window.addEventListener('blur', this.handlePointerCancel, {passive: true})\r\n    document.addEventListener('contextmenu', this.handleContextMenu)\r\n    document.addEventListener('dragstart', this.handleDragStart)\r\n  }\r\n  componentWillUnmount () {\r\n    document.removeEventListener('pointerdown', this.handlePointerDown, {passive: true})\r\n    document.removeEventListener('pointermove', this.handlePointerMove, {passive: true})\r\n    document.removeEventListener('pointerup', this.handlePointerUp, {passive: true})\r\n    document.removeEventListener('pointercancel', this.handlePointerCancel, {passive: true})\r\n    window.removeEventListener('blur', this.handlePointerCancel, {passive: true})\r\n    document.removeEventListener('contextmenu', this.handleContextMenu)\r\n    document.removeEventListener('dragstart', this.handleDragStart)\r\n  }\r\n  handlePointerDown = e => {\r\n    switch (e.button) {\r\n      case 0:\r\n        if (this.resizerElement.current.contains(e.target)) {\r\n          this.resizing = true\r\n          this.props.onResizeStart(e)\r\n        }\r\n        return\r\n      case 2:\r\n        this.resizing = false\r\n        this.props.onResizeCancel(e)\r\n        break\r\n      default:\r\n        break\r\n    }\r\n  }\r\n  handlePointerUp = e => {\r\n    if (this.resizing) {\r\n      this.props.onResizeEnd(e)\r\n      this.resizing = false\r\n    }\r\n  }\r\n  handlePointerMove = e => {\r\n    if (this.resizing) {\r\n      switch (e.buttons) {\r\n        case 1:\r\n          this.props.onResizeMove(e)\r\n          break\r\n        case 2:\r\n        case 3:\r\n          this.resizing = false\r\n          this.props.onResizeCancel(e)\r\n          this.preventContextMenu = true\r\n          break\r\n        default:\r\n          break\r\n      }\r\n    }\r\n  }\r\n  handlePointerCancel = e => {\r\n    if (this.resizing) {\r\n      this.resizing = false\r\n      this.props.onResizeCancel(e)\r\n    }\r\n  }\r\n  handleDragStart = e => {\r\n    e.preventDefault()\r\n  }\r\n  handleContextMenu = e => {\r\n    if (this.preventContextMenu) {\r\n      e.preventDefault()\r\n      this.preventContextMenu = false\r\n    }\r\n  }\r\n}\r\n\r\nexport default ResizerPoint\r\n","import React, { PureComponent, createRef } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport './Resizer.css'\r\n\r\nimport classNames from 'classnames'\r\n\r\nimport ResizerPoint from '../ResizerPoint/ResizerPoint'\r\n\r\nconst directions = {\r\n  canvas: ['e', 'se', 's'],\r\n  selection: ['n', 'ne', 'e', 'se', 's', 'sw', 'w', 'nw']\r\n}\r\n\r\nclass Resizer extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.state = {\r\n      resizing: false,\r\n      resizeTop: this.props.top,\r\n      resizeLeft: this.props.left,\r\n      resizeWidth: this.props.width,\r\n      resizeHeight: this.props.height\r\n    }\r\n    this.resizeRect = createRef()\r\n  }\r\n  render () {\r\n    return (\r\n      <div\r\n        className={classNames('resizer', {\r\n          resizer_resizing: this.state.resizing,\r\n          'resizer_hide-border': this.props.hideBorderOnResizing\r\n        })}\r\n        ref={this.resizeRect}\r\n        style={{\r\n          width: `${this.state.resizing ? this.state.resizeWidth : this.props.width}px`,\r\n          height: `${this.state.resizing ? this.state.resizeHeight : this.props.height}px`,\r\n          top: `${this.state.resizing ? this.state.resizeTop : this.props.top}px`,\r\n          left: `${this.state.resizing ? this.state.resizeLeft : this.props.left}px`\r\n        }}\r\n      >\r\n        {directions[this.props.mode].map(d => (\r\n          <ResizerPoint\r\n            onResizeStart={this.onResizeStart.bind(this, d)}\r\n            onResizeMove={this.onResizeMove.bind(this, d)}\r\n            onResizeEnd={this.onResizeEnd.bind(this, d)}\r\n            onResizeCancel={this.onResizeCancel.bind(this, d)}\r\n            key={`${d}-resizer-point`}\r\n            className={d}\r\n          />\r\n        ))}\r\n      </div>\r\n    )\r\n  }\r\n  onResizeStart (direction, e) {}\r\n  onResizeMove (direction, e) {\r\n    let {\r\n      top,\r\n      left,\r\n      bottom,\r\n      right\r\n    } = this.resizeRect.current.getBoundingClientRect()\r\n    const parentRect = this.resizeRect.current.parentNode.getBoundingClientRect()\r\n    ;[top, left, bottom, right] = [\r\n      top + window.pageYOffset,\r\n      left + window.pageXOffset,\r\n      bottom + window.pageYOffset,\r\n      right + window.pageXOffset\r\n    ]\r\n    const [mouseX, mouseY] = [\r\n      e.clientX + window.pageXOffset,\r\n      e.clientY + window.pageYOffset\r\n    ]\r\n\r\n    const state = {\r\n      resizing: true,\r\n      resizeTop: this.props.top,\r\n      resizeLeft: this.props.left,\r\n      resizeWidth: this.props.width,\r\n      resizeHeight: this.props.height\r\n    }\r\n\r\n    switch (direction) {\r\n      case 'n':\r\n        state.resizeTop = mouseY - parentRect.top\r\n        state.resizeHeight = this.props.height - state.resizeTop\r\n        break\r\n      case 'ne':\r\n        state.resizeTop = mouseY - parentRect.top\r\n        state.resizeHeight = this.props.height - state.resizeTop\r\n        state.resizeWidth = mouseX - left\r\n        break\r\n      case 'e':\r\n        state.resizeWidth = mouseX - left\r\n        break\r\n      case 'se':\r\n        state.resizeHeight = mouseY - top\r\n        state.resizeWidth = mouseX - left\r\n        break\r\n      case 's':\r\n        state.resizeHeight = mouseY - top\r\n        break\r\n      case 'sw':\r\n        state.resizeHeight = mouseY - top\r\n        state.resizeLeft = mouseX - parentRect.left\r\n        state.resizeWidth = this.props.width - state.resizeLeft\r\n        break\r\n      case 'w':\r\n        state.resizeLeft = mouseX - parentRect.left\r\n        state.resizeWidth = this.props.width - state.resizeLeft\r\n        break\r\n      case 'nw':\r\n        state.resizeTop = mouseY - parentRect.top\r\n        state.resizeHeight = this.props.height - state.resizeTop\r\n        state.resizeLeft = mouseX - parentRect.left\r\n        state.resizeWidth = this.props.width - state.resizeLeft\r\n        break // no default\r\n    }\r\n\r\n    state.resizeTop = Math.round(\r\n      state.resizeTop + window.pageYOffset >\r\n        this.props.top + this.props.height - 1\r\n        ? this.props.height + this.props.top - 1\r\n        : state.resizeTop\r\n    )\r\n    state.resizeLeft = Math.round(\r\n      state.resizeLeft + window.pageXOffset >\r\n        this.props.left + this.props.width - 1\r\n        ? this.props.width + this.props.left - 1\r\n        : state.resizeLeft\r\n    )\r\n    state.resizeWidth = Math.round(\r\n      state.resizeWidth > 0 ? state.resizeWidth : 1\r\n    )\r\n    state.resizeHeight = Math.round(\r\n      state.resizeHeight > 0 ? state.resizeHeight : 1\r\n    )\r\n    if (this.props.onResizing) {\r\n      this.props.onResizing(\r\n        state.resizeTop,\r\n        state.resizeLeft,\r\n        state.resizeWidth,\r\n        state.resizeHeight\r\n      )\r\n    }\r\n    this.setState(state)\r\n  }\r\n  onResizeEnd (direction, e) {\r\n    if (this.props.onResizeEnd) {\r\n      this.props.onResizeEnd(\r\n        this.state.resizeTop,\r\n        this.state.resizeLeft,\r\n        this.state.resizeWidth,\r\n        this.state.resizeHeight\r\n      )\r\n    }\r\n    this.setState({ resizing: false })\r\n  }\r\n  onResizeCancel (direction, e) {\r\n    this.setState({\r\n      resizing: false,\r\n      resizeWidth: this.props.width,\r\n      resizeHeight: this.props.height\r\n    })\r\n  }\r\n  static getDerivedStateFromProps (nextProps, prevState = { resizing: false }) {\r\n    return prevState.resizing\r\n      ? null\r\n      : {\r\n        resizeTop: nextProps.top,\r\n        resizeLeft: nextProps.left,\r\n        resizeWidth: nextProps.width,\r\n        resizeHeight: nextProps.height\r\n      }\r\n  }\r\n}\r\n\r\nResizer.propTypes = {\r\n  mode: PropTypes.oneOf(['canvas', 'selection']),\r\n  width: PropTypes.number.isRequired,\r\n  height: PropTypes.number.isRequired,\r\n  onResizeEnd: PropTypes.func,\r\n  onResizing: PropTypes.func\r\n}\r\n\r\nexport default Resizer\r\n","import React, { PureComponent } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport './MovableSelection.css'\r\n\r\nimport Resizer from '../Resizer/Resizer'\r\n\r\nclass MovableSelection extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.state = {\r\n      moving: false,\r\n      startX: null,\r\n      startY: null,\r\n      top: this.props.top,\r\n      left: this.props.left\r\n    }\r\n  }\r\n  render () {\r\n    const {\r\n      onResizeEnd,\r\n      onResizing,\r\n      onMoveEnd,\r\n      onMoving,\r\n      ...withoutOnChange\r\n    } = this.props\r\n    if (this.props.onResizing) {\r\n      withoutOnChange.onResizing = this.onResizing\r\n    }\r\n    if (this.props.onResizeEnd) {\r\n      withoutOnChange.onResizeEnd = this.onResizeEnd\r\n    }\r\n    return (\r\n      <div\r\n        style={this.props}\r\n        onPointerDown={this.handlePointerDown}\r\n        className='movable-selection'\r\n      >\r\n        <Resizer mode='selection' {...withoutOnChange} top={0} left={0} />\r\n      </div>\r\n    )\r\n  }\r\n  onResizeEnd = (top, left, width, height) => {\r\n    this.props.onResizeEnd({\r\n      top: this.props.top + top,\r\n      left: this.props.left + left,\r\n      width,\r\n      height\r\n    })\r\n  }\r\n  onResizing = (top, left, width, height) => {\r\n    this.props.onResizing({\r\n      top: this.props.top + top,\r\n      left: this.props.left + left,\r\n      width,\r\n      height\r\n    })\r\n  }\r\n  handlePointerDown = e => {\r\n    if (e.target === e.currentTarget) {\r\n      this.setState({\r\n        moving: true,\r\n        startX: e.clientX + window.pageXOffset,\r\n        startY: e.clientY + window.pageYOffset\r\n      })\r\n    }\r\n  }\r\n  handleDocumentPointerMove = e => {\r\n    if (\r\n      this.state.moving &&\r\n      this.state.startX !== null &&\r\n      this.props.onMoving\r\n    ) {\r\n      switch (e.buttons) {\r\n        case 1:\r\n          const {\r\n            onResizeEnd,\r\n            onResizing,\r\n            onMoveEnd,\r\n            onMoving,\r\n            ...coords\r\n          } = this.props\r\n          coords.top =\r\n            this.state.top +\r\n            (e.clientY + window.pageYOffset - this.state.startY)\r\n          coords.left =\r\n            this.state.left +\r\n            (e.clientX + window.pageXOffset - this.state.startX)\r\n          this.props.onMoving(coords)\r\n          break\r\n        case 2:\r\n        case 3:\r\n          this.props.onMoving({\r\n            top: this.state.top,\r\n            left: this.state.left,\r\n            width: this.props.width,\r\n            height: this.props.height,\r\n          })\r\n          this.setState({\r\n            moving: false\r\n          })\r\n          this.preventContextMenu = true\r\n          break // no default\r\n      }\r\n    }\r\n  }\r\n  handleDocumentPointerUp = e => {\r\n    if (\r\n      this.state.moving &&\r\n      this.state.startX !== null &&\r\n      this.props.onMoving\r\n    ) {\r\n      const {\r\n        onResizeEnd,\r\n        onResizing,\r\n        onMoveEnd,\r\n        onMoving,\r\n        ...coords\r\n      } = this.props\r\n      coords.top =\r\n        this.state.top + (e.clientY + window.pageYOffset - this.state.startY)\r\n      coords.left =\r\n        this.state.left + (e.clientX + window.pageXOffset - this.state.startX)\r\n      this.props.onMoveEnd(coords)\r\n    }\r\n    this.setState({\r\n      moving: false,\r\n      startX: null,\r\n      startY: null\r\n    })\r\n  }\r\n  static getDerivedStateFromProps = (props, state) => {\r\n    if (!state.moving) {\r\n      return {\r\n        top: props.top,\r\n        left: props.left\r\n      }\r\n    }\r\n    return null\r\n  }\r\n  componentDidMount () {\r\n    document.addEventListener('pointermove', this.handleDocumentPointerMove, {passive: true})\r\n    document.addEventListener('pointerup', this.handleDocumentPointerUp, {passive: true})\r\n    document.addEventListener('contextmenu', this.handleContextMenu)\r\n  }\r\n  componentWillUnmount () {\r\n    document.removeEventListener('pointermove', this.handleDocumentPointerUp, {passive: true})\r\n    document.removeEventListener('pointerup', this.handleDocumentPointerUp, {passive: true})\r\n    document.removeEventListener('contextmenu', this.handleContextMenu)\r\n  }\r\n  \r\n  handleContextMenu = e => {\r\n    if (this.preventContextMenu) {\r\n      e.preventDefault()\r\n      this.preventContextMenu = false\r\n    }\r\n  }\r\n}\r\n\r\nMovableSelection.propTypes = {\r\n  top: PropTypes.number.isRequired,\r\n  left: PropTypes.number.isRequired,\r\n  width: PropTypes.number.isRequired,\r\n  height: PropTypes.number.isRequired,\r\n  hideBorderOnResizing: PropTypes.bool,\r\n  onResizeEnd: PropTypes.func,\r\n  onResizing: PropTypes.func,\r\n  onMoveEnd: PropTypes.func,\r\n  onMoving: PropTypes.func\r\n}\r\n\r\nexport default MovableSelection\r\n","import React, { PureComponent, Fragment, createRef } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport MovableSelection from '../../../MovableSelection/MovableSelection'\r\n\r\nclass ZoneSelection extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.canvasRef = createRef()\r\n\r\n    this.state = {\r\n      originCoords: this.props.coords\r\n    }\r\n  }\r\n  render () {\r\n    return (\r\n      <Fragment>\r\n        <canvas\r\n          ref={this.canvasRef}\r\n          onPointerDown={e =>\r\n            e.target === e.currentTarget && this.props.onClickOutside(e)}\r\n        />\r\n        <MovableSelection\r\n          {...this.props.coords}\r\n          onResizing={this.handleResizing}\r\n          onResizeEnd={this.handleResizeEnd}\r\n          onMoving={this.handleMoving}\r\n          onMoveEnd={this.handleMoveEnd}\r\n          hideBorderOnResizing={false}\r\n        />\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  componentDidMount () {\r\n    const oldCanvas = document.createElement('canvas')\r\n    oldCanvas.width = this.props.imageData.width\r\n    oldCanvas.height = this.props.imageData.height\r\n    this.oldCtx = oldCanvas.getContext('2d')\r\n    this.oldCtx.putImageData(this.props.imageData, 0, 0)\r\n\r\n    this.canvasRef.current.width = this.props.imageData.width\r\n    this.canvasRef.current.height = this.props.imageData.height\r\n    this.newCtx = this.canvasRef.current.getContext('2d')\r\n    this.newCtx.imageSmoothingEnabled = false\r\n  }\r\n\r\n  handleResizing = ({ top, left, width, height }) => {}\r\n  handleResizeEnd = ({ top, left, width, height }) => {\r\n    if (!this.backgroundColor) {\r\n      this.backgroundColor = this.props.secondaryColor\r\n      this.newCtx.fillStyle = `rgb(${this.backgroundColor.r}, ${this.backgroundColor.g}, ${this.backgroundColor.b})`\r\n    }\r\n    this.props.onCoordsChanged({ top, left, width, height })\r\n    this.props.onImageChanged(\r\n      this.newCtx.getImageData(\r\n        0,\r\n        0,\r\n        this.newCtx.canvas.width,\r\n        this.newCtx.canvas.height\r\n      )\r\n    )\r\n  }\r\n  handleMoving = ({ top, left, width, height }) => {\r\n    if (!this.backgroundColor) {\r\n      this.backgroundColor = this.props.secondaryColor\r\n      this.newCtx.fillStyle = `rgb(${this.backgroundColor.r}, ${this.backgroundColor.g}, ${this.backgroundColor.b})`\r\n    }\r\n    this.props.onCoordsChanged({ top, left, width, height })\r\n  }\r\n  handleMoveEnd = ({ top, left, width, height }) => {\r\n    this.props.onImageChanged(\r\n      this.newCtx.getImageData(\r\n        0,\r\n        0,\r\n        this.newCtx.canvas.width,\r\n        this.newCtx.canvas.height\r\n      )\r\n    )\r\n  }\r\n\r\n  redrawCanvas = updateOld => {\r\n    if (updateOld) {\r\n      this.oldCtx.canvas.width = this.props.imageData.width\r\n      this.oldCtx.canvas.height = this.props.imageData.height\r\n      this.newCtx.canvas.width = this.props.imageData.width\r\n      this.newCtx.canvas.height = this.props.imageData.height\r\n      this.newCtx.imageSmoothingEnabled = false\r\n      this.oldCtx.putImageData(this.props.imageData, 0, 0)\r\n    }\r\n\r\n    this.newCtx.drawImage(this.oldCtx.canvas, 0, 0)\r\n\r\n    if (this.props.coords && this.state.originCoords) {\r\n      this.newCtx.fillRect(\r\n        this.state.originCoords.left,\r\n        this.state.originCoords.top,\r\n        this.state.originCoords.width,\r\n        this.state.originCoords.height\r\n      )\r\n      this.newCtx.drawImage(\r\n        this.oldCtx.canvas,\r\n        this.state.originCoords.left,\r\n        this.state.originCoords.top,\r\n        this.state.originCoords.width,\r\n        this.state.originCoords.height,\r\n        this.props.coords.left,\r\n        this.props.coords.top,\r\n        this.props.coords.width,\r\n        this.props.coords.height\r\n      )\r\n    }\r\n  }\r\n\r\n  componentDidUpdate (prevProps) {\r\n    this.redrawCanvas(false)\r\n  }\r\n}\r\n\r\nZoneSelection.propTypes = {\r\n  coords: PropTypes.shape({\r\n    top: PropTypes.number.isRequired,\r\n    left: PropTypes.number.isRequired,\r\n    width: PropTypes.number.isRequired,\r\n    height: PropTypes.number.isRequired\r\n  }).isRequired,\r\n  backgroundColor: PropTypes.shape({\r\n    r: PropTypes.number.isRequired,\r\n    g: PropTypes.number.isRequired,\r\n    b: PropTypes.number.isRequired\r\n  }),\r\n  imageData: PropTypes.instanceOf(ImageData).isRequired,\r\n  onCoordsChanged: PropTypes.func.isRequired,\r\n  onImageChanged: PropTypes.func.isRequired,\r\n  onClickOutside: PropTypes.func.isRequired\r\n}\r\n\r\nexport default ZoneSelection\r\n","import React, { PureComponent, Fragment, createRef } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport MovableSelection from '../../../MovableSelection/MovableSelection'\r\n\r\nclass ImageDataSelection extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n\r\n    this.canvasRef = createRef()\r\n\r\n    if (\r\n      this.props.imageData.width < this.props.selectionImageData.width ||\r\n      this.props.imageData.height < this.props.selectionImageData.height\r\n    ) {\r\n      this.resized = true\r\n      this.resizeCanvasToFitPasted()\r\n      this.props.onSelectionChanged({\r\n        coords: this.props.coords,\r\n        imageData: this.props.selectionImageData\r\n      })\r\n      this.updateOld = true\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <Fragment>\r\n        <canvas\r\n          ref={this.canvasRef}\r\n          onPointerDown={e =>\r\n            e.target === e.currentTarget && this.props.onClickOutside(e)}\r\n        />\r\n        <MovableSelection\r\n          {...this.props.coords}\r\n          onResizing={this.handleResizing}\r\n          onResizeEnd={this.handleResizeEnd}\r\n          onMoving={this.handleMoving}\r\n          onMoveEnd={this.handleMoveEnd}\r\n          hideBorderOnResizing={false}\r\n        />\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  componentDidMount () {\r\n    this.updateOldCanvas()\r\n    this.updateSelectionCanvas()\r\n    this.updateNewCanvas()\r\n    this.props.onImageChanged(\r\n      this.newCtx.getImageData(\r\n        0,\r\n        0,\r\n        this.newCtx.canvas.width,\r\n        this.newCtx.canvas.height\r\n      )\r\n    )\r\n  }\r\n\r\n  componentDidUpdate (prevProps) {\r\n    if (this.updateOld) {\r\n      this.updateOldCanvas()\r\n    }\r\n    if (this.props.selectionImageData !== prevProps.selectionImageData) {\r\n      this.updateSelectionCanvas()\r\n    }\r\n    this.updateNewCanvas()\r\n    if (this.resized) {\r\n      this.resized = false\r\n      this.props.onImageChanged(\r\n        this.newCtx.getImageData(\r\n          0,\r\n          0,\r\n          this.newCtx.canvas.width,\r\n          this.newCtx.canvas.height\r\n        )\r\n      )\r\n      this.updateOld = false\r\n      return\r\n    }\r\n    this.updateOld = true\r\n    if (this.props.selectionImageData !== prevProps.selectionImageData) {\r\n      this.props.onImageChanged(\r\n        this.newCtx.getImageData(\r\n          0,\r\n          0,\r\n          this.newCtx.canvas.width,\r\n          this.newCtx.canvas.height\r\n        )\r\n      )\r\n    }\r\n  }\r\n\r\n  updateOldCanvas = () => {\r\n    if (!this.oldCtx) {\r\n      const oldCanvas = document.createElement('canvas')\r\n      this.oldCtx = oldCanvas.getContext('2d')\r\n    }\r\n    this.oldCtx.canvas.width = this.props.imageData.width\r\n    this.oldCtx.canvas.height = this.props.imageData.height\r\n    this.oldCtx.putImageData(this.props.imageData, 0, 0)\r\n  }\r\n\r\n  updateSelectionCanvas = () => {\r\n    if (!this.selectionCtx) {\r\n      const selectionCanvas = document.createElement('canvas')\r\n      this.selectionCtx = selectionCanvas.getContext('2d')\r\n    }\r\n    this.selectionCtx.canvas.width = this.props.selectionImageData.width\r\n    this.selectionCtx.canvas.height = this.props.selectionImageData.height\r\n    this.selectionCtx.putImageData(this.props.selectionImageData, 0, 0)\r\n  }\r\n\r\n  updateNewCanvas = () => {\r\n    if (!this.newCtx) {\r\n      this.canvasRef.current.width = this.oldCtx.canvas.width\r\n      this.canvasRef.current.height = this.oldCtx.canvas.height\r\n      this.newCtx = this.canvasRef.current.getContext('2d')\r\n      this.newCtx.imageSmoothingEnabled = false\r\n    }\r\n\r\n    if (\r\n      this.newCtx.canvas.width !== this.oldCtx.canvas.width ||\r\n      this.newCtx.canvas.height !== this.oldCtx.canvas.height\r\n    ) {\r\n      this.newCtx.canvas.width = this.oldCtx.canvas.width\r\n      this.newCtx.canvas.height = this.oldCtx.canvas.height\r\n      this.newCtx.imageSmoothingEnabled = false\r\n    }\r\n\r\n    this.newCtx.drawImage(this.oldCtx.canvas, 0, 0)\r\n\r\n    this.newCtx.drawImage(\r\n      this.selectionCtx.canvas,\r\n      0,\r\n      0,\r\n      this.selectionCtx.canvas.width,\r\n      this.selectionCtx.canvas.height,\r\n      this.props.coords.left,\r\n      this.props.coords.top,\r\n      this.props.coords.width,\r\n      this.props.coords.height\r\n    )\r\n  }\r\n\r\n  handleResizing = ({ top, left, width, height }) => {}\r\n  handleResizeEnd = ({ top, left, width, height }) => {\r\n    if (!this.backgroundColor) {\r\n      this.backgroundColor = this.props.secondaryColor\r\n      this.newCtx.fillStyle = `rgb(${this.backgroundColor.r}, ${this.backgroundColor.g}, ${this.backgroundColor.b})`\r\n    }\r\n    this.updateOld = false\r\n    this.props.onSelectionChanged({\r\n      coords: { top, left, width, height },\r\n      imageData: this.props.selectionImageData\r\n    })\r\n    this.updateOld = false\r\n    this.props.onImageChanged(\r\n      this.newCtx.getImageData(\r\n        0,\r\n        0,\r\n        this.newCtx.canvas.width,\r\n        this.newCtx.canvas.height\r\n      )\r\n    )\r\n  }\r\n  handleMoving = ({ top, left, width, height }) => {\r\n    if (!this.backgroundColor) {\r\n      this.backgroundColor = this.props.secondaryColor\r\n      this.newCtx.fillStyle = `rgb(${this.backgroundColor.r}, ${this.backgroundColor.g}, ${this.backgroundColor.b})`\r\n    }\r\n    this.updateOld = false\r\n    this.props.onSelectionChanged({\r\n      coords: { top, left, width, height },\r\n      imageData: this.props.selectionImageData\r\n    })\r\n  }\r\n  handleMoveEnd = ({ top, left, width, height }) => {\r\n    this.updateOld = false\r\n    this.props.onImageChanged(\r\n      this.newCtx.getImageData(\r\n        0,\r\n        0,\r\n        this.newCtx.canvas.width,\r\n        this.newCtx.canvas.height\r\n      )\r\n    )\r\n  }\r\n\r\n  resizeCanvasToFitPasted = () => {\r\n    const canvas = document.createElement('canvas')\r\n    canvas.width = Math.max(\r\n      this.props.imageData.width,\r\n      this.props.selectionImageData.width\r\n    )\r\n    canvas.height = Math.max(\r\n      this.props.imageData.height,\r\n      this.props.selectionImageData.height\r\n    )\r\n    const ctx = canvas.getContext('2d')\r\n\r\n    ctx.fillStyle = `rgb(${this.props.secondaryColor.r}, ${this.props.secondaryColor.g}, ${this.props.secondaryColor.b})`\r\n    ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)\r\n    ctx.putImageData(this.props.imageData, 0, 0)\r\n\r\n    this.props.onImageChanged(\r\n      ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height)\r\n    )\r\n  }\r\n}\r\n\r\nImageDataSelection.propTypes = {\r\n  coords: PropTypes.shape({\r\n    top: PropTypes.number.isRequired,\r\n    left: PropTypes.number.isRequired,\r\n    width: PropTypes.number.isRequired,\r\n    height: PropTypes.number.isRequired\r\n  }).isRequired,\r\n  selectionImageData: PropTypes.instanceOf(ImageData).isRequired,\r\n  backgroundColor: PropTypes.shape({\r\n    r: PropTypes.number.isRequired,\r\n    g: PropTypes.number.isRequired,\r\n    b: PropTypes.number.isRequired\r\n  }),\r\n  imageData: PropTypes.instanceOf(ImageData).isRequired,\r\n  onSelectionChanged: PropTypes.func.isRequired,\r\n  onImageChanged: PropTypes.func.isRequired,\r\n  onClickOutside: PropTypes.func.isRequired\r\n}\r\n\r\nexport default ImageDataSelection\r\n","import React, { PureComponent, createRef } from 'react'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport ZoneSelection from './ZoneSelection/ZoneSelection'\r\nimport ImageDataSelection from './ImageDataSelection/ImageDataSelection'\r\n\r\nimport './SelectionInstrument.css'\r\n\r\nimport { changeSelection } from './actions'\r\nimport { changeImage } from '../../App/actions'\r\n\r\n// the selection is not working quite right:\r\n// there's no way a person can select the full width\r\n// of the picture, because max coordinate is width-1.\r\n// interesting that full height is selectable though.\r\n// at least it works somehow, will polish it later maybe.\r\n\r\nclass SelectionInstrument extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n\r\n    this.state = {\r\n      selecting: false,\r\n      selectingX: null,\r\n      selectingY: null,\r\n      selectingCoords: null\r\n    }\r\n\r\n    this.containerRef = createRef()\r\n\r\n    // todo - imageData selection handling\r\n  }\r\n  render () {\r\n    let El\r\n    if (this.state.selecting && this.state.selectingCoords) {\r\n      El = (\r\n        <div\r\n          className='selecting'\r\n          style={{\r\n            top: `${this.state.selectingCoords.top}px`,\r\n            left: `${this.state.selectingCoords.left}px`,\r\n            width: `${this.state.selectingCoords.width}px`,\r\n            height: `${this.state.selectingCoords.height}px`\r\n          }}\r\n        />\r\n      )\r\n    } else if (this.props.selectionImageData) {\r\n      El = (\r\n        <ImageDataSelection\r\n          onClickOutside={e => this.handlePointerDown(e, true)}\r\n          imageData={this.props.imageData}\r\n          coords={this.props.selectionCoords}\r\n          selectionImageData={this.props.selectionImageData}\r\n          onSelectionChanged={this.props.changeSelection}\r\n          onImageChanged={imageData => this.props.changeImage(imageData)}\r\n          secondaryColor={this.props.secondaryColor}\r\n        />\r\n      )\r\n    } else if (this.props.selectionCoords) {\r\n      El = (\r\n        <ZoneSelection\r\n          onClickOutside={e => this.handlePointerDown(e, true)}\r\n          imageData={this.props.imageData}\r\n          coords={this.props.selectionCoords}\r\n          onCoordsChanged={zone =>\r\n            this.props.changeSelection({ coords: zone, imageData: null })}\r\n          onImageChanged={imageData => this.props.changeImage(imageData)}\r\n          secondaryColor={this.props.secondaryColor}\r\n        />\r\n      )\r\n    } else El = null\r\n    return (\r\n      <div\r\n        className='selection'\r\n        onPointerDown={this.handlePointerDown}\r\n        ref={this.containerRef}\r\n      >\r\n        {El}\r\n      </div>\r\n    )\r\n  }\r\n  handlePointerDown = (e, trusted) => {\r\n    if (e.target !== e.currentTarget && !trusted) return\r\n\r\n    this.backgroundColor = null\r\n    this.props.changeSelection({ coords: null, imageData: null })\r\n\r\n    let {\r\n      top,\r\n      left,\r\n      bottom,\r\n      right\r\n    } = this.containerRef.current.getBoundingClientRect()\r\n    ;[top, left, bottom, right] = [\r\n      top + window.pageYOffset,\r\n      left + window.pageXOffset,\r\n      bottom + window.pageYOffset,\r\n      right + window.pageXOffset\r\n    ]\r\n    const [mouseX, mouseY] = [\r\n      e.clientX + window.pageXOffset,\r\n      e.clientY + window.pageYOffset\r\n    ]\r\n    ;[top, left] = [Math.ceil(mouseY - top), Math.ceil(mouseX - left)]\r\n    this.setState({\r\n      selecting: true,\r\n      selectingY: top,\r\n      selectingX: left,\r\n      selectingCoords: null\r\n    })\r\n  }\r\n  handleDocumentPointerMove = e => {\r\n    if (!this.state.selecting) return\r\n\r\n    switch (e.buttons) {\r\n      case 1:\r\n        this.setState(state => {\r\n          // getting bounding rect and mouse coords relatively to document, not viewport\r\n          let {\r\n            top,\r\n            left,\r\n            bottom,\r\n            right\r\n          } = this.containerRef.current.getBoundingClientRect()\r\n          ;[top, left, bottom, right] = [\r\n            top + window.pageYOffset,\r\n            left + window.pageXOffset,\r\n            bottom + window.pageYOffset,\r\n            right + window.pageXOffset\r\n          ]\r\n          const [mouseX, mouseY] = [\r\n            e.clientX + window.pageXOffset,\r\n            e.clientY + window.pageYOffset\r\n          ]\r\n\r\n          // getting top and left coordinates of current mouse position relatively to canvas\r\n          let [canvasRelativeTop, canvasRelativeLeft] = [\r\n            Math.trunc(mouseY - top),\r\n            Math.trunc(mouseX - left)\r\n          ]\r\n          // clamping top and left coordinates between 0 and canvas width\r\n          //\r\n          ;[canvasRelativeTop, canvasRelativeLeft] = [\r\n            Math.max(\r\n              0,\r\n              Math.min(canvasRelativeTop, this.props.imageData.height)\r\n            ),\r\n            Math.max(\r\n              0,\r\n              Math.min(canvasRelativeLeft, this.props.imageData.width)\r\n            )\r\n          ]\r\n\r\n          // console.log(canvasRelativeTop, canvasRelativeLeft)\r\n\r\n          const selectingCoords = {\r\n            top: Math.min(state.selectingY, canvasRelativeTop),\r\n            left: Math.min(state.selectingX, canvasRelativeLeft),\r\n            width: Math.max(\r\n              Math.max(state.selectingX, canvasRelativeLeft) -\r\n                Math.min(state.selectingX, canvasRelativeLeft),\r\n              0\r\n            ),\r\n            height: Math.max(\r\n              Math.max(state.selectingY, canvasRelativeTop) -\r\n                Math.min(state.selectingY, canvasRelativeTop),\r\n              0\r\n            )\r\n          }\r\n\r\n          return {\r\n            selectingCoords\r\n          }\r\n        })\r\n        break\r\n      case 2:\r\n      case 3:\r\n        this.setState({\r\n          selecting: false,\r\n          selectingX: null,\r\n          selectingY: null,\r\n          selectingCoords: null\r\n        })\r\n        this.preventContextMenu = true\r\n        break // no default\r\n    }\r\n  }\r\n  handleDocumentPointerUp = e => {\r\n    this.setState(state => {\r\n      let selectionOriginCoords = null\r\n      // also checking if user just clicked without moving (so there's no selectionCoords)\r\n      if (state.selecting && this.state.selectingCoords) {\r\n        if (\r\n          this.state.selectingCoords.width > 0 &&\r\n          this.state.selectingCoords.height > 0\r\n        ) {\r\n          this.props.changeSelection({\r\n            coords: this.state.selectingCoords,\r\n            imageData: null\r\n          })\r\n          selectionOriginCoords = this.state.selectingCoords\r\n        }\r\n        return {\r\n          selecting: false,\r\n          selectingX: null,\r\n          selectingY: null,\r\n          selectingCoords: null,\r\n          selectionOriginCoords\r\n        }\r\n      } else {\r\n        return {\r\n          selecting: false,\r\n          selectingX: null,\r\n          selectingY: null\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  componentDidMount () {\r\n    document.addEventListener('pointermove', this.handleDocumentPointerMove, {\r\n      passive: true\r\n    })\r\n    document.addEventListener('pointerup', this.handleDocumentPointerUp, {\r\n      passive: true\r\n    })\r\n    document.addEventListener('contextmenu', this.handleContextMenu)\r\n  }\r\n  componentWillUnmount () {\r\n    document.removeEventListener(\r\n      'pointermove',\r\n      this.handleDocumentPointerMove,\r\n      { passive: true }\r\n    )\r\n    document.removeEventListener('pointerup', this.handleDocumentPointerUp, {\r\n      passive: true\r\n    })\r\n    document.removeEventListener('contextmenu', this.handleContextMenu)\r\n  }\r\n\r\n  handleContextMenu = e => {\r\n    if (this.preventContextMenu) {\r\n      e.preventDefault()\r\n      this.preventContextMenu = false\r\n    }\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  imageData: state.image.data,\r\n  selectionCoords: state.instruments.selection\r\n    ? state.instruments.selection.coords\r\n    : null,\r\n  selectionImageData: state.instruments.selection\r\n    ? state.instruments.selection.imageData\r\n    : null,\r\n  secondaryColor: state.colors.list[state.colors.secondary]\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n  changeSelection: (zone, imageData) =>\r\n    dispatch(changeSelection(zone, imageData)),\r\n  changeImage: imageData => dispatch(changeImage(imageData))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SelectionInstrument)\r\n","import { types } from '../actions'\r\n\r\nexport function changeSelection ({coords, imageData}) {\r\n  return {\r\n    type: types.CHANGE_INSTRUMENT,\r\n    instrument: 'selection',\r\n    selection: {\r\n      coords,\r\n      imageData\r\n    }\r\n  }\r\n}\r\n\r\nexport function disableSelection () {\r\n  return {\r\n    type: types.CHANGE_INSTRUMENT,\r\n    selection: {\r\n      coords: null,\r\n      imageData: null\r\n    }\r\n  }\r\n}\r\n","import React, { PureComponent, createRef } from 'react'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport './Pen.css'\r\nimport { bresenhamLine, getCanvasCoordsFromEvent } from '../../helpers'\r\nimport { changeImage } from '../../App/actions'\r\n\r\nclass Pen extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.isDrawing = false\r\n    this.prevX = 0\r\n    this.prevY = 0\r\n    this.canvasRef = createRef()\r\n    this.ctx = undefined\r\n  }\r\n  render () {\r\n    return (\r\n      <canvas\r\n        className='pen-canvas'\r\n        ref={this.canvasRef}\r\n        width={this.props.imageData ? this.props.imageData.width : 0}\r\n        height={this.props.imageData ? this.props.imageData.height : 0}\r\n        onPointerDown={this.handlePointerDown}\r\n        onPointerUp={this.handlePointerUp}\r\n        onPointerMove={this.handlePointerMove}\r\n        onPointerEnter={this.handlePointerEnter}\r\n        onPointerLeave={this.handlePointerLeave}\r\n      />\r\n    )\r\n  }\r\n  handlePointerDown = e => {\r\n    this.isDrawing = true\r\n    this.beginDrawing(...getCanvasCoordsFromEvent(this.canvasRef.current, e))\r\n  }\r\n  handlePointerMove = e => {\r\n    if (this.isDrawing && e.buttons !== 3) {\r\n      this.continueDrawing(\r\n        ...getCanvasCoordsFromEvent(this.canvasRef.current, e)\r\n      )\r\n    }\r\n  }\r\n  handlePointerEnter = e => {\r\n    if (e.buttons === 1 && this.isDrawing) {\r\n      this.continueDrawing(\r\n        ...getCanvasCoordsFromEvent(this.canvasRef.current, e)\r\n      )\r\n    } else {\r\n      this.isDrawing = false\r\n    }\r\n  }\r\n  handlePointerLeave = e => {\r\n    if (this.isDrawing) {\r\n      this.continueDrawing(\r\n        ...getCanvasCoordsFromEvent(this.canvasRef.current, e)\r\n      )\r\n    }\r\n  }\r\n  handleDocumentPointerUp = () => {\r\n    if (this.isDrawing) {\r\n      this.isDrawing = false\r\n      this.endDrawing()\r\n    }\r\n  }\r\n  handleDocumentPointerMove = e => {\r\n    if (e.target !== this.canvasRef.current) {\r\n      ;[this.prevX, this.prevY] = getCanvasCoordsFromEvent(\r\n        this.canvasRef.current,\r\n        e\r\n      )\r\n    }\r\n    if (this.isDrawing && e.button === 2) {\r\n      this.preventContextMenu = true\r\n      this.cancelDrawing()\r\n    }\r\n  }\r\n  handleDocumentContextMenu = e => {\r\n    if (this.isDrawing) {\r\n      e.preventDefault()\r\n      this.isDrawing = false\r\n    }\r\n  }\r\n  handleDocumentSelectStart = e => {\r\n    if (this.isDrawing) {\r\n      e.preventDefault()\r\n    }\r\n  }\r\n  componentDidMount () {\r\n    this.ctx = this.canvasRef.current.getContext('2d')\r\n    if (this.props.imageData != null) {\r\n      this.ctx.putImageData(this.props.imageData, 0, 0)\r\n    }\r\n    document.addEventListener('pointerup', this.handleDocumentPointerUp)\r\n    document.addEventListener('pointermove', this.handleDocumentPointerMove)\r\n    document.addEventListener('selectstart', this.handleDocumentSelectStart)\r\n    document.addEventListener('contextmenu', this.handleDocumentContextMenu)\r\n  }\r\n  componentWillUnmount () {\r\n    document.removeEventListener('pointerup', this.handleDocumentPointerUp)\r\n    document.removeEventListener('pointermove', this.handleDocumentPointerMove)\r\n    document.removeEventListener('selectstart', this.handleDocumentSelectStart)\r\n    document.removeEventListener('contextmenu', this.handleDocumentContextMenu)\r\n  }\r\n  componentDidUpdate () {\r\n    if (this.props.imageData != null) {\r\n      this.ctx.putImageData(this.props.imageData, 0, 0)\r\n    }\r\n  }\r\n  beginDrawing = (x, y) => {\r\n    const { r, g, b } = this.props.color\r\n    this.ctx.fillStyle = `rgb(${r},${g},${b})`\r\n    this.ctx.fillRect(x, y, 1, 1)\r\n    ;[this.prevX, this.prevY] = [x, y]\r\n  }\r\n  continueDrawing = (x, y) => {\r\n    bresenhamLine(this.prevX, this.prevY, x, y, this.drawPoint)\r\n    ;[this.prevX, this.prevY] = [x, y]\r\n  }\r\n  endDrawing = () => {\r\n    this.props.dispatch(\r\n      changeImage(\r\n        this.ctx.getImageData(\r\n          0,\r\n          0,\r\n          this.canvasRef.current.width,\r\n          this.canvasRef.current.height\r\n        )\r\n      )\r\n    )\r\n  }\r\n  cancelDrawing = () => {\r\n    this.ctx.putImageData(this.props.imageData, 0, 0)\r\n  }\r\n  drawPoint = (x, y) => {\r\n    this.ctx.fillRect(x, y, 1, 1)\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  color: state.colors.list[state.colors.primary],\r\n  imageData: state.image.data\r\n})\r\n\r\nexport default connect(mapStateToProps)(Pen)\r\n","import React, { PureComponent, createRef } from 'react'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport './Fill.css'\r\nimport { getCanvasCoordsFromEvent } from '../../helpers'\r\nimport { changeImage } from '../../App/actions'\r\n\r\nclass Fill extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.canvasRef = createRef()\r\n  }\r\n  render () {\r\n    return (\r\n      <canvas\r\n        className='fill-canvas'\r\n        ref={this.canvasRef}\r\n        width={this.props.imageData ? this.props.imageData.width : 0}\r\n        height={this.props.imageData ? this.props.imageData.height : 0}\r\n        onMouseDown={this.handleMouseDown}\r\n      />\r\n    )\r\n  }\r\n  handleMouseDown = e => {\r\n    const [x, y] = getCanvasCoordsFromEvent(this.canvasRef.current, e)\r\n    const data = this.ctx.getImageData(\r\n      0,\r\n      0,\r\n      this.canvasRef.current.width,\r\n      this.canvasRef.current.height\r\n    )\r\n    this.floodFill(\r\n      data,\r\n      x,\r\n      y,\r\n      {\r\n        r: data.data[(y * data.width + x) * 4],\r\n        g: data.data[(y * data.width + x) * 4 + 1],\r\n        b: data.data[(y * data.width + x) * 4 + 2]\r\n      },\r\n      this.props.color\r\n    )\r\n    this.props.dispatch(changeImage(data))\r\n  }\r\n  // optimized the shit out of it (as I can judge) \r\n  floodFill = (data, x, y, colorToReplace, colorToFillWith) => {\r\n    const replaceR = colorToReplace.r,\r\n      replaceG = colorToReplace.g,\r\n      replaceB = colorToReplace.b\r\n    const fillR = colorToFillWith.r,\r\n      fillG = colorToFillWith.g,\r\n      fillB = colorToFillWith.b\r\n\r\n    const i = (y * data.width + x) * 4\r\n\r\n    if (\r\n      !(replaceR === data.data[i] &&\r\n        replaceG === data.data[i + 1] &&\r\n        replaceB === data.data[i + 2]) ||\r\n      (replaceR === fillR && replaceG === fillG && replaceB === fillB)\r\n    ) {\r\n      return\r\n    }\r\n\r\n    const q = []\r\n\r\n    data.data[i] = fillR\r\n    data.data[i + 1] = fillG\r\n    data.data[i + 2] = fillB\r\n\r\n    q.push([x, y])\r\n\r\n    while (q.length !== 0) {\r\n      const n = q.shift()\r\n      const i = (n[1] * data.width + n[0]) * 4\r\n      if (\r\n        n[0] > 0 &&\r\n        (replaceR === data.data[i - 4] &&\r\n          replaceG === data.data[i - 3] &&\r\n          replaceB === data.data[i - 2])\r\n      ) {\r\n        data.data[i - 4] = fillR\r\n        data.data[i - 3] = fillG\r\n        data.data[i - 2] = fillB\r\n        q.push([n[0] - 1, n[1]])\r\n      }\r\n      if (\r\n        n[0] < data.width - 1 &&\r\n        (replaceR === data.data[i + 4] &&\r\n          replaceG === data.data[i + 5] &&\r\n          replaceB === data.data[i + 6])\r\n      ) {\r\n        data.data[i + 4] = fillR\r\n        data.data[i + 5] = fillG\r\n        data.data[i + 6] = fillB\r\n        q.push([n[0] + 1, n[1]])\r\n      }\r\n      if (\r\n        n[1] > 0 &&\r\n        (replaceR === data.data[i - data.width * 4] &&\r\n          replaceG === data.data[i - data.width * 4 + 1] &&\r\n          replaceB === data.data[i - data.width * 4 + 2])\r\n      ) {\r\n        data.data[i - data.width * 4] = fillR\r\n        data.data[i - data.width * 4 + 1] = fillG\r\n        data.data[i - data.width * 4 + 2] = fillB\r\n        q.push([n[0], n[1] - 1])\r\n      }\r\n      if (\r\n        n[1] < data.height - 1 &&\r\n        (replaceR === data.data[i + data.width * 4] &&\r\n          replaceG === data.data[i + data.width * 4 + 1] &&\r\n          replaceB === data.data[i + data.width * 4 + 2])\r\n      ) {\r\n        data.data[i + data.width * 4] = fillR\r\n        data.data[i + data.width * 4 + 1] = fillG\r\n        data.data[i + data.width * 4 + 2] = fillB\r\n        q.push([n[0], n[1] + 1])\r\n      }\r\n    }\r\n  }\r\n  componentDidMount () {\r\n    this.ctx = this.canvasRef.current.getContext('2d')\r\n    if (this.props.imageData != null) {\r\n      this.ctx.putImageData(this.props.imageData, 0, 0)\r\n    }\r\n  }\r\n  componentDidUpdate () {\r\n    this.ctx.putImageData(this.props.imageData, 0, 0)\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  color: state.colors.list[state.colors.primary],\r\n  imageData: state.image.data\r\n})\r\n\r\nexport default connect(mapStateToProps)(Fill)\r\n","export const types = {\r\n  ADD_COLOR: 'colors/add',\r\n  SELECT_COLOR: 'colors/select',\r\n  CHANGE_ACTIVE_COLOR: 'colors/change-active'\r\n}\r\n\r\nexport function changeActiveColor (activeColor) {\r\n  return {\r\n    type: types.CHANGE_ACTIVE_COLOR,\r\n    activeColor\r\n  }\r\n}\r\n\r\nexport function addColorFromInput (e) {\r\n  return (dispatch, getState) => {\r\n    const hexRgb = e.target.value.match(/[A-Za-z0-9]{2}/g)\r\n    const rgb = hexRgb.map(v => parseInt(v, 16))\r\n    const rgbObject = { r: rgb[0], g: rgb[1], b: rgb[2] }\r\n    const rgbObjectString = JSON.stringify(rgbObject)\r\n    let found = false\r\n    for (let i = 0; i < getState().colors.list.length; i++) {\r\n      if (JSON.stringify(getState().colors.list[i]) === rgbObjectString) {\r\n        found = true\r\n        break\r\n      }\r\n    }\r\n    if (!found) {\r\n      dispatch({\r\n        type: types.ADD_COLOR,\r\n        value: rgbObject\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport function addColor (rgbObject) {\r\n  return (dispatch, getState) => {\r\n    let found = false\r\n    const rgbObjectString = JSON.stringify(rgbObject)\r\n    for (let i = 0; i < getState().colors.list.length; i++) {\r\n      if (JSON.stringify(getState().colors.list[i]) === rgbObjectString) {\r\n        found = i\r\n        break\r\n      }\r\n    }\r\n    if (found === false) {\r\n      dispatch({\r\n        type: types.ADD_COLOR,\r\n        value: rgbObject\r\n      })\r\n    } else {\r\n      dispatch(selectColor(found))\r\n    }\r\n  }\r\n}\r\n\r\nexport function selectColor (index) {\r\n  return {\r\n    type: types.SELECT_COLOR,\r\n    index\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react'\r\n\r\nimport { connect } from 'react-redux'\r\nimport { addColor } from '../../Colors/actions'\r\nimport { selectInstrument } from '../actions'\r\nimport './Dropper.css'\r\n\r\nclass Dropper extends PureComponent {\r\n  render () {\r\n    return (\r\n      <div\r\n        className='dropper'\r\n        onClick={this.handleClick}\r\n        style={{\r\n          width: this.props.imageData.width,\r\n          height: this.props.imageData.height\r\n        }}\r\n      />\r\n    )\r\n  }\r\n  handleClick = e => {\r\n    if (e.target !== e.currentTarget) return\r\n\r\n    let { top, left, bottom, right } = e.target.getBoundingClientRect()\r\n    ;[top, left, bottom, right] = [\r\n      top + window.pageYOffset,\r\n      left + window.pageXOffset,\r\n      bottom + window.pageYOffset,\r\n      right + window.pageXOffset\r\n    ]\r\n    const [mouseX, mouseY] = [\r\n      e.clientX + window.pageXOffset,\r\n      e.clientY + window.pageYOffset\r\n    ]\r\n    ;[top, left] = [Math.ceil(mouseY - top), Math.ceil(mouseX - left)]\r\n    \r\n    const i = (top*this.props.imageData.width + left)*4\r\n    \r\n    this.props.addColor({\r\n      r: this.props.imageData.data[i],\r\n      g: this.props.imageData.data[i+1],\r\n      b: this.props.imageData.data[i+2]\r\n    })\r\n    this.props.selectInstrument('pen')\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  imageData: state.image.data\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n  addColor: color => dispatch(addColor(color)),\r\n  selectInstrument: instrument => dispatch(selectInstrument(instrument))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Dropper)\r\n","import React, { PureComponent, createRef } from 'react'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport './Eraser.css'\r\nimport { bresenhamLine, getCanvasCoordsFromEvent } from '../../helpers'\r\nimport { changeImage } from '../../App/actions'\r\n\r\nclass Eraser extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.canvasRef = createRef()\r\n    this.ctx = null\r\n    const noCursorCanvas = document.createElement('canvas')\r\n    this.noCursorCtx = noCursorCanvas.getContext('2d')\r\n    this.isDrawing = false\r\n    this.prevX = 0\r\n    this.prevY = 0\r\n  }\r\n  render () {\r\n    return (\r\n      <canvas\r\n        className='eraser-canvas'\r\n        ref={this.canvasRef}\r\n        width={this.props.imageData ? this.props.imageData.width : 0}\r\n        height={this.props.imageData ? this.props.imageData.height : 0}\r\n        onPointerDown={this.handlePointerDown}\r\n        onPointerUp={this.handlePointerUp}\r\n        onPointerMove={this.handlePointerMove}\r\n        onPointerEnter={this.handlePointerEnter}\r\n        onPointerLeave={this.handlePointerLeave}\r\n      />\r\n    )\r\n  }\r\n  handlePointerDown = e => {\r\n    this.isDrawing = true\r\n    this.drawPoint()\r\n    this.beginDrawing(...getCanvasCoordsFromEvent(this.canvasRef.current, e))\r\n  }\r\n  handlePointerMove = e => {\r\n    const [x, y] = getCanvasCoordsFromEvent(this.canvasRef.current, e)\r\n    if (this.isDrawing && e.buttons !== 3) {\r\n      this.continueDrawing(\r\n        x, y\r\n      )\r\n    }\r\n    this.updateCanvas(x, y)\r\n  }\r\n  handlePointerEnter = e => {\r\n    if (e.buttons === 1 && this.isDrawing) {\r\n      this.continueDrawing(\r\n        ...getCanvasCoordsFromEvent(this.canvasRef.current, e)\r\n      )\r\n    } else {\r\n      this.isDrawing = false\r\n    }\r\n  }\r\n  handlePointerLeave = e => {\r\n    if (this.isDrawing) {\r\n      this.continueDrawing(\r\n        ...getCanvasCoordsFromEvent(this.canvasRef.current, e)\r\n      )\r\n    }\r\n    this.updateCanvas()\r\n  }\r\n\r\n  handleDocumentPointerUp = () => {\r\n    if (this.isDrawing) {\r\n      this.isDrawing = false\r\n      this.endDrawing()\r\n    }\r\n  }\r\n  handleDocumentPointerMove = e => {\r\n    if (e.target !== this.canvasRef.current) {\r\n      ;[this.prevX, this.prevY] = getCanvasCoordsFromEvent(\r\n        this.canvasRef.current,\r\n        e\r\n      )\r\n    }\r\n    if (this.isDrawing && e.button === 2) {\r\n      this.preventContextMenu = true\r\n      this.cancelDrawing()\r\n    }\r\n  }\r\n  handleDocumentContextMenu = e => {\r\n    if (this.isDrawing) {\r\n      e.preventDefault()\r\n      this.isDrawing = false\r\n    }\r\n  }\r\n  handleDocumentSelectStart = e => {\r\n    if (this.isDrawing) {\r\n      e.preventDefault()\r\n    }\r\n  }\r\n\r\n  componentDidMount () {\r\n    this.ctx = this.canvasRef.current.getContext('2d')\r\n    const { r, g, b } = this.props.color\r\n    this.ctx.fillStyle = `rgb(${r},${g},${b})`\r\n    this.ctx.strokeStyle = \"black\"\r\n    this.noCursorCtx.fillStyle = `rgb(${r},${g},${b})`\r\n    this.updateCanvasNoCursor()\r\n    document.addEventListener('pointerup', this.handleDocumentPointerUp)\r\n    document.addEventListener('pointermove', this.handleDocumentPointerMove)\r\n    document.addEventListener('selectstart', this.handleDocumentSelectStart)\r\n    document.addEventListener('contextmenu', this.handleDocumentContextMenu)\r\n  }\r\n  componentDidUpdate () {\r\n    const { r, g, b } = this.props.color\r\n    this.ctx.fillStyle = `rgb(${r},${g},${b})`\r\n    this.noCursorCtx.fillStyle = `rgb(${r},${g},${b})`\r\n    this.updateCanvasNoCursor()\r\n  }\r\n  componentWillUnmount () {\r\n    document.removeEventListener('pointerup', this.handleDocumentPointerUp)\r\n    document.removeEventListener('pointermove', this.handleDocumentPointerMove)\r\n    document.removeEventListener('selectstart', this.handleDocumentSelectStart)\r\n    document.removeEventListener('contextmenu', this.handleDocumentContextMenu)\r\n  }\r\n\r\n  beginDrawing = (x, y) => {\r\n    const { r, g, b } = this.props.color\r\n    this.ctx.fillStyle = `rgb(${r},${g},${b})`\r\n    this.drawPoint(x, y)\r\n    ;[this.prevX, this.prevY] = [x, y]\r\n  }\r\n  continueDrawing = (x, y) => {\r\n    bresenhamLine(this.prevX, this.prevY, x, y, this.drawPoint)\r\n    ;[this.prevX, this.prevY] = [x, y]\r\n  }\r\n  endDrawing = () => {\r\n    this.props.dispatch(\r\n      changeImage(\r\n        this.noCursorCtx.getImageData(\r\n          0,\r\n          0,\r\n          this.noCursorCtx.canvas.width,\r\n          this.noCursorCtx.canvas.height\r\n        )\r\n      )\r\n    )\r\n  }\r\n  cancelDrawing = () => {\r\n    this.noCursorCtx.putImageData(this.props.imageData, 0, 0)\r\n  }\r\n  drawPoint = (x, y) => {\r\n    this.noCursorCtx.fillRect(\r\n      x - this.props.thickness / 2,\r\n      y - this.props.thickness / 2,\r\n      this.props.thickness,\r\n      this.props.thickness\r\n    )\r\n  }\r\n\r\n  updateCanvasNoCursor = () => {\r\n    if (this.props.imageData != null) {\r\n      [this.noCursorCtx.canvas.width, this.noCursorCtx.canvas.height] = [this.props.imageData.width, this.props.imageData.height]\r\n      const { r, g, b } = this.props.color\r\n      this.noCursorCtx.fillStyle = `rgb(${r},${g},${b})`\r\n      ;this.noCursorCtx.putImageData(this.props.imageData, 0, 0)\r\n    }\r\n  }\r\n  updateCanvas = (x, y) => {\r\n    this.ctx.drawImage(this.noCursorCtx.canvas, 0, 0)\r\n    if (x && y) {\r\n      this.ctx.fillRect(\r\n        x - this.props.thickness / 2,\r\n        y - this.props.thickness / 2,\r\n        this.props.thickness,\r\n        this.props.thickness\r\n      )\r\n      this.ctx.strokeRect(\r\n        x - this.props.thickness / 2 + 0.5,\r\n        y - this.props.thickness / 2 + 0.5,\r\n        this.props.thickness - 1,\r\n        this.props.thickness - 1\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  color: state.colors.list[state.colors.secondary],\r\n  imageData: state.image.data,\r\n  thickness: 8 // insert true one after thickness is made\r\n})\r\n\r\nexport default connect(mapStateToProps)(Eraser)\r\n","import React, { PureComponent } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport SelectionInstrument from '../instruments/SelectionInstrument/SelectionInstrument'\r\nimport Pen from '../instruments/Pen/Pen'\r\nimport Fill from '../instruments/Fill/Fill'\r\nimport Dropper from '../instruments/Dropper/Dropper'\r\nimport Eraser from '../instruments/Eraser/Eraser'\r\n\r\nconst instruments = {\r\n  pen: Pen,\r\n  fill: Fill,\r\n  selection: SelectionInstrument,\r\n  dropper: Dropper,\r\n  eraser: Eraser\r\n}\r\n\r\nclass CanvasEditor extends PureComponent {\r\n  render () {\r\n    const Element = instruments[this.props.instrument]\r\n    return Element != null ? <Element /> : null\r\n  }\r\n}\r\n\r\nCanvasEditor.propTypes = {\r\n  instrument: PropTypes.string\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  instrument: state.instruments.instrument\r\n})\r\n\r\nexport default connect(mapStateToProps)(CanvasEditor)\r\n","import React, { PureComponent, createRef } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport { changeImage } from '../App/actions'\r\nimport { disableSelection } from '../instruments/SelectionInstrument/actions'\r\n\r\nimport Resizer from '../Resizer/Resizer'\r\nimport CanvasEditor from '../CanvasEditor/CanvasEditor'\r\n\r\nimport './Canvas.css'\r\n\r\nclass Canvas extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.canvas = createRef()\r\n  }\r\n  render () {\r\n    return (\r\n      <div className='canvas-wrapper'>\r\n        <canvas\r\n          ref={this.canvas}\r\n          className='canvas'\r\n          width={this.props.data ? this.props.data.width : 0}\r\n          height={this.props.data ? this.props.data.height : 0}\r\n        />\r\n        <div\r\n          className='canvas-upper-layer'\r\n          style={{\r\n            width: this.props.data ? this.props.data.width : 0,\r\n            height: this.props.data ? this.props.data.height : 0\r\n          }}\r\n        >\r\n          <Resizer\r\n            mode='canvas'\r\n            onResizeEnd={this.onResize}\r\n            onResizing={this.props.disableSelection}\r\n            width={this.props.data ? this.props.data.width : 0}\r\n            height={this.props.data ? this.props.data.height : 0}\r\n            top={0}\r\n            left={0}\r\n          />\r\n          <CanvasEditor />\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n  updateCanvas = () => {\r\n    const canvas = this.canvas.current\r\n    if (canvas != null && this.props.data != null) {\r\n      ;[canvas.width, canvas.height] = [\r\n        this.props.data.width,\r\n        this.props.data.height \r\n      ]\r\n      const ctx = canvas.getContext('2d')\r\n      ctx.putImageData(this.props.data, 0, 0)\r\n    }\r\n  }\r\n  onResize = (top, left, toWidth, toHeight) => {\r\n    if (this.props.data.width !== toWidth || this.props.data.height !== toHeight) {\r\n      const newCanvas = document.createElement('canvas')\r\n      newCanvas.width = toWidth\r\n      newCanvas.height = toHeight\r\n      const newCtx = newCanvas.getContext('2d')\r\n      newCtx.fillStyle = `rgb(${this.props.secondaryColor.r},${this.props.secondaryColor.g},${this.props.secondaryColor.b})`\r\n      newCtx.fillRect(0, 0, toWidth, toHeight)\r\n      newCtx.putImageData(this.props.data, 0, 0)\r\n      this.props.changeImage(newCtx.getImageData(0, 0, toWidth, toHeight))\r\n    }\r\n  }\r\n  componentDidMount () {\r\n    this.updateCanvas()\r\n  }\r\n  componentDidUpdate () {\r\n    this.updateCanvas()\r\n  }\r\n}\r\n\r\nCanvas.propTypes = {\r\n  data: PropTypes.object\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  data: state.image.data,\r\n  secondaryColor: state.colors.list[state.colors.secondary]\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  changeImage: data => dispatch(changeImage(data)),\r\n  disableSelection: () => dispatch(disableSelection())\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Canvas)\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport './NavBarItem.css'\r\n\r\nconst NavBarItem = props => (\r\n  <section className='navbar-item'>\r\n    {props.children}\r\n    <footer>\r\n      {props.footer}\r\n    </footer>\r\n  </section>\r\n)\r\n\r\nNavBarItem.propTypes = {\r\n  footer: PropTypes.string\r\n}\r\n\r\nexport default NavBarItem\r\n","import React, { Component } from 'react'\r\n\r\nimport './NavBar.css'\r\n\r\nimport NavBarItem from './NavBarItem'\r\n\r\nclass NavBar extends Component {\r\n  render () {\r\n    return (\r\n      <nav className='navbar'>\r\n        {this.props.children.map((c, i) => (\r\n          <NavBarItem footer={c.props.footer} key={`navbaritem${i}`}>\r\n            {c}\r\n          </NavBarItem>\r\n        ))}\r\n      </nav>\r\n    )\r\n  }\r\n}\r\n\r\nexport default NavBar\r\n","import React, { Component } from 'react'\r\n\r\nimport './Clipboard.css'\r\n\r\nclass Clipboard extends Component {\r\n  render () {\r\n    return (\r\n      <nav className='clipboard'>\r\n        <button disabled={false}>Вырезать</button>\r\n        <button disabled={false}>Копировать</button>\r\n        <button disabled={false}>Вставить</button>\r\n      </nav>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Clipboard\r\n","import React, { Component } from 'react'\r\nimport './Image.css'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport classNames from 'classnames'\r\n\r\nimport { selectInstrument } from '../instruments/actions'\r\nimport { changeImage } from '../App/actions'\r\n\r\nclass Image extends Component {\r\n  render () {\r\n    return (\r\n      <nav className='image'>\r\n        <button\r\n          className={classNames('select', {\r\n            select_active: this.props.instrument === 'selection'\r\n          })}\r\n          onClick={this.handleClick}\r\n        >\r\n          <svg viewBox='0 0 15 10'>\r\n            <rect\r\n              width='15'\r\n              height='10'\r\n              style={{\r\n                fill: 'transparent',\r\n                strokeWidth: '1',\r\n                strokeDasharray: '1',\r\n                stroke: 'black'\r\n              }}\r\n            />\r\n          </svg>\r\n          <footer>Выделить</footer>\r\n        </button>\r\n        <div className='side-buttons'>\r\n          <button\r\n            onClick={this.handleClipClick}\r\n            disabled={!(this.props.selection && this.props.selection.coords)}\r\n          >\r\n            Обрезать\r\n          </button>\r\n          <button>Изменить размер</button>\r\n          <button>Повернуть</button>\r\n        </div>\r\n      </nav>\r\n    )\r\n  }\r\n  handleClick = () => {\r\n    this.props.selectInstrument('selection')\r\n  }\r\n  handleClipClick = () => {\r\n    if (!(this.props.selection && this.props.selection.coords)) {\r\n      return\r\n    }\r\n    const newCanvas = document.createElement('canvas')\r\n    const newCtx = newCanvas.getContext('2d')\r\n    ;({\r\n      width: newCanvas.width,\r\n      height: newCanvas.height\r\n    } = this.props.selection.coords)\r\n\r\n    newCtx.putImageData(this.props.image, 0, 0)\r\n    this.props.changeImage(\r\n      newCtx.getImageData(\r\n        this.props.selection.coords.left,\r\n        this.props.selection.coords.top,\r\n        this.props.selection.coords.width,\r\n        this.props.selection.coords.height\r\n      )\r\n    )\r\n    this.props.selectInstrument('selection')\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  image: state.image.data,\r\n  instrument: state.instruments.instrument,\r\n  selection: state.instruments.selection\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n  selectInstrument: instrument => dispatch(selectInstrument(instrument)),\r\n  changeImage: imageData => dispatch(changeImage(imageData))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Image)\r\n","import React, { PureComponent } from 'react'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport { selectInstrument } from './actions'\r\n\r\nimport classNames from 'classnames'\r\nimport './Instruments.css'\r\n\r\nconst instruments = ['pen', 'fill', 'text', 'eraser', 'dropper', 'zoom']\r\n\r\nclass Instruments extends PureComponent {\r\n  render () {\r\n    return (\r\n      <div className='instruments'>\r\n        {instruments.map(i => (\r\n          <button\r\n            className={classNames(`instrument_${i}`, {\r\n              instrument_active: i === this.props.instrument\r\n            })}\r\n            key={`instrument_${i}`}\r\n            onClick={this.props.selectInstrument.bind(undefined, i)}\r\n          />\r\n        ))}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  instrument: state.instruments.instrument\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n  selectInstrument: instrument => dispatch(selectInstrument(instrument))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Instruments)\r\n","import React from 'react'\r\n\r\nimport './ColorPalette.css'\r\n\r\nconst ColorPalette = props => (\r\n  <div className='color-palette'>\r\n    {props.children}\r\n  </div>\r\n)\r\n\r\nexport default ColorPalette\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport './ColorSelection.css'\r\n\r\nimport classNames from 'classnames'\r\n\r\nconst ColorSelection = props => (\r\n  <div className={classNames('color-selection', {'color-selection_active': props.active})} onClick={props.onClick}>\r\n    <div\r\n      className='color-selection-color'\r\n      style={{\r\n        backgroundColor: `rgb(${props.color.r},${props.color.g},${props.color.b})`\r\n      }}\r\n    />\r\n    <h6 className='color-selection-header'>\r\n      {props.header}\r\n    </h6>\r\n  </div>\r\n)\r\n\r\nColorSelection.propTypes = {\r\n  active: PropTypes.bool.isRequired,\r\n  color: PropTypes.shape({\r\n    r: PropTypes.number.isRequired,\r\n    g: PropTypes.number.isRequired,\r\n    b: PropTypes.number.isRequired\r\n  }),\r\n  onClick: PropTypes.func,\r\n  header: PropTypes.string\r\n}\r\n\r\nexport default ColorSelection\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport './ColorInput.css'\r\n\r\nconst ColorInput = props => (\r\n  <div className='color-input'>\r\n    <label className='color-input-wrapper'>\r\n      <input type='color' onChange={props.onChange} value={props.value} />\r\n    </label>\r\n    <h6 className='color-input-header'>\r\n      Изменение цветов\r\n    </h6>\r\n  </div>\r\n)\r\n\r\nColorInput.propTypes = {\r\n  onChange: PropTypes.func.isRequired,\r\n  value: PropTypes.string.isRequired\r\n}\r\n\r\nexport default ColorInput\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport './Color.css'\r\n\r\nimport classNames from 'classnames'\r\n\r\nconst Color = props => {\r\n  return (\r\n    <div\r\n      onClick={props.onClick}\r\n      style={props.value && { backgroundColor: `rgb(${props.value.r}, ${props.value.g}, ${props.value.b})` }}\r\n      className={classNames('color', { color_active: props.active, color_undefined: !props.value })}\r\n    />\r\n  )\r\n}\r\n\r\nColor.propTypes = {\r\n  onClick: PropTypes.func,\r\n  value: PropTypes.shape({\r\n    r: PropTypes.number,\r\n    g: PropTypes.number,\r\n    b: PropTypes.number\r\n  }),\r\n  active: PropTypes.bool\r\n}\r\n\r\nexport default Color\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport './Colors.css'\r\n\r\nimport ColorPalette from '../ColorPalette/ColorPalette'\r\nimport ColorSelection from '../ColorSelection/ColorSelection'\r\nimport ColorInput from '../ColorInput/ColorInput'\r\nimport Color from '../Color/Color'\r\n\r\nimport { rgbToHex } from '../helpers'\r\n\r\nconst ColorsComponent = props => (\r\n  <div className='colors'>\r\n    <ColorSelection\r\n      header='Цвет 1'\r\n      color={props.colors[props.primary]}\r\n      active={props.activeColor === 'primary'}\r\n      onClick={() => props.onActiveColorClick('primary')}\r\n    />\r\n    <ColorSelection\r\n      header='Цвет 2'\r\n      color={props.colors[props.secondary]}\r\n      active={props.activeColor === 'secondary'}\r\n      onClick={() => props.onActiveColorClick('secondary')}\r\n    />\r\n    <ColorPalette>\r\n      {[\r\n        ...props.colors.map((c, i) => (\r\n          <Color\r\n            value={c}\r\n            active={i === props[props.activeColor]}\r\n            onClick={() => props.onColorClick(i)}\r\n            key={'color' + i}\r\n            colorId={i}\r\n          />\r\n        )),\r\n        ...new Array(30 - props.colors.length)\r\n          .fill(undefined)\r\n          .map((item, i) => (\r\n            <Color\r\n              value={null}\r\n              key={'undefinedcolor' + i}\r\n            />\r\n          ))\r\n      ]}\r\n    </ColorPalette>\r\n    <ColorInput\r\n      onChange={props.onColorInputChange}\r\n      value={rgbToHex(props.colors[props[props.activeColor]])}\r\n    />\r\n  </div>\r\n)\r\n\r\nColorsComponent.propTypes = {\r\n  colors: PropTypes.arrayOf(PropTypes.shape({\r\n    r: PropTypes.number.isRequired,\r\n    g: PropTypes.number.isRequired,\r\n    b: PropTypes.number.isRequired\r\n  })).isRequired,\r\n  activeColor: PropTypes.oneOf(['primary', 'secondary']).isRequired,\r\n  onColorClick: PropTypes.func.isRequired,\r\n  onActiveColorClick: PropTypes.func.isRequired,\r\n  onColorInputChange: PropTypes.func.isRequired\r\n}\r\n\r\nexport default ColorsComponent\r\n","import React, { PureComponent } from 'react'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport ColorsComponent from './ColorsComponent'\r\nimport { changeActiveColor, selectColor, addColorFromInput } from './actions'\r\n\r\nclass ColorsContainer extends PureComponent {\r\n  render () {\r\n    return <ColorsComponent {...this.props} />\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  colors: state.colors.list,\r\n  activeColor: state.colors.activeColor,\r\n  primary: state.colors.primary,\r\n  secondary: state.colors.secondary\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n  onColorClick: index => dispatch(selectColor(index)),\r\n  onActiveColorClick: activeColor => dispatch(changeActiveColor(activeColor)),\r\n  onColorInputChange: e => dispatch(addColorFromInput(e))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ColorsContainer)\r\n","import { types } from './actions'\r\n\r\nconst colorsReducer = (\r\n  state = {\r\n    list: [\r\n      { r: 0, g: 0, b: 0 },\r\n      { r: 127, g: 127, b: 127 },\r\n      { r: 136, g: 0, b: 21 },\r\n      { r: 237, g: 28, b: 36 },\r\n      { r: 255, g: 127, b: 39 },\r\n      { r: 255, g: 242, b: 0 },\r\n      { r: 34, g: 177, b: 76 },\r\n      { r: 0, g: 162, b: 232 },\r\n      { r: 63, g: 72, b: 204 },\r\n      { r: 163, g: 73, b: 164 },\r\n      { r: 255, g: 255, b: 255 },\r\n      { r: 195, g: 195, b: 195 },\r\n      { r: 185, g: 122, b: 87 },\r\n      { r: 255, g: 174, b: 201 },\r\n      { r: 255, g: 201, b: 14 },\r\n      { r: 239, g: 228, b: 176 },\r\n      { r: 181, g: 230, b: 29 },\r\n      { r: 153, g: 217, b: 234 },\r\n      { r: 112, g: 176, b: 190 },\r\n      { r: 200, g: 191, b: 231 }\r\n    ],\r\n    activeColor: 'primary',\r\n    primary: 0,\r\n    secondary: 10\r\n  },\r\n  action\r\n) => {\r\n  const newState = { ...state }\r\n  switch (action.type) {\r\n    case types.SELECT_COLOR:\r\n      newState[newState.activeColor] = action.index\r\n      return newState\r\n    case types.ADD_COLOR:\r\n      if (newState.list.length !== 30) {\r\n        newState.list = [...newState.list, action.value]\r\n        newState[newState.activeColor] = state.list.length\r\n      } else {\r\n        newState.list = [\r\n          ...newState.list.slice(0, 20),\r\n          ...newState.list.slice(21),\r\n          action.value\r\n        ]\r\n        newState[newState.activeColor] = state.list.length - 1\r\n      }\r\n      return newState\r\n    case types.CHANGE_ACTIVE_COLOR:\r\n      newState.activeColor = action.activeColor\r\n      return newState\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default colorsReducer\r\n","import { types } from './actions'\r\n\r\nconst instrumentsReducer = (state = { instrument: 'pen' }, action) => {\r\n  switch (action.type) {\r\n    case types.CHANGE_INSTRUMENT:\r\n      const {type, ...withoutType} = action\r\n      return {...state, ...withoutType}\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default instrumentsReducer\r\n","import { combineReducers } from 'redux'\r\n\r\nimport { types } from './actions'\r\nimport colorsReducer from '../Colors/reducer'\r\nimport instrumentsReducer from '../instruments/reducer'\r\n\r\nconst canvasReducer = (\r\n  state,\r\n  action\r\n) => {\r\n  if (state === undefined) {\r\n    const canvasEl = document.createElement('canvas')\r\n    ;[canvasEl.width, canvasEl.height] = [800, 450]\r\n    const ctx = canvasEl.getContext('2d')\r\n    ctx.fillStyle = '#FFFFFF'\r\n    ctx.fillRect(0, 0, canvasEl.width, canvasEl.height)\r\n    return {\r\n      data: ctx.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n      name: 'Ваша пикча.png'\r\n    }\r\n  }\r\n  switch (action.type) {\r\n    case types.IMAGE_CHANGED:\r\n      return {\r\n        data: action.data,\r\n        name: action.name || state.name,\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst reducer = combineReducers({\r\n  image: canvasReducer,\r\n  colors: colorsReducer,\r\n  instruments: instrumentsReducer\r\n})\r\n\r\nexport default reducer\r\n","import React, { PureComponent } from 'react'\r\n\r\nimport './App.css'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport FileMenu from '../FileMenu/FileMenuContainer'\r\nimport Canvas from '../Canvas/Canvas'\r\nimport NavBar from '../NavBar/NavBar'\r\nimport Clipboard from '../Clipboard/Clipboard'\r\nimport Image from '../Image/Image'\r\nimport Instruments from '../instruments/Instruments'\r\nimport Colors from '../Colors/ColorsContainer'\r\n\r\nimport { openFile, createFile, paste, download } from './actions'\r\n\r\nclass App extends PureComponent {\r\n  render () {\r\n    return (\r\n      <React.Fragment>\r\n        <FileMenu\r\n          onDownload={() => download(this.props.downloadName)}\r\n          onFileCreate={this.props.onFileCreate}\r\n          onFileOpen={this.props.onFileOpen}\r\n        />\r\n        <NavBar>\r\n          <Clipboard\r\n            onPasteClick={this.props.onClipboardPasteClick}\r\n            disabled={this.props.clipboardDisabled}\r\n            footer='Буфер обмена'\r\n          />\r\n          <Image footer='Изображение' />\r\n          <Instruments footer='Инструменты' />\r\n          <Colors footer='Цвета' />\r\n        </NavBar>\r\n        <Canvas\r\n          onCanvasRef={this.handleCanvasRef}\r\n        />\r\n      </React.Fragment>\r\n    )\r\n  }\r\n  componentDidMount () {\r\n    document.addEventListener('paste', this.props.onPaste)\r\n  }\r\n  componentWillUnmount () {\r\n    document.removeEventListener('paste', this.props.onPaste)\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  downloadName: state.image.name\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n  onFileCreate: () => dispatch(createFile()),\r\n  onFileOpen: e => dispatch(openFile(e)),\r\n  onPaste: e => dispatch(paste(e))\r\n})\r\n\r\nexport { default as rootReducer } from './reducer'\r\nexport default connect(mapStateToProps, mapDispatchToProps)(App)\r\n","import React, { StrictMode } from 'react'\r\nimport { render } from 'react-dom'\r\nimport { Provider } from 'react-redux'\r\nimport { createStore, applyMiddleware } from 'redux'\r\nimport thunk from 'redux-thunk'\r\n\r\nimport Paint, { rootReducer } from './components/App/App'\r\n\r\nconst store = createStore(rootReducer, applyMiddleware(thunk))\r\n\r\nrender(\r\n  <StrictMode>\r\n    <Provider store={store}>\r\n      <Paint />\r\n    </Provider>\r\n  </StrictMode>,\r\n  document.getElementById('root')\r\n)\r\n"],"sourceRoot":""}