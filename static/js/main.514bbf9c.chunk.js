(window.webpackJsonppaint=window.webpackJsonppaint||[]).push([[0],Array(22).concat([function(e,t,n){e.exports=n(55)},,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(14),i=n(6),c=n(11),s=n(21),l=n(1),u=n(2),h=n(4),d=n(3),p=n(5),g=(n(32),n(33),n(8)),f=n.n(g);var m=function(e){return!!e&&!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)};function v(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function w(e){var t=e.r,n=e.g,o=e.b;return"#"+v(t)+v(n)+v(o)}function C(e,t,n,o,a){for(var r=Math.abs(n-e),i=Math.abs(o-t),c=e<n?1:-1,s=t<o?1:-1,l=r-i;a(e,t),e!==n||t!==o;){var u=2*l;u>-i&&(l-=i,e+=c),u<r&&(l+=r,t+=s)}}function b(e,t){var n=e.getBoundingClientRect(),o=n.top,a=n.left,r=[t.clientX,t.clientY],i=r[0],c=r[1];return[Math.floor(i-a),Math.floor(c-o)]}n(34);var D=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).element=void 0,n.element=document.createElement("div"),n.element.classList.add("modal"),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return Object(r.createPortal)(this.props.children,this.element)}},{key:"componentDidMount",value:function(){t.root&&t.root.appendChild(this.element)}},{key:"componentWillUnmount",value:function(){t.root&&t.root.removeChild(this.element)}}]),t}(o.PureComponent);D.root=document.getElementById("modal-root");n(35);var E,x,O=function(e){return a.a.createElement("div",{className:"about"},a.a.createElement("button",{className:"about-close-button",onClick:e.onClose}),a.a.createElement("p",null,"Greetings, stranger."),a.a.createElement("div",null,"Icons made by"," ",a.a.createElement("a",{href:"https://www.flaticon.com/authors/good-ware",title:"Good Ware"},"Good Ware"),","," ",a.a.createElement("a",{href:"https://www.flaticon.com/authors/smashicons",title:"Smashicons"},"Smashicons"),","," ",a.a.createElement("a",{href:"https://www.flaticon.com/authors/pixel-buddha",title:"Pixel Buddha"},"Pixel Buddha"),","," ",a.a.createElement("a",{href:"http://www.freepik.com",title:"Freepik"},"Freepik"),","," ",a.a.createElement("a",{href:"https://www.flaticon.com/authors/dimitry-miroliubov",title:"Dimitry Miroliubov"},"Dimitry Miroliubov")," ","from"," ",a.a.createElement("a",{href:"https://www.flaticon.com/",title:"Flaticon"},"www.flaticon.com")," ","is licensed by"," ",a.a.createElement("a",{href:"http://creativecommons.org/licenses/by/3.0/",title:"Creative Commons BY 3.0"},"CC 3.0 BY")))},y=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).menu=void 0,n.clickOutsideListener=void 0,n.toggleMenu=function(){return n.setState(function(e){return{menuOpen:!e.menuOpen}})},n.closeMenu=function(){return n.setState({menuOpen:!1})},n.openAbout=function(){return n.setState({aboutOpen:!0})},n.closeAbout=function(){return n.setState({aboutOpen:!1})},n.menu=Object(o.createRef)(),n.state={menuOpen:!1,aboutOpen:!1},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{ref:this.menu,className:f()("file-menu",{"file-menu_open":this.state.menuOpen})},a.a.createElement("button",{className:"file-menu-button",onClick:this.toggleMenu},"File"),a.a.createElement("nav",{className:"file-menu-items",onClick:this.closeMenu},a.a.createElement("button",{className:"file-menu-item",onClick:this.props.onFileCreate},"Create"),a.a.createElement("label",{className:"file-menu-item"},"Open",a.a.createElement("input",{type:"file",className:"file-menu-item",accept:"image/*",onChange:this.props.onFileOpen})),a.a.createElement("button",{className:"file-menu-item",onClick:this.props.onDownload},"Save"),a.a.createElement("button",{className:"file-menu-item",onClick:this.openAbout},"About...")),this.state.aboutOpen&&a.a.createElement(D,null,a.a.createElement(O,{onClose:this.closeAbout})))}},{key:"componentDidMount",value:function(){this.menu.current&&(this.clickOutsideListener=function(e,t){var n=function(n){e.contains(n.target)||m(e)&&t(n)};return document.addEventListener("click",n),n}(this.menu.current,this.closeMenu))}},{key:"componentWillUnmount",value:function(){var e;this.clickOutsideListener&&(e=this.clickOutsideListener,document.removeEventListener("click",e))}}]),t}(o.PureComponent);!function(e){e[e.addColor=0]="addColor",e[e.selectColor=1]="selectColor",e[e.changeActiveColor=2]="changeActiveColor",e[e.changeInstrument=3]="changeInstrument",e[e.changeImage=4]="changeImage"}(E||(E={})),function(e){e.primary="primary",e.secondary="secondary"}(x||(x={}));var z,j=function(e){return{type:E.selectColor,index:e}};!function(e){e.pen="pen",e.fill="fill",e.text="text",e.eraser="eraser",e.dropper="dropper",e.zoom="zoom",e.selection="selection"}(z||(z={}));var R,k=function(e){return{type:E.changeInstrument,instrument:e}},M=document.createElement("canvas"),P=M.getContext("2d",{alpha:!1});if(!P)throw new Error("Coudn't acquire context");var I=function(e){return function(t,n){M.width=e.width,M.height=e.height,P.putImageData(e,0,0),t({type:E.changeImage,data:e})}},S=function(){P.fillStyle="#FFFFFF",P.fillRect(0,0,M.width,M.height)},L=n(9);n(36),n(37);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(n,!0).forEach(function(t){Object(L.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Y,U,q,F=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).resizing=!1,n.preventContextMenu=!1,n.resizerElement=Object(o.createRef)(),n.handlePointerDown=function(e){if(!n.resizerElement.current)throw new Error("The ref contains no resizer element");switch(e.button){case 0:return void(n.resizerElement.current.contains(e.target)&&(n.resizing=!0,n.props.onResizeStart(e)));case 2:n.resizing=!1,n.props.onResizeCancel(e)}},n.handlePointerUp=function(e){n.resizing&&(n.props.onResizeEnd(e),n.resizing=!1)},n.handlePointerMove=function(e){if(n.resizing)switch(e.buttons){case 1:n.props.onResizeMove(e);break;case 2:case 3:n.resizing=!1,n.props.onResizeCancel(e),n.preventContextMenu=!0}},n.handlePointerCancel=function(e){n.resizing&&(n.resizing=!1,n.props.onResizeCancel(e))},n.handleDragStart=function(e){e.preventDefault()},n.handleContextMenu=function(e){n.preventContextMenu&&(e.preventDefault(),n.preventContextMenu=!1)},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"resizer-outer "+(this.props.className||""),style:X({},this.props.outerStyle),ref:this.resizerElement},a.a.createElement("div",{className:"resizer-inner",style:X({},this.props.innerStyle)}))}},{key:"componentDidMount",value:function(){document.addEventListener("pointerdown",this.handlePointerDown,{passive:!0}),document.addEventListener("pointermove",this.handlePointerMove,{passive:!0}),document.addEventListener("pointerup",this.handlePointerUp,{passive:!0}),document.addEventListener("pointercancel",this.handlePointerCancel,{passive:!0}),window.addEventListener("blur",this.handlePointerCancel,{passive:!0}),document.addEventListener("contextmenu",this.handleContextMenu),document.addEventListener("dragstart",this.handleDragStart)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("pointerdown",this.handlePointerDown),document.removeEventListener("pointermove",this.handlePointerMove),document.removeEventListener("pointerup",this.handlePointerUp),document.removeEventListener("pointercancel",this.handlePointerCancel),window.removeEventListener("blur",this.handlePointerCancel),document.removeEventListener("contextmenu",this.handleContextMenu),document.removeEventListener("dragstart",this.handleDragStart)}}]),t}(o.Component);!function(e){e.n="n",e.ne="ne",e.e="e",e.se="se",e.s="s",e.sw="sw",e.w="w",e.nw="nw"}(U||(U={})),function(e){e[e.canvas=0]="canvas",e[e.selection=1]="selection"}(q||(q={}));var T=(Y={},Object(L.a)(Y,q.canvas,[U.e,U.se,U.s]),Object(L.a)(Y,q.selection,[U.n,U.ne,U.e,U.se,U.s,U.sw,U.w,U.nw]),Y),W=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).resizeRect=Object(o.createRef)(),n.state={resizing:!1,resizeTop:n.props.top,resizeLeft:n.props.left,resizeWidth:n.props.width,resizeHeight:n.props.height},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:f()("resizer",{resizer_resizing:this.state.resizing,"resizer_hide-border":this.props.hideBorderOnResizing}),ref:this.resizeRect,style:{width:"".concat(this.state.resizing?this.state.resizeWidth:this.props.width,"px"),height:"".concat(this.state.resizing?this.state.resizeHeight:this.props.height,"px"),top:"".concat(this.state.resizing?this.state.resizeTop:this.props.top,"px"),left:"".concat(this.state.resizing?this.state.resizeLeft:this.props.left,"px")}},T[this.props.mode].map(function(t){return a.a.createElement(F,{onResizeStart:function(t){return e.onResizeStart()},onResizeMove:function(n){return e.onResizeMove(t,n)},onResizeEnd:function(t){return e.onResizeEnd()},onResizeCancel:function(t){return e.onResizeCancel()},key:"".concat(t,"-resizer-point"),className:t})}))}},{key:"onResizeStart",value:function(){}},{key:"onResizeMove",value:function(e,t){if(!this.resizeRect.current)throw new Error("The ref contains no rect element");var n=this.resizeRect.current.getBoundingClientRect(),o=n.top,a=n.left,r=n.bottom,i=n.right,c=this.resizeRect.current.parentNode.getBoundingClientRect(),s=[o+window.pageYOffset,a+window.pageXOffset,r+window.pageYOffset,i+window.pageXOffset];o=s[0],a=s[1],r=s[2],i=s[3];var l=t.clientX+window.pageXOffset,u=t.clientY+window.pageYOffset,h={resizing:!0,resizeTop:this.props.top,resizeLeft:this.props.left,resizeWidth:this.props.width,resizeHeight:this.props.height};switch(e){case U.n:h.resizeTop=u-c.top,h.resizeHeight=this.props.height-h.resizeTop;break;case U.ne:h.resizeTop=u-c.top,h.resizeHeight=this.props.height-h.resizeTop,h.resizeWidth=l-a;break;case U.e:h.resizeWidth=l-a;break;case U.se:h.resizeHeight=u-o,h.resizeWidth=l-a;break;case U.s:h.resizeHeight=u-o;break;case U.sw:h.resizeHeight=u-o,h.resizeLeft=l-c.left,h.resizeWidth=this.props.width-h.resizeLeft;break;case U.w:h.resizeLeft=l-c.left,h.resizeWidth=this.props.width-h.resizeLeft;break;case U.nw:h.resizeTop=u-c.top,h.resizeHeight=this.props.height-h.resizeTop,h.resizeLeft=l-c.left,h.resizeWidth=this.props.width-h.resizeLeft}h.resizeTop=Math.round(h.resizeTop+window.pageYOffset>this.props.top+this.props.height-1?this.props.height+this.props.top-1:h.resizeTop),h.resizeLeft=Math.round(h.resizeLeft+window.pageXOffset>this.props.left+this.props.width-1?this.props.width+this.props.left-1:h.resizeLeft),h.resizeWidth=Math.round(h.resizeWidth>0?h.resizeWidth:1),h.resizeHeight=Math.round(h.resizeHeight>0?h.resizeHeight:1),this.props.onResizing&&this.props.onResizing(h.resizeTop,h.resizeLeft,h.resizeWidth,h.resizeHeight),this.setState(h)}},{key:"onResizeEnd",value:function(){this.props.onResizeEnd&&this.props.onResizeEnd(this.state.resizeTop,this.state.resizeLeft,this.state.resizeWidth,this.state.resizeHeight),this.setState({resizing:!1})}},{key:"onResizeCancel",value:function(){this.setState({resizing:!1,resizeWidth:this.props.width,resizeHeight:this.props.height})}}],[{key:"getDerivedStateFromProps",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{resizing:!1};return t.resizing?null:{resizeTop:e.top,resizeLeft:e.left,resizeWidth:e.width,resizeHeight:e.height}}}]),t}(o.PureComponent),A=n(15),B=(n(38),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).preventContextMenu=!1,n.onResizeEnd=function(e,t,o,a){n.props.onResizeEnd({top:n.props.top+e,left:n.props.left+t,width:o,height:a})},n.onResizing=function(e,t,o,a){n.props.onResizing({top:n.props.top+e,left:n.props.left+t,width:o,height:a})},n.handlePointerDown=function(e){e.target===e.currentTarget&&n.setState({moving:!0,startX:e.clientX+window.pageXOffset,startY:e.clientY+window.pageYOffset})},n.handleDocumentPointerMove=function(e){if(n.state.moving&&null!==n.state.startX&&null!==n.state.startY&&n.props.onMoving)switch(e.buttons){case 1:var t=n.props,o=(t.onResizeEnd,t.onResizing,t.onMoveEnd,t.onMoving,Object(A.a)(t,["onResizeEnd","onResizing","onMoveEnd","onMoving"]));o.top=n.state.top+(e.clientY+window.pageYOffset-n.state.startY),o.left=n.state.left+(e.clientX+window.pageXOffset-n.state.startX),n.props.onMoving(o);break;case 2:case 3:n.props.onMoving({top:n.state.top,left:n.state.left,width:n.props.width,height:n.props.height}),n.setState({moving:!1}),n.preventContextMenu=!0}},n.handleDocumentPointerUp=function(e){if(n.state.moving&&null!==n.state.startX&&null!==n.state.startY&&n.props.onMoving){var t=n.props,o=(t.onResizeEnd,t.onResizing,t.onMoveEnd,t.onMoving,Object(A.a)(t,["onResizeEnd","onResizing","onMoveEnd","onMoving"]));o.top=n.state.top+(e.clientY+window.pageYOffset-n.state.startY),o.left=n.state.left+(e.clientX+window.pageXOffset-n.state.startX),n.props.onMoveEnd(o)}n.setState({moving:!1,startX:null,startY:null})},n.handleContextMenu=function(e){n.preventContextMenu&&(e.preventDefault(),n.preventContextMenu=!1)},n.state={moving:!1,startX:null,startY:null,left:n.props.left,top:n.props.top},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onResizeEnd,e.onResizing,e.onMoveEnd,e.onMoving,Object(A.a)(e,["onResizeEnd","onResizing","onMoveEnd","onMoving"]));return a.a.createElement("div",{style:this.props,onPointerDown:this.handlePointerDown,className:"movable-selection"},a.a.createElement(W,Object.assign({mode:q.selection},t,{onResizing:this.onResizing,onResizeEnd:this.onResizeEnd,top:0,left:0})))}},{key:"componentDidMount",value:function(){document.addEventListener("pointermove",this.handleDocumentPointerMove,{passive:!0}),document.addEventListener("pointerup",this.handleDocumentPointerUp,{passive:!0}),document.addEventListener("contextmenu",this.handleContextMenu)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("pointermove",this.handleDocumentPointerUp),document.removeEventListener("pointerup",this.handleDocumentPointerUp),document.removeEventListener("contextmenu",this.handleContextMenu)}}]),t}(o.PureComponent));B.getDerivedStateFromProps=function(e,t){return t.moving?null:{top:e.top,left:e.left}};var H=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).canvasRef=Object(o.createRef)(),n.oldCtx=void 0,n.newCtx=void 0,n.backgroundColor=void 0,n.handleResizing=function(e){e.top,e.left,e.width,e.height},n.handleResizeEnd=function(e){var t=e.top,o=e.left,a=e.width,r=e.height;if(!n.newCtx)throw new Error("Coudn't acquire context");n.backgroundColor||(n.backgroundColor=n.props.secondaryColor,n.newCtx.fillStyle="rgb(".concat(n.backgroundColor.r,", ").concat(n.backgroundColor.g,", ").concat(n.backgroundColor.b,")")),n.props.onCoordsChanged({top:t,left:o,width:a,height:r}),n.props.onImageChanged(n.newCtx.getImageData(0,0,n.newCtx.canvas.width,n.newCtx.canvas.height))},n.handleMoving=function(e){var t=e.top,o=e.left,a=e.width,r=e.height;if(!n.newCtx)throw new Error("Coudn't acquire context");n.backgroundColor||(n.backgroundColor=n.props.secondaryColor,n.newCtx.fillStyle="rgb(".concat(n.backgroundColor.r,", ").concat(n.backgroundColor.g,", ").concat(n.backgroundColor.b,")")),n.props.onCoordsChanged({top:t,left:o,width:a,height:r})},n.handleMoveEnd=function(e){e.top,e.left,e.width,e.height;if(!n.newCtx)throw new Error("Coudn't acquire context");n.props.onImageChanged(n.newCtx.getImageData(0,0,n.newCtx.canvas.width,n.newCtx.canvas.height))},n.redrawCanvas=function(e){if(!n.newCtx||!n.oldCtx)throw new Error("Coudn't acquire context");e&&(n.oldCtx.canvas.width=n.props.imageData.width,n.oldCtx.canvas.height=n.props.imageData.height,n.newCtx.canvas.width=n.props.imageData.width,n.newCtx.canvas.height=n.props.imageData.height,n.newCtx.imageSmoothingEnabled=!1,n.oldCtx.putImageData(n.props.imageData,0,0)),n.newCtx.drawImage(n.oldCtx.canvas,0,0),n.props.coords&&n.state.originCoords&&(n.newCtx.fillRect(n.state.originCoords.left,n.state.originCoords.top,n.state.originCoords.width,n.state.originCoords.height),n.newCtx.drawImage(n.oldCtx.canvas,n.state.originCoords.left,n.state.originCoords.top,n.state.originCoords.width,n.state.originCoords.height,n.props.coords.left,n.props.coords.top,n.props.coords.width,n.props.coords.height))},n.state={originCoords:n.props.coords},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement(o.Fragment,null,a.a.createElement("canvas",{ref:this.canvasRef,onPointerDown:function(t){return t.target===t.currentTarget&&e.props.onClickOutside(t)}}),a.a.createElement(B,Object.assign({},this.props.coords,{onResizing:this.handleResizing,onResizeEnd:this.handleResizeEnd,onMoving:this.handleMoving,onMoveEnd:this.handleMoveEnd,hideBorderOnResizing:!1})))}},{key:"componentDidMount",value:function(){var e=document.createElement("canvas");if(e.width=this.props.imageData.width,e.height=this.props.imageData.height,this.oldCtx=e.getContext("2d")||void 0,!this.oldCtx)throw new Error("Coudn't acquire context");if(this.oldCtx.putImageData(this.props.imageData,0,0),!this.canvasRef.current)throw new Error("Canvas didn't mount");if(this.canvasRef.current.width=this.props.imageData.width,this.canvasRef.current.height=this.props.imageData.height,this.newCtx=this.canvasRef.current.getContext("2d")||void 0,!this.newCtx)throw new Error("Coudn't acquire context");this.newCtx.imageSmoothingEnabled=!1}},{key:"componentDidUpdate",value:function(){this.redrawCanvas(!1)}}]),t}(o.PureComponent),_=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).canvasRef=Object(o.createRef)(),n.oldCtx=void 0,n.newCtx=void 0,n.selectionCtx=void 0,n.backgroundColor=void 0,n.resized=void 0,n.updateOld=void 0,n.updateOldCanvas=function(){if(!n.oldCtx){var e=document.createElement("canvas");n.oldCtx=e.getContext("2d")||void 0}if(!n.oldCtx)throw new Error("Coudn't acquire context");n.oldCtx.canvas.width=n.props.imageData.width,n.oldCtx.canvas.height=n.props.imageData.height,n.oldCtx.putImageData(n.props.imageData,0,0)},n.updateSelectionCanvas=function(){if(!n.selectionCtx){var e=document.createElement("canvas");n.selectionCtx=e.getContext("2d")||void 0}if(!n.selectionCtx)throw new Error("Coudn't acquire context");n.selectionCtx.canvas.width=n.props.selectionImageData.width,n.selectionCtx.canvas.height=n.props.selectionImageData.height,n.selectionCtx.putImageData(n.props.selectionImageData,0,0)},n.updateNewCanvas=function(){if(!n.selectionCtx||!n.oldCtx)throw new Error("Coudn't acquire context");if(!n.newCtx){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");if(n.canvasRef.current.width=n.oldCtx.canvas.width,n.canvasRef.current.height=n.oldCtx.canvas.height,n.newCtx=n.canvasRef.current.getContext("2d")||void 0,!n.newCtx)throw new Error("Coudn't acquire context");n.newCtx.imageSmoothingEnabled=!1}n.newCtx.canvas.width===n.oldCtx.canvas.width&&n.newCtx.canvas.height===n.oldCtx.canvas.height||(n.newCtx.canvas.width=n.oldCtx.canvas.width,n.newCtx.canvas.height=n.oldCtx.canvas.height,n.newCtx.imageSmoothingEnabled=!1),n.newCtx.drawImage(n.oldCtx.canvas,0,0),n.newCtx.drawImage(n.selectionCtx.canvas,0,0,n.selectionCtx.canvas.width,n.selectionCtx.canvas.height,n.props.coords.left,n.props.coords.top,n.props.coords.width,n.props.coords.height)},n.handleResizing=function(e){e.top,e.left,e.width,e.height},n.handleResizeEnd=function(e){var t=e.top,o=e.left,a=e.width,r=e.height;if(!n.newCtx)throw new Error("Coudn't acquire context");n.backgroundColor||(n.backgroundColor=n.props.secondaryColor,n.newCtx.fillStyle="rgb(".concat(n.backgroundColor.r,", ").concat(n.backgroundColor.g,", ").concat(n.backgroundColor.b,")")),n.updateOld=!1,n.props.changeSelection({coords:{top:t,left:o,width:a,height:r},imageData:n.props.selectionImageData}),n.updateOld=!1,n.props.changeImage(n.newCtx.getImageData(0,0,n.newCtx.canvas.width,n.newCtx.canvas.height))},n.handleMoving=function(e){var t=e.top,o=e.left,a=e.width,r=e.height;if(!n.backgroundColor){if(n.backgroundColor=n.props.secondaryColor,!n.newCtx)throw new Error("Coudn't acquire context");n.newCtx.fillStyle="rgb(".concat(n.backgroundColor.r,", ").concat(n.backgroundColor.g,", ").concat(n.backgroundColor.b,")")}n.updateOld=!1,n.props.changeSelection({coords:{top:t,left:o,width:a,height:r},imageData:n.props.selectionImageData})},n.handleMoveEnd=function(e){e.top,e.left,e.width,e.height;if(!n.newCtx)throw new Error("Coudn't acquire context");n.updateOld=!1,n.props.changeImage(n.newCtx.getImageData(0,0,n.newCtx.canvas.width,n.newCtx.canvas.height))},n.resizeCanvasToFitPasted=function(){var e=document.createElement("canvas");e.width=Math.max(n.props.imageData.width,n.props.selectionImageData.width),e.height=Math.max(n.props.imageData.height,n.props.selectionImageData.height);var t=e.getContext("2d");if(!t)throw new Error("Coudn't acquire context");t.fillStyle="rgb(".concat(n.props.secondaryColor.r,", ").concat(n.props.secondaryColor.g,", ").concat(n.props.secondaryColor.b,")"),t.fillRect(0,0,t.canvas.width,t.canvas.height),t.putImageData(n.props.imageData,0,0),n.props.changeImage(t.getImageData(0,0,t.canvas.width,t.canvas.height))},n.canvasRef=Object(o.createRef)(),(n.props.imageData.width<n.props.selectionImageData.width||n.props.imageData.height<n.props.selectionImageData.height)&&(n.resized=!0,n.resizeCanvasToFitPasted(),n.props.changeSelection({coords:n.props.coords,imageData:n.props.selectionImageData}),n.updateOld=!0),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement(o.Fragment,null,a.a.createElement("canvas",{ref:this.canvasRef,onPointerDown:function(t){return t.target===t.currentTarget&&e.props.onClickOutside(t)}}),a.a.createElement(B,Object.assign({},this.props.coords,{onResizing:this.handleResizing,onResizeEnd:this.handleResizeEnd,onMoving:this.handleMoving,onMoveEnd:this.handleMoveEnd,hideBorderOnResizing:!1})))}},{key:"componentDidMount",value:function(){if(this.updateOldCanvas(),this.updateSelectionCanvas(),this.updateNewCanvas(),!this.newCtx)throw new Error("Coudn't acquire context");this.props.changeImage(this.newCtx.getImageData(0,0,this.newCtx.canvas.width,this.newCtx.canvas.height))}},{key:"componentDidUpdate",value:function(e){if(this.updateOld&&this.updateOldCanvas(),this.props.selectionImageData!==e.selectionImageData&&this.updateSelectionCanvas(),this.updateNewCanvas(),!this.newCtx)throw new Error("Coudn't acquire context");if(this.resized)return this.resized=!1,this.props.changeImage(this.newCtx.getImageData(0,0,this.newCtx.canvas.width,this.newCtx.canvas.height)),void(this.updateOld=!1);this.updateOld=!0,this.props.selectionImageData!==e.selectionImageData&&this.props.changeImage(this.newCtx.getImageData(0,0,this.newCtx.canvas.width,this.newCtx.canvas.height))}}]),t}(o.PureComponent),G=(n(39),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).containerRef=Object(o.createRef)(),n.backgroundColor=null,n.preventContextMenu=!1,n.handlePointerDown=function(e,t){if(e.target===e.currentTarget){if(n.props.changeSelection({}),!n.containerRef.current)throw new Error("Couldn't get ref to div");var o=n.containerRef.current.getBoundingClientRect(),a=o.top,r=o.left,i=o.bottom,c=o.right,s=[a+window.pageYOffset,r+window.pageXOffset,i+window.pageYOffset,c+window.pageXOffset];a=s[0],r=s[1],i=s[2],c=s[3];var l=e.clientX+window.pageXOffset,u=e.clientY+window.pageYOffset,h=[Math.ceil(u-a),Math.ceil(l-r)];a=h[0],r=h[1],n.setState({selecting:!0,selectingY:a,selectingX:r,selectingCoords:null})}},n.handleDocumentPointerMove=function(e){if(n.state.selecting)switch(e.buttons){case 1:n.setState(function(t){if(!n.containerRef.current)throw new Error("Couldn't get ref to div");var o=n.containerRef.current.getBoundingClientRect(),a=o.top,r=o.left,i=o.bottom,c=o.right,s=[a+window.pageYOffset,r+window.pageXOffset,i+window.pageYOffset,c+window.pageXOffset];a=s[0],r=s[1],i=s[2],c=s[3];var l=e.clientX+window.pageXOffset,u=e.clientY+window.pageYOffset,h=[Math.trunc(u-a),Math.trunc(l-r)],d=h[0],p=h[1],g=[Math.max(0,Math.min(d,n.props.imageData.height)),Math.max(0,Math.min(p,n.props.imageData.width))];if(d=g[0],p=g[1],"number"!==typeof t.selectingX||"number"!==typeof t.selectingY)throw new Error("No coordinates in the state");return{selectingCoords:{top:Math.min(t.selectingY,d),left:Math.min(t.selectingX,p),width:Math.max(Math.max(t.selectingX,p)-Math.min(t.selectingX,p),0),height:Math.max(Math.max(t.selectingY,d)-Math.min(t.selectingY,d),0)}}});break;case 2:case 3:n.setState({selecting:!1,selectingX:null,selectingY:null,selectingCoords:null}),n.preventContextMenu=!0}},n.handleDocumentPointerUp=function(e){n.setState(function(e){var t=null;return e.selecting&&e.selectingCoords?(e.selectingCoords.width>0&&e.selectingCoords.height>0&&(n.props.changeSelection({coords:e.selectingCoords,imageData:null}),t=e.selectingCoords),{selecting:!1,selectingX:null,selectingY:null,selectingCoords:null,selectionOriginCoords:t}):{selecting:!1,selectingX:null,selectingY:null,selectingCoords:e.selectingCoords,selectionOriginCoords:e.selectionOriginCoords}})},n.handleContextMenu=function(e){n.preventContextMenu&&(e.preventDefault(),n.preventContextMenu=!1)},n.state={selecting:!1,selectingX:null,selectingY:null,selectingCoords:null,selectionOriginCoords:null},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e,t=this;if(this.state.selecting&&this.state.selectingCoords)e=a.a.createElement("div",{className:"selecting",style:{top:"".concat(this.state.selectingCoords.top,"px"),left:"".concat(this.state.selectingCoords.left,"px"),width:"".concat(this.state.selectingCoords.width,"px"),height:"".concat(this.state.selectingCoords.height,"px")}});else if(this.props.selectionImageData){if(!this.props.selectionCoords)throw new Error("No selection coords were passed");e=a.a.createElement(_,{onClickOutside:function(e){return t.handlePointerDown(e,!0)},imageData:this.props.imageData,coords:this.props.selectionCoords,selectionImageData:this.props.selectionImageData,changeSelection:this.props.changeSelection,changeImage:function(e){return t.props.changeImage(e)},secondaryColor:this.props.secondaryColor})}else e=this.props.selectionCoords?a.a.createElement(H,{onClickOutside:function(e){return t.handlePointerDown(e,!0)},imageData:this.props.imageData,coords:this.props.selectionCoords,onCoordsChanged:function(e){return t.props.changeSelection({coords:e})},onImageChanged:function(e){return t.props.changeImage(e)},secondaryColor:this.props.secondaryColor}):null;return a.a.createElement("div",{className:"selection",onPointerDown:this.handlePointerDown,ref:this.containerRef},e)}},{key:"componentDidMount",value:function(){document.addEventListener("pointermove",this.handleDocumentPointerMove,{passive:!0}),document.addEventListener("pointerup",this.handleDocumentPointerUp,{passive:!0}),document.addEventListener("contextmenu",this.handleContextMenu)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("pointermove",this.handleDocumentPointerMove),document.removeEventListener("pointerup",this.handleDocumentPointerUp),document.removeEventListener("contextmenu",this.handleContextMenu)}}]),t}(o.PureComponent)),J=Object(i.b)(function(e){return{imageData:e.image.data,selectionCoords:e.instruments.selection?e.instruments.selection.coords:void 0,selectionImageData:e.instruments.selection?e.instruments.selection.imageData:void 0,secondaryColor:e.colors.list[e.colors.secondary]}},function(e){return{changeSelection:function(t){var n=t.coords,o=t.imageData;return e(function(e){var t=e.coords,n=e.imageData;return{type:E.changeInstrument,instrument:z.selection,selection:{coords:t,imageData:n}}}({coords:n,imageData:o}))},changeImage:function(t){return e(I(t))}}})(G),V=n(7),Z=(n(40),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).canvasRef=Object(o.createRef)(),n.ctx=void 0,n.isDrawing=!1,n.prevX=0,n.prevY=0,n.preventContextMenu=!1,n.handlePointerDown=function(e){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");n.isDrawing=!0;var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2),a=o[0],r=o[1];n.beginDrawing(a,r)},n.handlePointerMove=function(e){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");if(n.isDrawing&&3!==e.buttons){var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2),a=o[0],r=o[1];n.continueDrawing(a,r)}},n.handlePointerEnter=function(e){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");if(1===e.buttons&&n.isDrawing){var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2),a=o[0],r=o[1];n.continueDrawing(a,r)}else n.isDrawing=!1},n.handlePointerLeave=function(e){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");if(n.isDrawing){var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2),a=o[0],r=o[1];n.continueDrawing(a,r)}},n.handleDocumentPointerUp=function(){n.isDrawing&&(n.isDrawing=!1,n.endDrawing())},n.handleDocumentPointerMove=function(e){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");if(e.target!==n.canvasRef.current){var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2);n.prevX=o[0],n.prevY=o[1]}n.isDrawing&&2===e.button&&(n.preventContextMenu=!0,n.cancelDrawing())},n.handleDocumentContextMenu=function(e){n.isDrawing&&(e.preventDefault(),n.isDrawing=!1)},n.handleDocumentSelectStart=function(e){n.isDrawing&&e.preventDefault()},n.beginDrawing=function(e,t){if(!n.ctx)throw new Error("Coudn't acquire context");var o=n.props.color,a=o.r,r=o.g,i=o.b;n.ctx.fillStyle="rgb(".concat(a,",").concat(r,",").concat(i,")"),n.ctx.fillRect(e,t,1,1);var c=[e,t];n.prevX=c[0],n.prevY=c[1]},n.continueDrawing=function(e,t){C(n.prevX,n.prevY,e,t,n.drawPoint);var o=[e,t];n.prevX=o[0],n.prevY=o[1]},n.endDrawing=function(){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");if(!n.ctx)throw new Error("Coudn't acquire context");n.props.changeImage(n.ctx.getImageData(0,0,n.canvasRef.current.width,n.canvasRef.current.height))},n.cancelDrawing=function(){if(!n.ctx)throw new Error("Coudn't acquire context");n.ctx.putImageData(n.props.imageData,0,0)},n.drawPoint=function(e,t){if(!n.ctx)throw new Error("Coudn't acquire context");n.ctx.fillRect(e,t,1,1)},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("canvas",{className:"pen-canvas",ref:this.canvasRef,width:this.props.imageData?this.props.imageData.width:0,height:this.props.imageData?this.props.imageData.height:0,onPointerDown:this.handlePointerDown,onPointerMove:this.handlePointerMove,onPointerEnter:this.handlePointerEnter,onPointerLeave:this.handlePointerLeave})}},{key:"componentDidMount",value:function(){if(!this.canvasRef.current)throw new Error("Canvas didn't mount");if(this.ctx=this.canvasRef.current.getContext("2d")||void 0,!this.ctx)throw new Error("Coudn't acquire context");null!=this.props.imageData&&this.ctx.putImageData(this.props.imageData,0,0),document.addEventListener("pointerup",this.handleDocumentPointerUp),document.addEventListener("pointermove",this.handleDocumentPointerMove),document.addEventListener("selectstart",this.handleDocumentSelectStart),document.addEventListener("contextmenu",this.handleDocumentContextMenu)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("pointerup",this.handleDocumentPointerUp),document.removeEventListener("pointermove",this.handleDocumentPointerMove),document.removeEventListener("selectstart",this.handleDocumentSelectStart),document.removeEventListener("contextmenu",this.handleDocumentContextMenu)}},{key:"componentDidUpdate",value:function(){if(!this.ctx)throw new Error("Coudn't acquire context");null!=this.props.imageData&&this.ctx.putImageData(this.props.imageData,0,0)}}]),t}(o.PureComponent)),K=Object(i.b)(function(e){return{color:e.colors.list[e.colors.primary],imageData:e.image.data}},function(e){return{changeImage:function(t){return e(I(t))}}})(Z),Q=(n(41),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).canvasRef=void 0,n.ctx=void 0,n.handleMouseDown=function(e){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2),a=o[0],r=o[1];if(!n.ctx)throw new Error("Coudn't acquire context");var i=n.ctx.getImageData(0,0,n.canvasRef.current.width,n.canvasRef.current.height);n.floodFill(i,a,r,{r:i.data[4*(r*i.width+a)],g:i.data[4*(r*i.width+a)+1],b:i.data[4*(r*i.width+a)+2]},n.props.color),n.props.changeImage(i)},n.floodFill=function(e,t,n,o,a){var r=o.r,i=o.g,c=o.b,s=a.r,l=a.g,u=a.b,h=4*(n*e.width+t);if(r===e.data[h]&&i===e.data[h+1]&&c===e.data[h+2]&&(r!==s||i!==l||c!==u)){var d=[];for(e.data[h]=s,e.data[h+1]=l,e.data[h+2]=u,d.push([t,n]);0!==d.length;){var p=d.shift(),g=4*(p[1]*e.width+p[0]);p[0]>0&&r===e.data[g-4]&&i===e.data[g-3]&&c===e.data[g-2]&&(e.data[g-4]=s,e.data[g-3]=l,e.data[g-2]=u,d.push([p[0]-1,p[1]])),p[0]<e.width-1&&r===e.data[g+4]&&i===e.data[g+5]&&c===e.data[g+6]&&(e.data[g+4]=s,e.data[g+5]=l,e.data[g+6]=u,d.push([p[0]+1,p[1]])),p[1]>0&&r===e.data[g-4*e.width]&&i===e.data[g-4*e.width+1]&&c===e.data[g-4*e.width+2]&&(e.data[g-4*e.width]=s,e.data[g-4*e.width+1]=l,e.data[g-4*e.width+2]=u,d.push([p[0],p[1]-1])),p[1]<e.height-1&&r===e.data[g+4*e.width]&&i===e.data[g+4*e.width+1]&&c===e.data[g+4*e.width+2]&&(e.data[g+4*e.width]=s,e.data[g+4*e.width+1]=l,e.data[g+4*e.width+2]=u,d.push([p[0],p[1]+1]))}}},n.canvasRef=Object(o.createRef)(),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("canvas",{className:"fill-canvas",ref:this.canvasRef,width:this.props.imageData?this.props.imageData.width:0,height:this.props.imageData?this.props.imageData.height:0,onMouseDown:this.handleMouseDown})}},{key:"componentDidMount",value:function(){if(!this.canvasRef.current)throw new Error("Canvas didn't mount");if(this.ctx=this.canvasRef.current.getContext("2d")||void 0,!this.ctx)throw new Error("Coudn't acquire context");null!=this.props.imageData&&this.ctx.putImageData(this.props.imageData,0,0)}},{key:"componentDidUpdate",value:function(){if(!this.ctx)throw new Error("Coudn't acquire context");this.ctx.putImageData(this.props.imageData,0,0)}}]),t}(o.PureComponent)),$=Object(i.b)(function(e){return{color:e.colors.list[e.colors.primary],imageData:e.image.data}},function(e){return{changeImage:function(t){return e(I(t))}}})(Q),ee=(n(42),function(e){function t(){var e,n;Object(l.a)(this,t);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).handleClick=function(e){if(e.target&&e.target===e.currentTarget){var t=e.target.getBoundingClientRect(),o=t.top,a=t.left,r=t.bottom,i=t.right,c=[o+window.pageYOffset,a+window.pageXOffset,r+window.pageYOffset,i+window.pageXOffset];o=c[0],a=c[1],r=c[2],i=c[3];var s=e.clientX+window.pageXOffset,l=e.clientY+window.pageYOffset,u=[Math.ceil(l-o),Math.ceil(s-a)];a=u[1];var h=4*((o=u[0])*n.props.imageData.width+a);n.props.addColor({r:n.props.imageData.data[h],g:n.props.imageData.data[h+1],b:n.props.imageData.data[h+2]}),n.props.selectInstrument(z.pen)}},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"dropper",onClick:this.handleClick,style:{width:this.props.imageData.width,height:this.props.imageData.height}})}}]),t}(o.PureComponent)),te=Object(i.b)(function(e){return{imageData:e.image.data}},function(e){return{addColor:function(t){return e((n=t,function(e,t){var o=t().colors.list.findIndex(function(e){return e.r===n.r&&e.g===n.g&&e.b===n.b});e(-1===o?{type:E.addColor,value:n}:j(o))}));var n},selectInstrument:function(t){return e(k(t))}}})(ee),ne=(n(43),function(e){function t(e){var n;Object(l.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).canvasRef=Object(o.createRef)(),n.ctx=void 0,n.noCursorCtx=void 0,n.isDrawing=!1,n.prevX=0,n.prevY=0,n.preventContextMenu=!1,n.handlePointerDown=function(e){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");n.isDrawing=!0;var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2),a=o[0],r=o[1];n.drawPoint(a,r),n.beginDrawing(a,r)},n.handlePointerMove=function(e){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2),a=o[0],r=o[1];n.isDrawing&&3!==e.buttons&&n.continueDrawing(a,r),n.updateCanvas(a,r)},n.handlePointerEnter=function(e){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");if(1===e.buttons&&n.isDrawing){var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2),a=o[0],r=o[1];n.continueDrawing(a,r)}else n.isDrawing=!1},n.handlePointerLeave=function(e){if(!n.canvasRef.current)throw new Error("Canvas didn't mount");if(n.isDrawing){var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2),a=o[0],r=o[1];n.continueDrawing(a,r)}n.updateCanvas()},n.handleDocumentPointerUp=function(){n.isDrawing&&(n.isDrawing=!1,n.endDrawing())},n.handleDocumentPointerMove=function(e){if(n.canvasRef.current){if(e.target!==n.canvasRef.current){var t=b(n.canvasRef.current,e),o=Object(V.a)(t,2);n.prevX=o[0],n.prevY=o[1]}n.isDrawing&&2===e.button&&(n.preventContextMenu=!0,n.cancelDrawing())}},n.handleDocumentContextMenu=function(e){n.isDrawing&&(e.preventDefault(),n.isDrawing=!1)},n.handleDocumentSelectStart=function(e){n.isDrawing&&e.preventDefault()},n.beginDrawing=function(e,t){var o=n.props.color,a=o.r,r=o.g,i=o.b;if(!n.ctx)throw new Error("Coudn't acquire context");n.ctx.fillStyle="rgb(".concat(a,",").concat(r,",").concat(i,")"),n.drawPoint(e,t);var c=[e,t];n.prevX=c[0],n.prevY=c[1]},n.continueDrawing=function(e,t){C(n.prevX,n.prevY,e,t,n.drawPoint);var o=[e,t];n.prevX=o[0],n.prevY=o[1]},n.endDrawing=function(){n.props.changeImage(n.noCursorCtx.getImageData(0,0,n.noCursorCtx.canvas.width,n.noCursorCtx.canvas.height))},n.cancelDrawing=function(){n.noCursorCtx.putImageData(n.props.imageData,0,0)},n.drawPoint=function(e,t){n.noCursorCtx&&n.noCursorCtx.fillRect(e-n.props.thickness/2,t-n.props.thickness/2,n.props.thickness,n.props.thickness)},n.updateCanvasNoCursor=function(){if(null!=n.props.imageData){var e=[n.props.imageData.width,n.props.imageData.height];n.noCursorCtx.canvas.width=e[0],n.noCursorCtx.canvas.height=e[1];var t=n.props.color,o=t.r,a=t.g,r=t.b;n.noCursorCtx.fillStyle="rgb(".concat(o,",").concat(a,",").concat(r,")"),n.noCursorCtx.putImageData(n.props.imageData,0,0)}},n.updateCanvas=function(e,t){if(!n.ctx)throw new Error("Coudn't acquire context");n.ctx.drawImage(n.noCursorCtx.canvas,0,0),void 0!==e&&void 0!==t&&(n.ctx.fillRect(e-n.props.thickness/2,t-n.props.thickness/2,n.props.thickness,n.props.thickness),n.ctx.strokeRect(e-n.props.thickness/2+.5,t-n.props.thickness/2+.5,n.props.thickness-1,n.props.thickness-1))};var a=document.createElement("canvas").getContext("2d");if(!a)throw new Error("Coudn't acquire context");return n.noCursorCtx=a,n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("canvas",{className:"eraser-canvas",ref:this.canvasRef,width:this.props.imageData?this.props.imageData.width:0,height:this.props.imageData?this.props.imageData.height:0,onPointerDown:this.handlePointerDown,onPointerMove:this.handlePointerMove,onPointerEnter:this.handlePointerEnter,onPointerLeave:this.handlePointerLeave})}},{key:"componentDidMount",value:function(){if(!this.canvasRef.current)throw new Error("Canvas didn't mount");if(this.ctx=this.canvasRef.current.getContext("2d")||void 0,!this.ctx)throw new Error("Coudn't acquire context");var e=this.props.color,t=e.r,n=e.g,o=e.b;this.ctx.fillStyle="rgb(".concat(t,",").concat(n,",").concat(o,")"),this.ctx.strokeStyle="black",this.noCursorCtx.fillStyle="rgb(".concat(t,",").concat(n,",").concat(o,")"),this.updateCanvasNoCursor(),document.addEventListener("pointerup",this.handleDocumentPointerUp),document.addEventListener("pointermove",this.handleDocumentPointerMove),document.addEventListener("selectstart",this.handleDocumentSelectStart),document.addEventListener("contextmenu",this.handleDocumentContextMenu)}},{key:"componentDidUpdate",value:function(){var e=this.props.color,t=e.r,n=e.g,o=e.b;if(!this.ctx)throw new Error("Coudn't acquire context");this.ctx.fillStyle="rgb(".concat(t,",").concat(n,",").concat(o,")"),this.noCursorCtx.fillStyle="rgb(".concat(t,",").concat(n,",").concat(o,")"),this.updateCanvasNoCursor()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("pointerup",this.handleDocumentPointerUp),document.removeEventListener("pointermove",this.handleDocumentPointerMove),document.removeEventListener("selectstart",this.handleDocumentSelectStart),document.removeEventListener("contextmenu",this.handleDocumentContextMenu)}}]),t}(o.PureComponent)),oe={pen:K,fill:$,selection:J,dropper:te,eraser:Object(i.b)(function(e){return{color:e.colors.list[e.colors.secondary],imageData:e.image.data,thickness:8}},function(e){return{changeImage:function(t){return e(I(t))}}})(ne)},ae=Object(i.b)(function(e){return{instrument:e.instruments.instrument}})(function(e){var t=oe[e.instrument];return null!=t?a.a.createElement(t,null):null}),re=(n(44),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).canvas=Object(o.createRef)(),n.updateCanvas=function(){var e=n.canvas.current;if(null!=e&&null!=n.props.data){var t=[n.props.data.width,n.props.data.height];e.width=t[0],e.height=t[1];var o=e.getContext("2d");if(!o)throw new Error("Coudn't acquire context");o.putImageData(n.props.data,0,0)}},n.onResize=function(e,t,o,a){if(n.props.data.width!==o||n.props.data.height!==a){var r=document.createElement("canvas");r.width=o,r.height=a;var i=r.getContext("2d");if(!i)throw new Error("Coudn't acquire context");i.fillStyle="rgb(".concat(n.props.secondaryColor.r,",").concat(n.props.secondaryColor.g,",").concat(n.props.secondaryColor.b,")"),i.fillRect(0,0,o,a),i.putImageData(n.props.data,0,0),n.props.changeImage(i.getImageData(0,0,o,a))}},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"canvas-wrapper"},a.a.createElement("canvas",{ref:this.canvas,className:"canvas",width:this.props.data?this.props.data.width:0,height:this.props.data?this.props.data.height:0}),a.a.createElement("div",{className:"canvas-upper-layer",style:{width:this.props.data?this.props.data.width:0,height:this.props.data?this.props.data.height:0}},a.a.createElement(W,{mode:q.canvas,onResizeEnd:this.onResize,onResizing:this.props.disableSelection,width:this.props.data?this.props.data.width:0,height:this.props.data?this.props.data.height:0,top:0,left:0}),a.a.createElement(ae,null)))}},{key:"componentDidMount",value:function(){this.updateCanvas()}},{key:"componentDidUpdate",value:function(){this.updateCanvas()}}]),t}(o.PureComponent)),ie=Object(i.b)(function(e){return{data:e.image.data,secondaryColor:e.colors.list[e.colors.secondary]}},function(e){return{changeImage:function(t){return e(I(t))},disableSelection:function(){return e({type:E.changeInstrument,selection:null})}}})(re),ce=(n(45),function(e){return a.a.createElement("nav",{className:"navbar"},e.children)}),se=(n(46),function(e){return a.a.createElement("section",{className:"navbar-item"},e.children,a.a.createElement("footer",null,e.footer))}),le=(n(47),function(){return a.a.createElement("nav",{className:"clipboard"},a.a.createElement("button",{disabled:!1},"Cut"),a.a.createElement("button",{disabled:!1},"Copy"),a.a.createElement("button",{disabled:!1},"Paste"))}),ue=(n(48),function(e){function t(){var e,n;Object(l.a)(this,t);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).handleClick=function(){n.props.selectInstrument(z.selection)},n.handleClipClick=function(){if(n.props.selection&&n.props.selection.coords){var e=document.createElement("canvas"),t=e.getContext("2d"),o=n.props.selection.coords;if(e.width=o.width,e.height=o.height,!t)throw new Error("Couldn't acquire canvas context");t.putImageData(n.props.image,0,0),n.props.changeImage(t.getImageData(n.props.selection.coords.left,n.props.selection.coords.top,n.props.selection.coords.width,n.props.selection.coords.height)),n.props.selectInstrument(z.selection)}},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("nav",{className:"image"},a.a.createElement("button",{className:f()("select",{select_active:"selection"===this.props.instrument}),onClick:this.handleClick},a.a.createElement("svg",{viewBox:"0 0 15 10"},a.a.createElement("rect",{width:"15",height:"10",style:{fill:"transparent",strokeWidth:"1",strokeDasharray:"1",stroke:"black"}})),a.a.createElement("footer",null,"Select")),a.a.createElement("div",{className:"side-buttons"},a.a.createElement("button",{onClick:this.handleClipClick,disabled:!(this.props.selection&&this.props.selection.coords)},"Cut"),a.a.createElement("button",null,"Change size"),a.a.createElement("button",null,"Rotate")))}}]),t}(o.Component)),he=Object(i.b)(function(e){return{image:e.image.data,instrument:e.instruments.instrument,selection:e.instruments.selection}},function(e){return{selectInstrument:function(t){return e(k(t))},changeImage:function(t){return e(I(t))}}})(ue),de=(n(49),Object(i.b)(function(e){return{instrument:e.instruments.instrument}},function(e){return{selectInstrument:function(t){return e(k(t))}}})(function(e){return a.a.createElement("div",{className:"instruments"},Object.values(z).filter(function(e){return e!==z.selection}).map(function(t){return a.a.createElement("button",{className:f()("instrument_".concat(t),{instrument_active:t===e.instrument}),key:"instrument_".concat(t),onClick:function(){return e.selectInstrument(t)}})}))})),pe=n(12),ge=(n(50),n(51),function(e){return a.a.createElement("div",{className:"color-palette"},e.children)}),fe=(n(52),function(e){return a.a.createElement("div",{className:f()("color-selection",{"color-selection_active":e.active}),onClick:e.onClick},a.a.createElement("div",{className:"color-selection-color",style:{backgroundColor:"rgb(".concat(e.color.r,",").concat(e.color.g,",").concat(e.color.b,")")}}),a.a.createElement("h6",{className:"color-selection-header"},e.header))}),me=(n(53),function(e){return a.a.createElement("div",{className:"color-input"},a.a.createElement("label",{className:"color-input-wrapper"},a.a.createElement("input",{type:"color",onChange:e.onChange,value:e.value})),a.a.createElement("h6",{className:"color-input-header"},"Change color"))}),ve=(n(54),function(e){return a.a.createElement("div",{onClick:e.onClick,style:e.value&&{backgroundColor:"rgb(".concat(e.value.r,", ").concat(e.value.g,", ").concat(e.value.b,")")},className:f()("color",{color_active:e.active,color_undefined:!e.value})})}),we=function(e){return a.a.createElement("div",{className:"colors"},a.a.createElement(fe,{header:"Color 1",color:e.colors[e.primary],active:e.activeColor===x.primary,onClick:function(){return e.onActiveColorClick(x.primary)}}),a.a.createElement(fe,{header:"Color 2",color:e.colors[e.secondary],active:e.activeColor===x.secondary,onClick:function(){return e.onActiveColorClick(x.secondary)}}),a.a.createElement(ge,null,[].concat(Object(pe.a)(e.colors.map(function(t,n){return a.a.createElement(ve,{value:t,active:n===e[e.activeColor],onClick:function(){return e.onColorClick(n)},key:"color"+n})})),Object(pe.a)(new Array(30-e.colors.length).fill(void 0).map(function(e,t){return a.a.createElement(ve,{key:"undefinedcolor"+t})})))),a.a.createElement(me,{onChange:e.onColorInputChange,value:w(e.colors[e[e.activeColor]])}))},Ce=function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement(we,this.props)}}]),t}(o.PureComponent),be=Object(i.b)(function(e){return{colors:e.colors.list,activeColor:e.colors.activeColor,primary:e.colors.primary,secondary:e.colors.secondary}},function(e){return{onColorClick:function(t){return e(j(t))},onActiveColorClick:function(t){return e(function(e){return{type:E.changeActiveColor,activeColor:e}}(t))},onColorInputChange:function(t){return e(function(e){return function(t,n){var o=e.target.value.match(/[A-Za-z0-9]{2}/g);if(o){var a=o.map(function(e){return parseInt(e,16)}),r={r:a[0],g:a[1],b:a[2]};n().colors.list.find(function(e){return e.r===r.r&&e.g===r.g&&e.b===r.b})||t({type:E.addColor,value:r})}}}(t))}}})(Ce),De=function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement(a.a.Fragment,null,a.a.createElement(y,{onDownload:function(){return t=e.props.downloadName,void M.toBlob(function(e){null!==R&&window.URL.revokeObjectURL(R),R=window.URL.createObjectURL(e);var n=document.createElement("a");n.download=t,n.href=R,document.body.appendChild(n),n.click(),document.body.removeChild(n)});var t},onFileCreate:this.props.onFileCreate,onFileOpen:this.props.onFileOpen}),a.a.createElement(ce,null,a.a.createElement(se,{footer:"Clipboard"},a.a.createElement(le,null)),a.a.createElement(se,{footer:"Image"},a.a.createElement(he,null)),a.a.createElement(se,{footer:"Instruments"},a.a.createElement(de,null)),a.a.createElement(se,{footer:"Colors"},a.a.createElement(be,null))),a.a.createElement(ie,null))}},{key:"componentDidMount",value:function(){document.addEventListener("paste",this.props.onPaste)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("paste",this.props.onPaste)}}]),t}(o.PureComponent),Ee=Object(i.b)(function(e){return{downloadName:e.image.name}},function(e){return{onFileCreate:function(){return e(function(e){var t=[800,450];M.width=t[0],M.height=t[1],S(),e({type:E.changeImage,data:P.getImageData(0,0,M.width,M.height),name:"\u0412\u0430\u0448\u0430 \u043f\u0438\u043a\u0447\u0430.png"})})},onFileOpen:function(t){return e(function(e){return function(t){var n=e.nativeEvent.currentTarget,o=n.files&&n.files[0];if(null!=o){var a=new FileReader;a.onload=function(e){var n=new Image;n.onload=function(){M.width=n.width,M.height=n.height,P.drawImage(n,0,0),t({type:E.changeImage,data:P.getImageData(0,0,n.width,n.height),name:o.name})},n.src=e.currentTarget.result},a.readAsDataURL(o)}}}(t))},onPaste:function(t){return e(function(e){return function(t){if(e.clipboardData){var n=e.clipboardData.items;if(!n)return;for(var o=0;o<n.length;o++){if(-1!==n[o].type.indexOf("image"))if("break"===function(){var e=n[o].getAsFile(),a=window.URL.createObjectURL(e),r=new Image;return r.onload=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height;var n=e.getContext("2d");if(!n)throw new Error("Coudn't acquire context");n.drawImage(r,0,0),t({type:E.changeInstrument,instrument:z.selection,selection:{imageData:n.getImageData(0,0,e.width,e.height),coords:{top:0,left:0,width:r.width,height:r.height}}})},r.src=a,"break"}())break}e.preventDefault()}}}(t))}}})(De);function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(n,!0).forEach(function(t){Object(L.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(n,!0).forEach(function(t){Object(L.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var je=Object(c.c)({image:function(e,t){if(void 0===e){var n=document.createElement("canvas"),o=[800,450];n.width=o[0],n.height=o[1];var a=n.getContext("2d");if(!a)throw new Error("Coudn't acquire context");return a.fillStyle="#FFFFFF",a.fillRect(0,0,n.width,n.height),{data:a.getImageData(0,0,n.width,n.height),name:"\u0412\u0430\u0448\u0430 \u043f\u0438\u043a\u0447\u0430.png"}}switch(t.type){case E.changeImage:return{data:t.data,name:t.name||e.name};default:return e}},colors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{list:[{r:0,g:0,b:0},{r:127,g:127,b:127},{r:136,g:0,b:21},{r:237,g:28,b:36},{r:255,g:127,b:39},{r:255,g:242,b:0},{r:34,g:177,b:76},{r:0,g:162,b:232},{r:63,g:72,b:204},{r:163,g:73,b:164},{r:255,g:255,b:255},{r:195,g:195,b:195},{r:185,g:122,b:87},{r:255,g:174,b:201},{r:255,g:201,b:14},{r:239,g:228,b:176},{r:181,g:230,b:29},{r:153,g:217,b:234},{r:112,g:176,b:190},{r:200,g:191,b:231}],activeColor:x.primary,primary:0,secondary:10},t=arguments.length>1?arguments[1]:void 0,n=Oe({},e);switch(t.type){case E.selectColor:return n[n.activeColor]=t.index,n;case E.addColor:return 30!==n.list.length?(n.list=[].concat(Object(pe.a)(n.list),[t.value]),n[n.activeColor]=e.list.length):(n.list=[].concat(Object(pe.a)(n.list.slice(0,20)),Object(pe.a)(n.list.slice(21)),[t.value]),n[n.activeColor]=e.list.length-1),n;case E.changeActiveColor:return n.activeColor=t.activeColor,n;default:return e}},instruments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{instrument:"pen"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E.changeInstrument:t.type;var n=Object(A.a)(t,["type"]);return ze({},e,{},n);default:return e}}}),Re=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.d,ke=Object(c.e)(je,Re(Object(c.a)(s.a)));Object(r.render)(a.a.createElement(o.StrictMode,null,a.a.createElement(i.a,{store:ke},a.a.createElement(Ee,null))),document.getElementById("root"))}]),[[22,1,2]]]);
//# sourceMappingURL=main.514bbf9c.chunk.js.map